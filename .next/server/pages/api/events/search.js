"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/events/search";
exports.ids = ["pages/api/events/search"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("dotenv");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "puppeteer":
/*!****************************!*\
  !*** external "puppeteer" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("puppeteer");

/***/ }),

/***/ "puppeteer-extra":
/*!**********************************!*\
  !*** external "puppeteer-extra" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("puppeteer-extra");

/***/ }),

/***/ "puppeteer-extra-plugin-stealth":
/*!*************************************************!*\
  !*** external "puppeteer-extra-plugin-stealth" ***!
  \*************************************************/
/***/ ((module) => {

module.exports = require("puppeteer-extra-plugin-stealth");

/***/ }),

/***/ "(api)/__barrel_optimize__?names=isSameDay,parse!=!./node_modules/date-fns/index.js":
/*!************************************************************************************!*\
  !*** __barrel_optimize__?names=isSameDay,parse!=!./node_modules/date-fns/index.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isSameDay: () => (/* reexport safe */ C_Users_cityz_IllI_play_tooket_node_modules_date_fns_isSameDay_js__WEBPACK_IMPORTED_MODULE_0__.isSameDay),\n/* harmony export */   parse: () => (/* reexport safe */ C_Users_cityz_IllI_play_tooket_node_modules_date_fns_parse_js__WEBPACK_IMPORTED_MODULE_1__.parse)\n/* harmony export */ });\n/* harmony import */ var C_Users_cityz_IllI_play_tooket_node_modules_date_fns_isSameDay_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/date-fns/isSameDay.js */ \"(api)/./node_modules/date-fns/isSameDay.js\");\n/* harmony import */ var C_Users_cityz_IllI_play_tooket_node_modules_date_fns_parse_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./node_modules/date-fns/parse.js */ \"(api)/./node_modules/date-fns/parse.js\");\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvX19iYXJyZWxfb3B0aW1pemVfXz9uYW1lcz1pc1NhbWVEYXkscGFyc2UhPSEuL25vZGVfbW9kdWxlcy9kYXRlLWZucy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUNzRyIsInNvdXJjZXMiOlsid2VicGFjazovL3RpY2tldC1zZWFyY2hlci8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9pbmRleC5qcz8zYTgzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuZXhwb3J0IHsgaXNTYW1lRGF5IH0gZnJvbSBcIkM6XFxcXFVzZXJzXFxcXGNpdHl6XFxcXElsbElcXFxccGxheVxcXFx0b29rZXRcXFxcbm9kZV9tb2R1bGVzXFxcXGRhdGUtZm5zXFxcXGlzU2FtZURheS5qc1wiXG5leHBvcnQgeyBwYXJzZSB9IGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxjaXR5elxcXFxJbGxJXFxcXHBsYXlcXFxcdG9va2V0XFxcXG5vZGVfbW9kdWxlc1xcXFxkYXRlLWZuc1xcXFxwYXJzZS5qc1wiIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/__barrel_optimize__?names=isSameDay,parse!=!./node_modules/date-fns/index.js\n");

/***/ }),

/***/ "(api)/__barrel_optimize__?names=parse!=!./node_modules/date-fns/index.js":
/*!**************************************************************************!*\
  !*** __barrel_optimize__?names=parse!=!./node_modules/date-fns/index.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   parse: () => (/* reexport safe */ C_Users_cityz_IllI_play_tooket_node_modules_date_fns_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)
/* harmony export */ });
/* harmony import */ var C_Users_cityz_IllI_play_tooket_node_modules_date_fns_parse_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/date-fns/parse.js */ "(api)/./node_modules/date-fns/parse.js");



/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fevents%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cevents%5Csearch.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fevents%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cevents%5Csearch.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_events_search_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\events\\search.ts */ \"(api)/./pages/api/events/search.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_events_search_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_events_search_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/events/search\",\n        pathname: \"/api/events/search\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_events_search_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmV2ZW50cyUyRnNlYXJjaCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDZXZlbnRzJTVDc2VhcmNoLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzREO0FBQzVEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx3REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsd0RBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGlja2V0LXNlYXJjaGVyLz8zYmI1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcZXZlbnRzXFxcXHNlYXJjaC50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2V2ZW50cy9zZWFyY2hcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9ldmVudHMvc2VhcmNoXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fevents%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cevents%5Csearch.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/services/search-service.ts":
/*!****************************************!*\
  !*** ./lib/services/search-service.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SearchService: () => (/* binding */ SearchService),\n/* harmony export */   searchService: () => (/* binding */ searchService)\n/* harmony export */ });\n/* harmony import */ var _src_stub_hub__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../src/stub-hub */ \"(api)/./src/stub-hub.js\");\n/* harmony import */ var _src_vivid_seats__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../src/vivid-seats */ \"(api)/./src/vivid-seats.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _src_config_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../src/config/env */ \"(api)/./src/config/env.ts\");\n/* harmony import */ var _src_event_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../src/event-utils */ \"(api)/./src/event-utils.js\");\n/* harmony import */ var _utils_logger__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/logger */ \"(api)/./lib/utils/logger.ts\");\n/* harmony import */ var _barrel_optimize_names_parse_date_fns__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! __barrel_optimize__?names=parse!=!date-fns */ \"(api)/__barrel_optimize__?names=parse!=!./node_modules/date-fns/index.js\");\n\n\n\n\n\n\n\nclass SearchService {\n    constructor(){\n        this.supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(_src_config_env__WEBPACK_IMPORTED_MODULE_3__.config.supabase.url, _src_config_env__WEBPACK_IMPORTED_MODULE_3__.config.supabase.serviceKey);\n        this.stubHubSearcher = new _src_stub_hub__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\n        this.vividSeatsSearcher = new _src_vivid_seats__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\n    }\n    async searchAll(params) {\n        try {\n            // Add a timestamp to track when the search started\n            const searchStartTime = new Date();\n            // Get existing events and tickets from database first\n            const { data: existingEvents } = await this.supabase.from(\"events\").select(`\r\n          *,\r\n          event_links (*),\r\n          tickets (*)\r\n        `).ilike(\"name\", `%${params.keyword || params.artist}%`).gte(\"date\", new Date().toISOString());\n            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(\"Found existing events:\", existingEvents?.length || 0);\n            // Start searches in parallel with timeouts\n            const searches = [];\n            const sources = {};\n            if (params.source === \"all\" || params.source === \"stubhub\") {\n                searches.push(this.searchStubHub(params).then((results)=>{\n                    sources.stubhub = {\n                        isLive: true,\n                        lastUpdated: searchStartTime.toISOString()\n                    };\n                    return results;\n                }).catch((error)=>{\n                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"StubHub search error:\", error);\n                    sources.stubhub = {\n                        isLive: false,\n                        lastUpdated: existingEvents?.find((e)=>e.event_links.some((l)=>l.source === \"stubhub\"))?.updated_at || searchStartTime.toISOString(),\n                        error: error.message\n                    };\n                    return [];\n                }));\n            }\n            if (params.source === \"all\" || params.source === \"vividseats\") {\n                searches.push(this.searchVividSeats(params).then((results)=>{\n                    sources.vividseats = {\n                        isLive: true,\n                        lastUpdated: searchStartTime.toISOString()\n                    };\n                    return results;\n                }).catch((error)=>{\n                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"VividSeats search error:\", error);\n                    sources.vividseats = {\n                        isLive: false,\n                        lastUpdated: existingEvents?.find((e)=>e.event_links.some((l)=>l.source === \"vividseats\"))?.updated_at || searchStartTime.toISOString(),\n                        error: error.message\n                    };\n                    return [];\n                }));\n            }\n            // Wait for all searches with a timeout\n            const results = await Promise.race([\n                Promise.all(searches),\n                new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Search timeout\")), 60000))\n            ]);\n            // Combine and deduplicate results\n            const allEvents = [\n                ...existingEvents || [],\n                ...results.flat()\n            ];\n            const eventMap = new Map();\n            allEvents.forEach((event)=>{\n                const key = `${event.name}-${event.date}-${event.venue}`;\n                if (!eventMap.has(key) || event.tickets?.length > (eventMap.get(key)?.tickets?.length || 0)) {\n                    eventMap.set(key, event);\n                }\n            });\n            const combinedResults = Array.from(eventMap.values());\n            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(\"Search completed\", {\n                totalResults: combinedResults.length,\n                sources: Object.keys(sources)\n            });\n            return {\n                success: true,\n                data: combinedResults,\n                metadata: {\n                    total: combinedResults.length,\n                    sources\n                }\n            };\n        } catch (error) {\n            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Search error:\", error);\n            return {\n                success: false,\n                error: \"Failed to perform search\",\n                metadata: {\n                    error: error instanceof Error ? error.message : \"Unknown error\"\n                }\n            };\n        }\n    }\n    async storeEvent(event) {\n        try {\n            // Check for existing event\n            const matchingEvent = await (0,_src_event_utils__WEBPACK_IMPORTED_MODULE_4__.findMatchingEvent)(this.supabase, {\n                name: event.name || event.title,\n                date: event.date,\n                venue: event.venue\n            }, event.source);\n            if (matchingEvent) {\n                _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Found matching event: ${matchingEvent.name}`);\n                // Add source-specific link if it doesn't exist\n                if (!matchingEvent.hasSourceLink) {\n                    const { error: linkError } = await this.supabase.from(\"event_links\").insert({\n                        event_id: matchingEvent.id,\n                        source: event.source,\n                        url: event.link\n                    });\n                    if (linkError) {\n                        _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting event link:\", linkError);\n                    }\n                }\n                // Insert new tickets\n                if (event.tickets?.sections) {\n                    const tickets = this.transformTickets(matchingEvent.id, event);\n                    const { error: ticketError } = await this.supabase.from(\"tickets\").insert(tickets);\n                    if (ticketError) {\n                        _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting tickets:\", ticketError);\n                    }\n                }\n                // Return updated event data\n                const { data: updatedEvent } = await this.supabase.from(\"events\").select(`\r\n            *,\r\n            event_links (*),\r\n            tickets (*)\r\n          `).eq(\"id\", matchingEvent.id).single();\n                return updatedEvent;\n            }\n            // Insert new event\n            const { data: newEvent, error: eventError } = await this.supabase.from(\"events\").insert({\n                name: event.name || event.title,\n                type: event.type || \"Concert\",\n                category: event.category || \"Concert\",\n                date: new Date(event.date).toISOString(),\n                venue: event.venue\n            }).select().single();\n            if (eventError || !newEvent) {\n                _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting event:\", eventError);\n                return null;\n            }\n            // Insert event link\n            await this.supabase.from(\"event_links\").insert({\n                event_id: newEvent.id,\n                source: event.source,\n                url: event.link\n            });\n            // Insert tickets\n            if (event.tickets?.sections) {\n                const tickets = this.transformTickets(newEvent.id, event);\n                await this.supabase.from(\"tickets\").insert(tickets);\n            }\n            // Return complete event data\n            const { data: completeEvent } = await this.supabase.from(\"events\").select(`\r\n          *,\r\n          event_links (*),\r\n          tickets (*)\r\n        `).eq(\"id\", newEvent.id).single();\n            return completeEvent;\n        } catch (error) {\n            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error storing event:\", error);\n            return null;\n        }\n    }\n    transformTickets(eventId, event) {\n        return event.tickets.sections.flatMap((section)=>section.tickets.map((ticket)=>({\n                    event_id: eventId,\n                    price: ticket.rawPrice,\n                    section: section.section,\n                    row: ticket.row,\n                    quantity: parseInt(ticket.quantity) || 1,\n                    source: event.source,\n                    url: ticket.listingUrl || ticket.url,\n                    listing_id: ticket.listingId,\n                    raw_data: ticket\n                })));\n    }\n    async searchStubHub(params) {\n        try {\n            const rawEvents = await this.stubHubSearcher.searchConcerts(params.artist || params.keyword || \"\", params.venue || \"\", params.location || \"\");\n            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Found ${rawEvents.length} StubHub events`);\n            // Process each event sequentially to avoid race conditions\n            const storedEvents = [];\n            for (const event of rawEvents){\n                try {\n                    // Parse the date string properly\n                    const dateRegex = /([A-Za-z]+)\\s+(\\d+)\\s+(\\d{4}).*?(\\d+:\\d+\\s*[AP]M)/i;\n                    const match = event.date.match(dateRegex);\n                    if (!match) {\n                        _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Failed to parse StubHub date:\", event.date);\n                        continue;\n                    }\n                    const [_, month, day, year, time] = match;\n                    const standardDateStr = `${month} ${day} ${year} ${time}`;\n                    const parsedDate = (0,_barrel_optimize_names_parse_date_fns__WEBPACK_IMPORTED_MODULE_6__.parse)(standardDateStr, \"MMM d yyyy h:mm a\", new Date());\n                    if (isNaN(parsedDate.getTime())) {\n                        _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Invalid date after parsing:\", standardDateStr);\n                        continue;\n                    }\n                    // Check for existing event\n                    const matchingEvent = await (0,_src_event_utils__WEBPACK_IMPORTED_MODULE_4__.findMatchingEvent)(this.supabase, {\n                        name: event.name,\n                        date: parsedDate.toISOString(),\n                        venue: event.venue\n                    }, \"stubhub\");\n                    if (matchingEvent) {\n                        _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Found matching event for StubHub: ${matchingEvent.name}`);\n                        // Add StubHub link if it doesn't exist\n                        if (!matchingEvent.hasSourceLink) {\n                            const { error: linkError } = await this.supabase.from(\"event_links\").insert({\n                                event_id: matchingEvent.id,\n                                source: \"stubhub\",\n                                url: event.link\n                            });\n                            if (linkError) {\n                                _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting StubHub link:\", linkError);\n                            } else {\n                                _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(\"Added StubHub link to existing event\");\n                            }\n                        }\n                        // Insert or update tickets\n                        if (event.tickets?.sections) {\n                            const tickets = this.transformTickets(matchingEvent.id, {\n                                ...event,\n                                source: \"stubhub\"\n                            });\n                            if (tickets.length > 0) {\n                                const { error: ticketError } = await this.supabase.from(\"tickets\").insert(tickets);\n                                if (ticketError) {\n                                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting StubHub tickets:\", ticketError);\n                                } else {\n                                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Inserted ${tickets.length} StubHub tickets`);\n                                }\n                            }\n                        }\n                        // Get updated event data\n                        const { data: updatedEvent } = await this.supabase.from(\"events\").select(`\r\n                *,\r\n                event_links (*),\r\n                tickets (*)\r\n              `).eq(\"id\", matchingEvent.id).single();\n                        if (updatedEvent) {\n                            storedEvents.push(updatedEvent);\n                        }\n                    } else {\n                        // Insert new event\n                        const { data: newEvent, error: eventError } = await this.supabase.from(\"events\").insert({\n                            name: event.name,\n                            type: \"Concert\",\n                            category: event.category || \"Concert\",\n                            date: parsedDate.toISOString(),\n                            venue: event.venue\n                        }).select().single();\n                        if (eventError) {\n                            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting new StubHub event:\", eventError);\n                            continue;\n                        }\n                        _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Created new event: ${newEvent.name}`);\n                        // Insert StubHub link\n                        const { error: linkError } = await this.supabase.from(\"event_links\").insert({\n                            event_id: newEvent.id,\n                            source: \"stubhub\",\n                            url: event.link\n                        });\n                        if (linkError) {\n                            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting new StubHub link:\", linkError);\n                        }\n                        // Insert tickets\n                        if (event.tickets?.sections) {\n                            const tickets = this.transformTickets(newEvent.id, {\n                                ...event,\n                                source: \"stubhub\"\n                            });\n                            if (tickets.length > 0) {\n                                const { error: ticketError } = await this.supabase.from(\"tickets\").insert(tickets);\n                                if (ticketError) {\n                                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting new StubHub tickets:\", ticketError);\n                                } else {\n                                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Inserted ${tickets.length} new StubHub tickets`);\n                                }\n                            }\n                        }\n                        // Get complete event data\n                        const { data: completeEvent } = await this.supabase.from(\"events\").select(`\r\n                *,\r\n                event_links (*),\r\n                tickets (*)\r\n              `).eq(\"id\", newEvent.id).single();\n                        if (completeEvent) {\n                            storedEvents.push(completeEvent);\n                        }\n                    }\n                } catch (error) {\n                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error processing StubHub event:\", error);\n                }\n            }\n            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Successfully stored ${storedEvents.length} StubHub events`);\n            return storedEvents;\n        } catch (error) {\n            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"StubHub search error:\", error);\n            return [];\n        }\n    }\n    async searchVividSeats(params) {\n        let browser = null;\n        try {\n            const rawEvents = await this.vividSeatsSearcher.searchConcerts(params.artist || params.keyword || \"\", params.venue || \"\", params.location || \"\");\n            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Found ${rawEvents.length} VividSeats events`);\n            // Process each event sequentially to avoid race conditions\n            const storedEvents = [];\n            for (const event of rawEvents){\n                try {\n                    // Parse VividSeats date format\n                    const dateRegex = /([A-Za-z]+)\\s+(\\d+)\\s+[A-Za-z]+\\s+(\\d+:\\d+[ap]m)/i;\n                    const match = event.date.match(dateRegex);\n                    if (!match) {\n                        _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Failed to parse VividSeats date:\", event.date);\n                        continue;\n                    }\n                    const [_, month, day, time] = match;\n                    const year = \"2025\"; // Default to 2025 for future dates\n                    const standardDateStr = `${month} ${day} ${year} ${time}`;\n                    const parsedDate = (0,_barrel_optimize_names_parse_date_fns__WEBPACK_IMPORTED_MODULE_6__.parse)(standardDateStr, \"MMM d yyyy h:mma\", new Date());\n                    if (isNaN(parsedDate.getTime())) {\n                        _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Invalid date after parsing:\", standardDateStr);\n                        continue;\n                    }\n                    // Check for existing event\n                    const matchingEvent = await (0,_src_event_utils__WEBPACK_IMPORTED_MODULE_4__.findMatchingEvent)(this.supabase, {\n                        name: event.title,\n                        date: parsedDate.toISOString(),\n                        venue: event.venue\n                    }, \"vividseats\");\n                    if (matchingEvent) {\n                        _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Found matching event for VividSeats: ${matchingEvent.name}`);\n                        // Add VividSeats link if it doesn't exist\n                        if (!matchingEvent.hasSourceLink) {\n                            const { error: linkError } = await this.supabase.from(\"event_links\").insert({\n                                event_id: matchingEvent.id,\n                                source: \"vividseats\",\n                                url: event.link\n                            });\n                            if (linkError) {\n                                _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting VividSeats link:\", linkError);\n                            } else {\n                                _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(\"Added VividSeats link to existing event\");\n                            }\n                        }\n                        // Insert or update tickets\n                        if (event.tickets?.sections) {\n                            const tickets = this.transformTickets(matchingEvent.id, {\n                                ...event,\n                                source: \"vividseats\"\n                            });\n                            if (tickets.length > 0) {\n                                const { error: ticketError } = await this.supabase.from(\"tickets\").insert(tickets);\n                                if (ticketError) {\n                                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting VividSeats tickets:\", ticketError);\n                                } else {\n                                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Inserted ${tickets.length} VividSeats tickets`);\n                                }\n                            }\n                        }\n                        // Get updated event data\n                        const { data: updatedEvent } = await this.supabase.from(\"events\").select(`\r\n                *,\r\n                event_links (*),\r\n                tickets (*)\r\n              `).eq(\"id\", matchingEvent.id).single();\n                        if (updatedEvent) {\n                            storedEvents.push(updatedEvent);\n                        }\n                    } else {\n                        // Insert new event\n                        const { data: newEvent, error: eventError } = await this.supabase.from(\"events\").insert({\n                            name: event.title,\n                            type: \"Concert\",\n                            category: \"Concert\",\n                            date: parsedDate.toISOString(),\n                            venue: event.venue\n                        }).select().single();\n                        if (eventError) {\n                            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting new VividSeats event:\", eventError);\n                            continue;\n                        }\n                        _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Created new event: ${newEvent.name}`);\n                        // Insert VividSeats link\n                        const { error: linkError } = await this.supabase.from(\"event_links\").insert({\n                            event_id: newEvent.id,\n                            source: \"vividseats\",\n                            url: event.link\n                        });\n                        if (linkError) {\n                            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting new VividSeats link:\", linkError);\n                        }\n                        // Insert tickets\n                        if (event.tickets?.sections) {\n                            const tickets = this.transformTickets(newEvent.id, {\n                                ...event,\n                                source: \"vividseats\"\n                            });\n                            if (tickets.length > 0) {\n                                const { error: ticketError } = await this.supabase.from(\"tickets\").insert(tickets);\n                                if (ticketError) {\n                                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error inserting new VividSeats tickets:\", ticketError);\n                                } else {\n                                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Inserted ${tickets.length} new VividSeats tickets`);\n                                }\n                            }\n                        }\n                        // Get complete event data\n                        const { data: completeEvent } = await this.supabase.from(\"events\").select(`\r\n                *,\r\n                event_links (*),\r\n                tickets (*)\r\n              `).eq(\"id\", newEvent.id).single();\n                        if (completeEvent) {\n                            storedEvents.push(completeEvent);\n                        }\n                    }\n                } catch (error) {\n                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error processing VividSeats event:\", error);\n                }\n            }\n            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(`Successfully stored ${storedEvents.length} VividSeats events`);\n            return storedEvents;\n        } catch (error) {\n            _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"VividSeats search error:\", error);\n            return [];\n        } finally{\n            if (browser) {\n                try {\n                    await browser.close();\n                } catch (error) {\n                    _utils_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Error closing browser:\", error);\n                }\n            }\n        }\n    }\n}\nconst searchService = new SearchService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q21DLEtBQUssQ0FBQyw0QkFBNEJBO1lBQ3pDLE9BQU8sRUFBRTtRQUNYLFNBQVU7WUFDUixJQUFJd0YsU0FBUztnQkFDWCxJQUFJO29CQUNGLE1BQU1BLFFBQVFDLEtBQUs7Z0JBQ3JCLEVBQUUsT0FBT3pGLE9BQU87b0JBQ2RuQyxpREFBTUEsQ0FBQ21DLEtBQUssQ0FBQywwQkFBMEJBO2dCQUN6QztZQUNGO1FBQ0Y7SUFDRjtBQUNGO0FBRU8sTUFBTTBGLGdCQUFnQixJQUFJM0gsZ0JBQWdCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGlja2V0LXNlYXJjaGVyLy4vbGliL3NlcnZpY2VzL3NlYXJjaC1zZXJ2aWNlLnRzP2EwNDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFN0dWJIdWJTZWFyY2hlciBmcm9tICcuLi8uLi9zcmMvc3R1Yi1odWInO1xyXG5pbXBvcnQgVml2aWRTZWF0c1NlYXJjaGVyIGZyb20gJy4uLy4uL3NyYy92aXZpZC1zZWF0cyc7XHJcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XHJcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gJy4uLy4uL3NyYy9jb25maWcvZW52JztcclxuaW1wb3J0IHR5cGUgeyBTZWFyY2hQYXJhbXMsIFNlYXJjaFJlc3VsdCwgRXZlbnQsIFRpY2tldCwgVGlja2V0U291cmNlIH0gZnJvbSAnLi4vdHlwZXMvYXBpJztcclxuaW1wb3J0IHsgZmluZE1hdGNoaW5nRXZlbnQgfSBmcm9tICcuLi8uLi9zcmMvZXZlbnQtdXRpbHMnO1xyXG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuLi91dGlscy9sb2dnZXInO1xyXG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJ2RhdGUtZm5zJztcclxuXHJcbmV4cG9ydCBjbGFzcyBTZWFyY2hTZXJ2aWNlIHtcclxuICBwcml2YXRlIHN1cGFiYXNlO1xyXG4gIHByaXZhdGUgc3R1Ykh1YlNlYXJjaGVyOiBTdHViSHViU2VhcmNoZXI7XHJcbiAgcHJpdmF0ZSB2aXZpZFNlYXRzU2VhcmNoZXI6IFZpdmlkU2VhdHNTZWFyY2hlcjtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLnN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KFxyXG4gICAgICBjb25maWcuc3VwYWJhc2UudXJsLFxyXG4gICAgICBjb25maWcuc3VwYWJhc2Uuc2VydmljZUtleVxyXG4gICAgKTtcclxuICAgIHRoaXMuc3R1Ykh1YlNlYXJjaGVyID0gbmV3IFN0dWJIdWJTZWFyY2hlcigpO1xyXG4gICAgdGhpcy52aXZpZFNlYXRzU2VhcmNoZXIgPSBuZXcgVml2aWRTZWF0c1NlYXJjaGVyKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzZWFyY2hBbGwocGFyYW1zOiBTZWFyY2hQYXJhbXMpOiBQcm9taXNlPFNlYXJjaFJlc3VsdD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gQWRkIGEgdGltZXN0YW1wIHRvIHRyYWNrIHdoZW4gdGhlIHNlYXJjaCBzdGFydGVkXHJcbiAgICAgIGNvbnN0IHNlYXJjaFN0YXJ0VGltZSA9IG5ldyBEYXRlKCk7XHJcblxyXG4gICAgICAvLyBHZXQgZXhpc3RpbmcgZXZlbnRzIGFuZCB0aWNrZXRzIGZyb20gZGF0YWJhc2UgZmlyc3RcclxuICAgICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ0V2ZW50cyB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKCdldmVudHMnKVxyXG4gICAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgICAgKixcclxuICAgICAgICAgIGV2ZW50X2xpbmtzICgqKSxcclxuICAgICAgICAgIHRpY2tldHMgKCopXHJcbiAgICAgICAgYClcclxuICAgICAgICAuaWxpa2UoJ25hbWUnLCBgJSR7cGFyYW1zLmtleXdvcmQgfHwgcGFyYW1zLmFydGlzdH0lYClcclxuICAgICAgICAuZ3RlKCdkYXRlJywgbmV3IERhdGUoKS50b0lTT1N0cmluZygpKTtcclxuXHJcbiAgICAgIGxvZ2dlci5pbmZvKCdGb3VuZCBleGlzdGluZyBldmVudHM6JywgZXhpc3RpbmdFdmVudHM/Lmxlbmd0aCB8fCAwKTtcclxuXHJcbiAgICAgIC8vIFN0YXJ0IHNlYXJjaGVzIGluIHBhcmFsbGVsIHdpdGggdGltZW91dHNcclxuICAgICAgY29uc3Qgc2VhcmNoZXMgPSBbXTtcclxuICAgICAgY29uc3Qgc291cmNlczogUmVjb3JkPHN0cmluZywgVGlja2V0U291cmNlPiA9IHt9O1xyXG5cclxuICAgICAgaWYgKHBhcmFtcy5zb3VyY2UgPT09ICdhbGwnIHx8IHBhcmFtcy5zb3VyY2UgPT09ICdzdHViaHViJykge1xyXG4gICAgICAgIHNlYXJjaGVzLnB1c2goXHJcbiAgICAgICAgICB0aGlzLnNlYXJjaFN0dWJIdWIocGFyYW1zKVxyXG4gICAgICAgICAgICAudGhlbihyZXN1bHRzID0+IHtcclxuICAgICAgICAgICAgICBzb3VyY2VzLnN0dWJodWIgPSB7IFxyXG4gICAgICAgICAgICAgICAgaXNMaXZlOiB0cnVlLCBcclxuICAgICAgICAgICAgICAgIGxhc3RVcGRhdGVkOiBzZWFyY2hTdGFydFRpbWUudG9JU09TdHJpbmcoKSBcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignU3R1Ykh1YiBzZWFyY2ggZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICAgIHNvdXJjZXMuc3R1Ymh1YiA9IHtcclxuICAgICAgICAgICAgICAgIGlzTGl2ZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBsYXN0VXBkYXRlZDogZXhpc3RpbmdFdmVudHM/LmZpbmQoZSA9PiBcclxuICAgICAgICAgICAgICAgICAgZS5ldmVudF9saW5rcy5zb21lKGwgPT4gbC5zb3VyY2UgPT09ICdzdHViaHViJylcclxuICAgICAgICAgICAgICAgICk/LnVwZGF0ZWRfYXQgfHwgc2VhcmNoU3RhcnRUaW1lLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChwYXJhbXMuc291cmNlID09PSAnYWxsJyB8fCBwYXJhbXMuc291cmNlID09PSAndml2aWRzZWF0cycpIHtcclxuICAgICAgICBzZWFyY2hlcy5wdXNoKFxyXG4gICAgICAgICAgdGhpcy5zZWFyY2hWaXZpZFNlYXRzKHBhcmFtcylcclxuICAgICAgICAgICAgLnRoZW4ocmVzdWx0cyA9PiB7XHJcbiAgICAgICAgICAgICAgc291cmNlcy52aXZpZHNlYXRzID0geyBcclxuICAgICAgICAgICAgICAgIGlzTGl2ZTogdHJ1ZSwgXHJcbiAgICAgICAgICAgICAgICBsYXN0VXBkYXRlZDogc2VhcmNoU3RhcnRUaW1lLnRvSVNPU3RyaW5nKCkgXHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ1ZpdmlkU2VhdHMgc2VhcmNoIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgICAgICAgICBzb3VyY2VzLnZpdmlkc2VhdHMgPSB7XHJcbiAgICAgICAgICAgICAgICBpc0xpdmU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgbGFzdFVwZGF0ZWQ6IGV4aXN0aW5nRXZlbnRzPy5maW5kKGUgPT4gXHJcbiAgICAgICAgICAgICAgICAgIGUuZXZlbnRfbGlua3Muc29tZShsID0+IGwuc291cmNlID09PSAndml2aWRzZWF0cycpXHJcbiAgICAgICAgICAgICAgICApPy51cGRhdGVkX2F0IHx8IHNlYXJjaFN0YXJ0VGltZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBXYWl0IGZvciBhbGwgc2VhcmNoZXMgd2l0aCBhIHRpbWVvdXRcclxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UucmFjZShbXHJcbiAgICAgICAgUHJvbWlzZS5hbGwoc2VhcmNoZXMpLFxyXG4gICAgICAgIG5ldyBQcm9taXNlKChfLCByZWplY3QpID0+IFxyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZWplY3QobmV3IEVycm9yKCdTZWFyY2ggdGltZW91dCcpKSwgNjAwMDApXHJcbiAgICAgICAgKVxyXG4gICAgICBdKTtcclxuXHJcbiAgICAgIC8vIENvbWJpbmUgYW5kIGRlZHVwbGljYXRlIHJlc3VsdHNcclxuICAgICAgY29uc3QgYWxsRXZlbnRzID0gWy4uLihleGlzdGluZ0V2ZW50cyB8fCBbXSksIC4uLnJlc3VsdHMuZmxhdCgpXTtcclxuICAgICAgY29uc3QgZXZlbnRNYXAgPSBuZXcgTWFwPHN0cmluZywgRXZlbnQ+KCk7XHJcbiAgICAgIFxyXG4gICAgICBhbGxFdmVudHMuZm9yRWFjaChldmVudCA9PiB7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gYCR7ZXZlbnQubmFtZX0tJHtldmVudC5kYXRlfS0ke2V2ZW50LnZlbnVlfWA7XHJcbiAgICAgICAgaWYgKCFldmVudE1hcC5oYXMoa2V5KSB8fCBldmVudC50aWNrZXRzPy5sZW5ndGggPiAoZXZlbnRNYXAuZ2V0KGtleSk/LnRpY2tldHM/Lmxlbmd0aCB8fCAwKSkge1xyXG4gICAgICAgICAgZXZlbnRNYXAuc2V0KGtleSwgZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBjb21iaW5lZFJlc3VsdHMgPSBBcnJheS5mcm9tKGV2ZW50TWFwLnZhbHVlcygpKTtcclxuXHJcbiAgICAgIGxvZ2dlci5pbmZvKCdTZWFyY2ggY29tcGxldGVkJywge1xyXG4gICAgICAgIHRvdGFsUmVzdWx0czogY29tYmluZWRSZXN1bHRzLmxlbmd0aCxcclxuICAgICAgICBzb3VyY2VzOiBPYmplY3Qua2V5cyhzb3VyY2VzKVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBkYXRhOiBjb21iaW5lZFJlc3VsdHMsXHJcbiAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgIHRvdGFsOiBjb21iaW5lZFJlc3VsdHMubGVuZ3RoLFxyXG4gICAgICAgICAgc291cmNlc1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGxvZ2dlci5lcnJvcignU2VhcmNoIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBwZXJmb3JtIHNlYXJjaCcsXHJcbiAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgc3RvcmVFdmVudChldmVudDogYW55KTogUHJvbWlzZTxFdmVudCB8IG51bGw+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIENoZWNrIGZvciBleGlzdGluZyBldmVudFxyXG4gICAgICBjb25zdCBtYXRjaGluZ0V2ZW50ID0gYXdhaXQgZmluZE1hdGNoaW5nRXZlbnQoXHJcbiAgICAgICAgdGhpcy5zdXBhYmFzZSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBuYW1lOiBldmVudC5uYW1lIHx8IGV2ZW50LnRpdGxlLFxyXG4gICAgICAgICAgZGF0ZTogZXZlbnQuZGF0ZSxcclxuICAgICAgICAgIHZlbnVlOiBldmVudC52ZW51ZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXZlbnQuc291cmNlXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBpZiAobWF0Y2hpbmdFdmVudCkge1xyXG4gICAgICAgIGxvZ2dlci5pbmZvKGBGb3VuZCBtYXRjaGluZyBldmVudDogJHttYXRjaGluZ0V2ZW50Lm5hbWV9YCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQWRkIHNvdXJjZS1zcGVjaWZpYyBsaW5rIGlmIGl0IGRvZXNuJ3QgZXhpc3RcclxuICAgICAgICBpZiAoIW1hdGNoaW5nRXZlbnQuaGFzU291cmNlTGluaykge1xyXG4gICAgICAgICAgY29uc3QgeyBlcnJvcjogbGlua0Vycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcbiAgICAgICAgICAgIC5mcm9tKCdldmVudF9saW5rcycpXHJcbiAgICAgICAgICAgIC5pbnNlcnQoe1xyXG4gICAgICAgICAgICAgIGV2ZW50X2lkOiBtYXRjaGluZ0V2ZW50LmlkLFxyXG4gICAgICAgICAgICAgIHNvdXJjZTogZXZlbnQuc291cmNlLFxyXG4gICAgICAgICAgICAgIHVybDogZXZlbnQubGlua1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBpZiAobGlua0Vycm9yKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgaW5zZXJ0aW5nIGV2ZW50IGxpbms6JywgbGlua0Vycm9yKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEluc2VydCBuZXcgdGlja2V0c1xyXG4gICAgICAgIGlmIChldmVudC50aWNrZXRzPy5zZWN0aW9ucykge1xyXG4gICAgICAgICAgY29uc3QgdGlja2V0cyA9IHRoaXMudHJhbnNmb3JtVGlja2V0cyhtYXRjaGluZ0V2ZW50LmlkLCBldmVudCk7XHJcbiAgICAgICAgICBjb25zdCB7IGVycm9yOiB0aWNrZXRFcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAuZnJvbSgndGlja2V0cycpXHJcbiAgICAgICAgICAgIC5pbnNlcnQodGlja2V0cyk7XHJcblxyXG4gICAgICAgICAgaWYgKHRpY2tldEVycm9yKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgaW5zZXJ0aW5nIHRpY2tldHM6JywgdGlja2V0RXJyb3IpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUmV0dXJuIHVwZGF0ZWQgZXZlbnQgZGF0YVxyXG4gICAgICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZEV2ZW50IH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcbiAgICAgICAgICAuZnJvbSgnZXZlbnRzJylcclxuICAgICAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgICAgICAqLFxyXG4gICAgICAgICAgICBldmVudF9saW5rcyAoKiksXHJcbiAgICAgICAgICAgIHRpY2tldHMgKCopXHJcbiAgICAgICAgICBgKVxyXG4gICAgICAgICAgLmVxKCdpZCcsIG1hdGNoaW5nRXZlbnQuaWQpXHJcbiAgICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICAgIHJldHVybiB1cGRhdGVkRXZlbnQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEluc2VydCBuZXcgZXZlbnRcclxuICAgICAgY29uc3QgeyBkYXRhOiBuZXdFdmVudCwgZXJyb3I6IGV2ZW50RXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnZXZlbnRzJylcclxuICAgICAgICAuaW5zZXJ0KHtcclxuICAgICAgICAgIG5hbWU6IGV2ZW50Lm5hbWUgfHwgZXZlbnQudGl0bGUsXHJcbiAgICAgICAgICB0eXBlOiBldmVudC50eXBlIHx8ICdDb25jZXJ0JyxcclxuICAgICAgICAgIGNhdGVnb3J5OiBldmVudC5jYXRlZ29yeSB8fCAnQ29uY2VydCcsXHJcbiAgICAgICAgICBkYXRlOiBuZXcgRGF0ZShldmVudC5kYXRlKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgdmVudWU6IGV2ZW50LnZlbnVlXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuc2VsZWN0KClcclxuICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICBpZiAoZXZlbnRFcnJvciB8fCAhbmV3RXZlbnQpIHtcclxuICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGluc2VydGluZyBldmVudDonLCBldmVudEVycm9yKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gSW5zZXJ0IGV2ZW50IGxpbmtcclxuICAgICAgYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKCdldmVudF9saW5rcycpXHJcbiAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICBldmVudF9pZDogbmV3RXZlbnQuaWQsXHJcbiAgICAgICAgICBzb3VyY2U6IGV2ZW50LnNvdXJjZSxcclxuICAgICAgICAgIHVybDogZXZlbnQubGlua1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gSW5zZXJ0IHRpY2tldHNcclxuICAgICAgaWYgKGV2ZW50LnRpY2tldHM/LnNlY3Rpb25zKSB7XHJcbiAgICAgICAgY29uc3QgdGlja2V0cyA9IHRoaXMudHJhbnNmb3JtVGlja2V0cyhuZXdFdmVudC5pZCwgZXZlbnQpO1xyXG4gICAgICAgIGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgIC5mcm9tKCd0aWNrZXRzJylcclxuICAgICAgICAgIC5pbnNlcnQodGlja2V0cyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFJldHVybiBjb21wbGV0ZSBldmVudCBkYXRhXHJcbiAgICAgIGNvbnN0IHsgZGF0YTogY29tcGxldGVFdmVudCB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKCdldmVudHMnKVxyXG4gICAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgICAgKixcclxuICAgICAgICAgIGV2ZW50X2xpbmtzICgqKSxcclxuICAgICAgICAgIHRpY2tldHMgKCopXHJcbiAgICAgICAgYClcclxuICAgICAgICAuZXEoJ2lkJywgbmV3RXZlbnQuaWQpXHJcbiAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgcmV0dXJuIGNvbXBsZXRlRXZlbnQ7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHN0b3JpbmcgZXZlbnQ6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgdHJhbnNmb3JtVGlja2V0cyhldmVudElkOiBzdHJpbmcsIGV2ZW50OiBhbnkpOiBhbnlbXSB7XHJcbiAgICByZXR1cm4gZXZlbnQudGlja2V0cy5zZWN0aW9ucy5mbGF0TWFwKChzZWN0aW9uOiBhbnkpID0+XHJcbiAgICAgIHNlY3Rpb24udGlja2V0cy5tYXAoKHRpY2tldDogYW55KSA9PiAoe1xyXG4gICAgICAgIGV2ZW50X2lkOiBldmVudElkLFxyXG4gICAgICAgIHByaWNlOiB0aWNrZXQucmF3UHJpY2UsXHJcbiAgICAgICAgc2VjdGlvbjogc2VjdGlvbi5zZWN0aW9uLFxyXG4gICAgICAgIHJvdzogdGlja2V0LnJvdyxcclxuICAgICAgICBxdWFudGl0eTogcGFyc2VJbnQodGlja2V0LnF1YW50aXR5KSB8fCAxLFxyXG4gICAgICAgIHNvdXJjZTogZXZlbnQuc291cmNlLFxyXG4gICAgICAgIHVybDogdGlja2V0Lmxpc3RpbmdVcmwgfHwgdGlja2V0LnVybCxcclxuICAgICAgICBsaXN0aW5nX2lkOiB0aWNrZXQubGlzdGluZ0lkLFxyXG4gICAgICAgIHJhd19kYXRhOiB0aWNrZXRcclxuICAgICAgfSkpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBzZWFyY2hTdHViSHViKHBhcmFtczogU2VhcmNoUGFyYW1zKTogUHJvbWlzZTxFdmVudFtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByYXdFdmVudHMgPSBhd2FpdCB0aGlzLnN0dWJIdWJTZWFyY2hlci5zZWFyY2hDb25jZXJ0cyhcclxuICAgICAgICBwYXJhbXMuYXJ0aXN0IHx8IHBhcmFtcy5rZXl3b3JkIHx8ICcnLFxyXG4gICAgICAgIHBhcmFtcy52ZW51ZSB8fCAnJyxcclxuICAgICAgICBwYXJhbXMubG9jYXRpb24gfHwgJydcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGxvZ2dlci5pbmZvKGBGb3VuZCAke3Jhd0V2ZW50cy5sZW5ndGh9IFN0dWJIdWIgZXZlbnRzYCk7XHJcblxyXG4gICAgICAvLyBQcm9jZXNzIGVhY2ggZXZlbnQgc2VxdWVudGlhbGx5IHRvIGF2b2lkIHJhY2UgY29uZGl0aW9uc1xyXG4gICAgICBjb25zdCBzdG9yZWRFdmVudHMgPSBbXTtcclxuICAgICAgZm9yIChjb25zdCBldmVudCBvZiByYXdFdmVudHMpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgLy8gUGFyc2UgdGhlIGRhdGUgc3RyaW5nIHByb3Blcmx5XHJcbiAgICAgICAgICBjb25zdCBkYXRlUmVnZXggPSAvKFtBLVphLXpdKylcXHMrKFxcZCspXFxzKyhcXGR7NH0pLio/KFxcZCs6XFxkK1xccypbQVBdTSkvaTtcclxuICAgICAgICAgIGNvbnN0IG1hdGNoID0gZXZlbnQuZGF0ZS5tYXRjaChkYXRlUmVnZXgpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoIW1hdGNoKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIHBhcnNlIFN0dWJIdWIgZGF0ZTonLCBldmVudC5kYXRlKTtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgY29uc3QgW18sIG1vbnRoLCBkYXksIHllYXIsIHRpbWVdID0gbWF0Y2g7XHJcbiAgICAgICAgICBjb25zdCBzdGFuZGFyZERhdGVTdHIgPSBgJHttb250aH0gJHtkYXl9ICR7eWVhcn0gJHt0aW1lfWA7XHJcbiAgICAgICAgICBjb25zdCBwYXJzZWREYXRlID0gcGFyc2Uoc3RhbmRhcmREYXRlU3RyLCAnTU1NIGQgeXl5eSBoOm1tIGEnLCBuZXcgRGF0ZSgpKTtcclxuXHJcbiAgICAgICAgICBpZiAoaXNOYU4ocGFyc2VkRGF0ZS5nZXRUaW1lKCkpKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignSW52YWxpZCBkYXRlIGFmdGVyIHBhcnNpbmc6Jywgc3RhbmRhcmREYXRlU3RyKTtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gQ2hlY2sgZm9yIGV4aXN0aW5nIGV2ZW50XHJcbiAgICAgICAgICBjb25zdCBtYXRjaGluZ0V2ZW50ID0gYXdhaXQgZmluZE1hdGNoaW5nRXZlbnQoXHJcbiAgICAgICAgICAgIHRoaXMuc3VwYWJhc2UsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBuYW1lOiBldmVudC5uYW1lLFxyXG4gICAgICAgICAgICAgIGRhdGU6IHBhcnNlZERhdGUudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICB2ZW51ZTogZXZlbnQudmVudWVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N0dWJodWInXHJcbiAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgIGlmIChtYXRjaGluZ0V2ZW50KSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGBGb3VuZCBtYXRjaGluZyBldmVudCBmb3IgU3R1Ykh1YjogJHttYXRjaGluZ0V2ZW50Lm5hbWV9YCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBBZGQgU3R1Ykh1YiBsaW5rIGlmIGl0IGRvZXNuJ3QgZXhpc3RcclxuICAgICAgICAgICAgaWYgKCFtYXRjaGluZ0V2ZW50Lmhhc1NvdXJjZUxpbmspIHtcclxuICAgICAgICAgICAgICBjb25zdCB7IGVycm9yOiBsaW5rRXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgICAgIC5mcm9tKCdldmVudF9saW5rcycpXHJcbiAgICAgICAgICAgICAgICAuaW5zZXJ0KHtcclxuICAgICAgICAgICAgICAgICAgZXZlbnRfaWQ6IG1hdGNoaW5nRXZlbnQuaWQsXHJcbiAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3N0dWJodWInLFxyXG4gICAgICAgICAgICAgICAgICB1cmw6IGV2ZW50LmxpbmtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICBpZiAobGlua0Vycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGluc2VydGluZyBTdHViSHViIGxpbms6JywgbGlua0Vycm9yKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oJ0FkZGVkIFN0dWJIdWIgbGluayB0byBleGlzdGluZyBldmVudCcpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gSW5zZXJ0IG9yIHVwZGF0ZSB0aWNrZXRzXHJcbiAgICAgICAgICAgIGlmIChldmVudC50aWNrZXRzPy5zZWN0aW9ucykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHRpY2tldHMgPSB0aGlzLnRyYW5zZm9ybVRpY2tldHMobWF0Y2hpbmdFdmVudC5pZCwge1xyXG4gICAgICAgICAgICAgICAgLi4uZXZlbnQsXHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6ICdzdHViaHViJ1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICBpZiAodGlja2V0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGVycm9yOiB0aWNrZXRFcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgICAgICAuZnJvbSgndGlja2V0cycpXHJcbiAgICAgICAgICAgICAgICAgIC5pbnNlcnQodGlja2V0cyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRpY2tldEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgaW5zZXJ0aW5nIFN0dWJIdWIgdGlja2V0czonLCB0aWNrZXRFcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhgSW5zZXJ0ZWQgJHt0aWNrZXRzLmxlbmd0aH0gU3R1Ykh1YiB0aWNrZXRzYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgdXBkYXRlZCBldmVudCBkYXRhXHJcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZEV2ZW50IH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcbiAgICAgICAgICAgICAgLmZyb20oJ2V2ZW50cycpXHJcbiAgICAgICAgICAgICAgLnNlbGVjdChgXHJcbiAgICAgICAgICAgICAgICAqLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRfbGlua3MgKCopLFxyXG4gICAgICAgICAgICAgICAgdGlja2V0cyAoKilcclxuICAgICAgICAgICAgICBgKVxyXG4gICAgICAgICAgICAgIC5lcSgnaWQnLCBtYXRjaGluZ0V2ZW50LmlkKVxyXG4gICAgICAgICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh1cGRhdGVkRXZlbnQpIHtcclxuICAgICAgICAgICAgICBzdG9yZWRFdmVudHMucHVzaCh1cGRhdGVkRXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBJbnNlcnQgbmV3IGV2ZW50XHJcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogbmV3RXZlbnQsIGVycm9yOiBldmVudEVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcbiAgICAgICAgICAgICAgLmZyb20oJ2V2ZW50cycpXHJcbiAgICAgICAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBldmVudC5uYW1lLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ0NvbmNlcnQnLFxyXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGV2ZW50LmNhdGVnb3J5IHx8ICdDb25jZXJ0JyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHBhcnNlZERhdGUudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHZlbnVlOiBldmVudC52ZW51ZVxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgLnNlbGVjdCgpXHJcbiAgICAgICAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50RXJyb3IpIHtcclxuICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGluc2VydGluZyBuZXcgU3R1Ykh1YiBldmVudDonLCBldmVudEVycm9yKTtcclxuICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oYENyZWF0ZWQgbmV3IGV2ZW50OiAke25ld0V2ZW50Lm5hbWV9YCk7XHJcblxyXG4gICAgICAgICAgICAvLyBJbnNlcnQgU3R1Ykh1YiBsaW5rXHJcbiAgICAgICAgICAgIGNvbnN0IHsgZXJyb3I6IGxpbmtFcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgIC5mcm9tKCdldmVudF9saW5rcycpXHJcbiAgICAgICAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICAgICAgICBldmVudF9pZDogbmV3RXZlbnQuaWQsXHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6ICdzdHViaHViJyxcclxuICAgICAgICAgICAgICAgIHVybDogZXZlbnQubGlua1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGxpbmtFcnJvcikge1xyXG4gICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgaW5zZXJ0aW5nIG5ldyBTdHViSHViIGxpbms6JywgbGlua0Vycm9yKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gSW5zZXJ0IHRpY2tldHNcclxuICAgICAgICAgICAgaWYgKGV2ZW50LnRpY2tldHM/LnNlY3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgdGlja2V0cyA9IHRoaXMudHJhbnNmb3JtVGlja2V0cyhuZXdFdmVudC5pZCwge1xyXG4gICAgICAgICAgICAgICAgLi4uZXZlbnQsXHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6ICdzdHViaHViJ1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICBpZiAodGlja2V0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGVycm9yOiB0aWNrZXRFcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgICAgICAuZnJvbSgndGlja2V0cycpXHJcbiAgICAgICAgICAgICAgICAgIC5pbnNlcnQodGlja2V0cyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRpY2tldEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgaW5zZXJ0aW5nIG5ldyBTdHViSHViIHRpY2tldHM6JywgdGlja2V0RXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oYEluc2VydGVkICR7dGlja2V0cy5sZW5ndGh9IG5ldyBTdHViSHViIHRpY2tldHNgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEdldCBjb21wbGV0ZSBldmVudCBkYXRhXHJcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogY29tcGxldGVFdmVudCB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgIC5mcm9tKCdldmVudHMnKVxyXG4gICAgICAgICAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgICAgICAgICAgKixcclxuICAgICAgICAgICAgICAgIGV2ZW50X2xpbmtzICgqKSxcclxuICAgICAgICAgICAgICAgIHRpY2tldHMgKCopXHJcbiAgICAgICAgICAgICAgYClcclxuICAgICAgICAgICAgICAuZXEoJ2lkJywgbmV3RXZlbnQuaWQpXHJcbiAgICAgICAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNvbXBsZXRlRXZlbnQpIHtcclxuICAgICAgICAgICAgICBzdG9yZWRFdmVudHMucHVzaChjb21wbGV0ZUV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHByb2Nlc3NpbmcgU3R1Ykh1YiBldmVudDonLCBlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBsb2dnZXIuaW5mbyhgU3VjY2Vzc2Z1bGx5IHN0b3JlZCAke3N0b3JlZEV2ZW50cy5sZW5ndGh9IFN0dWJIdWIgZXZlbnRzYCk7XHJcbiAgICAgIHJldHVybiBzdG9yZWRFdmVudHM7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBsb2dnZXIuZXJyb3IoJ1N0dWJIdWIgc2VhcmNoIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBzZWFyY2hWaXZpZFNlYXRzKHBhcmFtczogU2VhcmNoUGFyYW1zKTogUHJvbWlzZTxFdmVudFtdPiB7XHJcbiAgICBsZXQgYnJvd3NlciA9IG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByYXdFdmVudHMgPSBhd2FpdCB0aGlzLnZpdmlkU2VhdHNTZWFyY2hlci5zZWFyY2hDb25jZXJ0cyhcclxuICAgICAgICBwYXJhbXMuYXJ0aXN0IHx8IHBhcmFtcy5rZXl3b3JkIHx8ICcnLFxyXG4gICAgICAgIHBhcmFtcy52ZW51ZSB8fCAnJyxcclxuICAgICAgICBwYXJhbXMubG9jYXRpb24gfHwgJydcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGxvZ2dlci5pbmZvKGBGb3VuZCAke3Jhd0V2ZW50cy5sZW5ndGh9IFZpdmlkU2VhdHMgZXZlbnRzYCk7XHJcblxyXG4gICAgICAvLyBQcm9jZXNzIGVhY2ggZXZlbnQgc2VxdWVudGlhbGx5IHRvIGF2b2lkIHJhY2UgY29uZGl0aW9uc1xyXG4gICAgICBjb25zdCBzdG9yZWRFdmVudHMgPSBbXTtcclxuICAgICAgZm9yIChjb25zdCBldmVudCBvZiByYXdFdmVudHMpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgLy8gUGFyc2UgVml2aWRTZWF0cyBkYXRlIGZvcm1hdFxyXG4gICAgICAgICAgY29uc3QgZGF0ZVJlZ2V4ID0gLyhbQS1aYS16XSspXFxzKyhcXGQrKVxccytbQS1aYS16XStcXHMrKFxcZCs6XFxkK1thcF1tKS9pO1xyXG4gICAgICAgICAgY29uc3QgbWF0Y2ggPSBldmVudC5kYXRlLm1hdGNoKGRhdGVSZWdleCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmICghbWF0Y2gpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgVml2aWRTZWF0cyBkYXRlOicsIGV2ZW50LmRhdGUpO1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBjb25zdCBbXywgbW9udGgsIGRheSwgdGltZV0gPSBtYXRjaDtcclxuICAgICAgICAgIGNvbnN0IHllYXIgPSAnMjAyNSc7IC8vIERlZmF1bHQgdG8gMjAyNSBmb3IgZnV0dXJlIGRhdGVzXHJcbiAgICAgICAgICBjb25zdCBzdGFuZGFyZERhdGVTdHIgPSBgJHttb250aH0gJHtkYXl9ICR7eWVhcn0gJHt0aW1lfWA7XHJcbiAgICAgICAgICBjb25zdCBwYXJzZWREYXRlID0gcGFyc2Uoc3RhbmRhcmREYXRlU3RyLCAnTU1NIGQgeXl5eSBoOm1tYScsIG5ldyBEYXRlKCkpO1xyXG5cclxuICAgICAgICAgIGlmIChpc05hTihwYXJzZWREYXRlLmdldFRpbWUoKSkpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdJbnZhbGlkIGRhdGUgYWZ0ZXIgcGFyc2luZzonLCBzdGFuZGFyZERhdGVTdHIpO1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBDaGVjayBmb3IgZXhpc3RpbmcgZXZlbnRcclxuICAgICAgICAgIGNvbnN0IG1hdGNoaW5nRXZlbnQgPSBhd2FpdCBmaW5kTWF0Y2hpbmdFdmVudChcclxuICAgICAgICAgICAgdGhpcy5zdXBhYmFzZSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIG5hbWU6IGV2ZW50LnRpdGxlLFxyXG4gICAgICAgICAgICAgIGRhdGU6IHBhcnNlZERhdGUudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICB2ZW51ZTogZXZlbnQudmVudWVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3Zpdmlkc2VhdHMnXHJcbiAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgIGlmIChtYXRjaGluZ0V2ZW50KSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGBGb3VuZCBtYXRjaGluZyBldmVudCBmb3IgVml2aWRTZWF0czogJHttYXRjaGluZ0V2ZW50Lm5hbWV9YCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBBZGQgVml2aWRTZWF0cyBsaW5rIGlmIGl0IGRvZXNuJ3QgZXhpc3RcclxuICAgICAgICAgICAgaWYgKCFtYXRjaGluZ0V2ZW50Lmhhc1NvdXJjZUxpbmspIHtcclxuICAgICAgICAgICAgICBjb25zdCB7IGVycm9yOiBsaW5rRXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgICAgIC5mcm9tKCdldmVudF9saW5rcycpXHJcbiAgICAgICAgICAgICAgICAuaW5zZXJ0KHtcclxuICAgICAgICAgICAgICAgICAgZXZlbnRfaWQ6IG1hdGNoaW5nRXZlbnQuaWQsXHJcbiAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3Zpdmlkc2VhdHMnLFxyXG4gICAgICAgICAgICAgICAgICB1cmw6IGV2ZW50LmxpbmtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICBpZiAobGlua0Vycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGluc2VydGluZyBWaXZpZFNlYXRzIGxpbms6JywgbGlua0Vycm9yKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oJ0FkZGVkIFZpdmlkU2VhdHMgbGluayB0byBleGlzdGluZyBldmVudCcpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gSW5zZXJ0IG9yIHVwZGF0ZSB0aWNrZXRzXHJcbiAgICAgICAgICAgIGlmIChldmVudC50aWNrZXRzPy5zZWN0aW9ucykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHRpY2tldHMgPSB0aGlzLnRyYW5zZm9ybVRpY2tldHMobWF0Y2hpbmdFdmVudC5pZCwge1xyXG4gICAgICAgICAgICAgICAgLi4uZXZlbnQsXHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6ICd2aXZpZHNlYXRzJ1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICBpZiAodGlja2V0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGVycm9yOiB0aWNrZXRFcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxyXG4gICAgICAgICAgICAgICAgICAuZnJvbSgndGlja2V0cycpXHJcbiAgICAgICAgICAgICAgICAgIC5pbnNlcnQodGlja2V0cyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRpY2tldEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgaW5zZXJ0aW5nIFZpdmlkU2VhdHMgdGlja2V0czonLCB0aWNrZXRFcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhgSW5zZXJ0ZWQgJHt0aWNrZXRzLmxlbmd0aH0gVml2aWRTZWF0cyB0aWNrZXRzYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgdXBkYXRlZCBldmVudCBkYXRhXHJcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZEV2ZW50IH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcbiAgICAgICAgICAgICAgLmZyb20oJ2V2ZW50cycpXHJcbiAgICAgICAgICAgICAgLnNlbGVjdChgXHJcbiAgICAgICAgICAgICAgICAqLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRfbGlua3MgKCopLFxyXG4gICAgICAgICAgICAgICAgdGlja2V0cyAoKilcclxuICAgICAgICAgICAgICBgKVxyXG4gICAgICAgICAgICAgIC5lcSgnaWQnLCBtYXRjaGluZ0V2ZW50LmlkKVxyXG4gICAgICAgICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh1cGRhdGVkRXZlbnQpIHtcclxuICAgICAgICAgICAgICBzdG9yZWRFdmVudHMucHVzaCh1cGRhdGVkRXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBJbnNlcnQgbmV3IGV2ZW50XHJcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogbmV3RXZlbnQsIGVycm9yOiBldmVudEVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXHJcbiAgICAgICAgICAgICAgLmZyb20oJ2V2ZW50cycpXHJcbiAgICAgICAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBldmVudC50aXRsZSxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdDb25jZXJ0JyxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnQ29uY2VydCcsXHJcbiAgICAgICAgICAgICAgICBkYXRlOiBwYXJzZWREYXRlLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB2ZW51ZTogZXZlbnQudmVudWVcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAgICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChldmVudEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBpbnNlcnRpbmcgbmV3IFZpdmlkU2VhdHMgZXZlbnQ6JywgZXZlbnRFcnJvcik7XHJcbiAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGBDcmVhdGVkIG5ldyBldmVudDogJHtuZXdFdmVudC5uYW1lfWApO1xyXG5cclxuICAgICAgICAgICAgLy8gSW5zZXJ0IFZpdmlkU2VhdHMgbGlua1xyXG4gICAgICAgICAgICBjb25zdCB7IGVycm9yOiBsaW5rRXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgICAuZnJvbSgnZXZlbnRfbGlua3MnKVxyXG4gICAgICAgICAgICAgIC5pbnNlcnQoe1xyXG4gICAgICAgICAgICAgICAgZXZlbnRfaWQ6IG5ld0V2ZW50LmlkLFxyXG4gICAgICAgICAgICAgICAgc291cmNlOiAndml2aWRzZWF0cycsXHJcbiAgICAgICAgICAgICAgICB1cmw6IGV2ZW50LmxpbmtcclxuICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChsaW5rRXJyb3IpIHtcclxuICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGluc2VydGluZyBuZXcgVml2aWRTZWF0cyBsaW5rOicsIGxpbmtFcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEluc2VydCB0aWNrZXRzXHJcbiAgICAgICAgICAgIGlmIChldmVudC50aWNrZXRzPy5zZWN0aW9ucykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHRpY2tldHMgPSB0aGlzLnRyYW5zZm9ybVRpY2tldHMobmV3RXZlbnQuaWQsIHtcclxuICAgICAgICAgICAgICAgIC4uLmV2ZW50LFxyXG4gICAgICAgICAgICAgICAgc291cmNlOiAndml2aWRzZWF0cydcclxuICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgaWYgKHRpY2tldHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBlcnJvcjogdGlja2V0RXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgICAgICAgLmZyb20oJ3RpY2tldHMnKVxyXG4gICAgICAgICAgICAgICAgICAuaW5zZXJ0KHRpY2tldHMpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aWNrZXRFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGluc2VydGluZyBuZXcgVml2aWRTZWF0cyB0aWNrZXRzOicsIHRpY2tldEVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGBJbnNlcnRlZCAke3RpY2tldHMubGVuZ3RofSBuZXcgVml2aWRTZWF0cyB0aWNrZXRzYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY29tcGxldGUgZXZlbnQgZGF0YVxyXG4gICAgICAgICAgICBjb25zdCB7IGRhdGE6IGNvbXBsZXRlRXZlbnQgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcclxuICAgICAgICAgICAgICAuZnJvbSgnZXZlbnRzJylcclxuICAgICAgICAgICAgICAuc2VsZWN0KGBcclxuICAgICAgICAgICAgICAgICosXHJcbiAgICAgICAgICAgICAgICBldmVudF9saW5rcyAoKiksXHJcbiAgICAgICAgICAgICAgICB0aWNrZXRzICgqKVxyXG4gICAgICAgICAgICAgIGApXHJcbiAgICAgICAgICAgICAgLmVxKCdpZCcsIG5ld0V2ZW50LmlkKVxyXG4gICAgICAgICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjb21wbGV0ZUV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgc3RvcmVkRXZlbnRzLnB1c2goY29tcGxldGVFdmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIFZpdmlkU2VhdHMgZXZlbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgbG9nZ2VyLmluZm8oYFN1Y2Nlc3NmdWxseSBzdG9yZWQgJHtzdG9yZWRFdmVudHMubGVuZ3RofSBWaXZpZFNlYXRzIGV2ZW50c2ApO1xyXG4gICAgICByZXR1cm4gc3RvcmVkRXZlbnRzO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgbG9nZ2VyLmVycm9yKCdWaXZpZFNlYXRzIHNlYXJjaCBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIGlmIChicm93c2VyKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBjbG9zaW5nIGJyb3dzZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHNlYXJjaFNlcnZpY2UgPSBuZXcgU2VhcmNoU2VydmljZSgpOyAiXSwibmFtZXMiOlsiU3R1Ykh1YlNlYXJjaGVyIiwiVml2aWRTZWF0c1NlYXJjaGVyIiwiY3JlYXRlQ2xpZW50IiwiY29uZmlnIiwiZmluZE1hdGNoaW5nRXZlbnQiLCJsb2dnZXIiLCJwYXJzZSIsIlNlYXJjaFNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsInN1cGFiYXNlIiwidXJsIiwic2VydmljZUtleSIsInN0dWJIdWJTZWFyY2hlciIsInZpdmlkU2VhdHNTZWFyY2hlciIsInNlYXJjaEFsbCIsInBhcmFtcyIsInNlYXJjaFN0YXJ0VGltZSIsIkRhdGUiLCJkYXRhIiwiZXhpc3RpbmdFdmVudHMiLCJmcm9tIiwic2VsZWN0IiwiaWxpa2UiLCJrZXl3b3JkIiwiYXJ0aXN0IiwiZ3RlIiwidG9JU09TdHJpbmciLCJpbmZvIiwibGVuZ3RoIiwic2VhcmNoZXMiLCJzb3VyY2VzIiwic291cmNlIiwicHVzaCIsInNlYXJjaFN0dWJIdWIiLCJ0aGVuIiwicmVzdWx0cyIsInN0dWJodWIiLCJpc0xpdmUiLCJsYXN0VXBkYXRlZCIsImNhdGNoIiwiZXJyb3IiLCJmaW5kIiwiZSIsImV2ZW50X2xpbmtzIiwic29tZSIsImwiLCJ1cGRhdGVkX2F0IiwibWVzc2FnZSIsInNlYXJjaFZpdmlkU2VhdHMiLCJ2aXZpZHNlYXRzIiwiUHJvbWlzZSIsInJhY2UiLCJhbGwiLCJfIiwicmVqZWN0Iiwic2V0VGltZW91dCIsIkVycm9yIiwiYWxsRXZlbnRzIiwiZmxhdCIsImV2ZW50TWFwIiwiTWFwIiwiZm9yRWFjaCIsImV2ZW50Iiwia2V5IiwibmFtZSIsImRhdGUiLCJ2ZW51ZSIsImhhcyIsInRpY2tldHMiLCJnZXQiLCJzZXQiLCJjb21iaW5lZFJlc3VsdHMiLCJBcnJheSIsInZhbHVlcyIsInRvdGFsUmVzdWx0cyIsIk9iamVjdCIsImtleXMiLCJzdWNjZXNzIiwibWV0YWRhdGEiLCJ0b3RhbCIsInN0b3JlRXZlbnQiLCJtYXRjaGluZ0V2ZW50IiwidGl0bGUiLCJoYXNTb3VyY2VMaW5rIiwibGlua0Vycm9yIiwiaW5zZXJ0IiwiZXZlbnRfaWQiLCJpZCIsImxpbmsiLCJzZWN0aW9ucyIsInRyYW5zZm9ybVRpY2tldHMiLCJ0aWNrZXRFcnJvciIsInVwZGF0ZWRFdmVudCIsImVxIiwic2luZ2xlIiwibmV3RXZlbnQiLCJldmVudEVycm9yIiwidHlwZSIsImNhdGVnb3J5IiwiY29tcGxldGVFdmVudCIsImV2ZW50SWQiLCJmbGF0TWFwIiwic2VjdGlvbiIsIm1hcCIsInRpY2tldCIsInByaWNlIiwicmF3UHJpY2UiLCJyb3ciLCJxdWFudGl0eSIsInBhcnNlSW50IiwibGlzdGluZ1VybCIsImxpc3RpbmdfaWQiLCJsaXN0aW5nSWQiLCJyYXdfZGF0YSIsInJhd0V2ZW50cyIsInNlYXJjaENvbmNlcnRzIiwibG9jYXRpb24iLCJzdG9yZWRFdmVudHMiLCJkYXRlUmVnZXgiLCJtYXRjaCIsIm1vbnRoIiwiZGF5IiwieWVhciIsInRpbWUiLCJzdGFuZGFyZERhdGVTdHIiLCJwYXJzZWREYXRlIiwiaXNOYU4iLCJnZXRUaW1lIiwiYnJvd3NlciIsImNsb3NlIiwic2VhcmNoU2VydmljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/services/search-service.ts\n");

/***/ }),

/***/ "(api)/./lib/utils/logger.ts":
/*!*****************************!*\
  !*** ./lib/utils/logger.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\nconst logger = {\n    info: (message, data)=>{\n        console.log(`[INFO] ${message}`, data || \"\");\n    },\n    error: (message, error)=>{\n        console.error(`[ERROR] ${message}`, error || \"\");\n    },\n    debug: (message, data)=>{\n        if (true) {\n            console.log(`[DEBUG] ${message}`, data || \"\");\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvdXRpbHMvbG9nZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTyxNQUFNQSxTQUFTO0lBQ3BCQyxNQUFNLENBQUNDLFNBQWlCQztRQUN0QkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFSCxRQUFRLENBQUMsRUFBRUMsUUFBUTtJQUMzQztJQUNBRyxPQUFPLENBQUNKLFNBQWlCSTtRQUN2QkYsUUFBUUUsS0FBSyxDQUFDLENBQUMsUUFBUSxFQUFFSixRQUFRLENBQUMsRUFBRUksU0FBUztJQUMvQztJQUNBQyxPQUFPLENBQUNMLFNBQWlCQztRQUN2QixJQUFJSyxJQUF5QixFQUFlO1lBQzFDSixRQUFRQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUVILFFBQVEsQ0FBQyxFQUFFQyxRQUFRO1FBQzVDO0lBQ0Y7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGlja2V0LXNlYXJjaGVyLy4vbGliL3V0aWxzL2xvZ2dlci50cz83NTY1Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBsb2dnZXIgPSB7XHJcbiAgaW5mbzogKG1lc3NhZ2U6IHN0cmluZywgZGF0YT86IGFueSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coYFtJTkZPXSAke21lc3NhZ2V9YCwgZGF0YSB8fCAnJyk7XHJcbiAgfSxcclxuICBlcnJvcjogKG1lc3NhZ2U6IHN0cmluZywgZXJyb3I/OiBhbnkpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtFUlJPUl0gJHttZXNzYWdlfWAsIGVycm9yIHx8ICcnKTtcclxuICB9LFxyXG4gIGRlYnVnOiAobWVzc2FnZTogc3RyaW5nLCBkYXRhPzogYW55KSA9PiB7XHJcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtERUJVR10gJHttZXNzYWdlfWAsIGRhdGEgfHwgJycpO1xyXG4gICAgfVxyXG4gIH1cclxufTsgIl0sIm5hbWVzIjpbImxvZ2dlciIsImluZm8iLCJtZXNzYWdlIiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsImRlYnVnIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/utils/logger.ts\n");

/***/ }),

/***/ "(api)/./pages/api/events/search.ts":
/*!************************************!*\
  !*** ./pages/api/events/search.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_services_search_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/services/search-service */ \"(api)/./lib/services/search-service.ts\");\n/* harmony import */ var _lib_utils_logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/utils/logger */ \"(api)/./lib/utils/logger.ts\");\n\n\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            success: false,\n            error: \"Method not allowed\",\n            metadata: {}\n        });\n    }\n    try {\n        const params = req.body;\n        _lib_utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info(\"Search request received\", params);\n        const result = await _lib_services_search_service__WEBPACK_IMPORTED_MODULE_0__.searchService.searchAll({\n            ...params,\n            source: \"all\"\n        });\n        if (!result.success) {\n            _lib_utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(\"Search failed:\", result.error);\n            return res.status(500).json(result);\n        }\n        return res.status(200).json(result);\n    } catch (error) {\n        _lib_utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(\"API error:\", error);\n        return res.status(500).json({\n            success: false,\n            error: error instanceof Error ? error.message : \"Internal server error\",\n            metadata: {\n                error: error instanceof Error ? error.stack : \"Unknown error\"\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvZXZlbnRzL3NlYXJjaC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFDOEQ7QUFFbEI7QUFFN0IsZUFBZUUsUUFDNUJDLEdBQW1CLEVBQ25CQyxHQUFrQztJQUVsQyxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUN6QixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQzFCQyxTQUFTO1lBQ1RDLE9BQU87WUFDUEMsVUFBVSxDQUFDO1FBQ2I7SUFDRjtJQUVBLElBQUk7UUFDRixNQUFNQyxTQUFTUixJQUFJUyxJQUFJO1FBQ3ZCWCxxREFBTUEsQ0FBQ1ksSUFBSSxDQUFDLDJCQUEyQkY7UUFFdkMsTUFBTUcsU0FBUyxNQUFNZCx1RUFBYUEsQ0FBQ2UsU0FBUyxDQUFDO1lBQzNDLEdBQUdKLE1BQU07WUFDVEssUUFBUTtRQUNWO1FBRUEsSUFBSSxDQUFDRixPQUFPTixPQUFPLEVBQUU7WUFDbkJQLHFEQUFNQSxDQUFDUSxLQUFLLENBQUMsa0JBQWtCSyxPQUFPTCxLQUFLO1lBQzNDLE9BQU9MLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUNPO1FBQzlCO1FBRUEsT0FBT1YsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQ087SUFDOUIsRUFBRSxPQUFPTCxPQUFPO1FBQ2RSLHFEQUFNQSxDQUFDUSxLQUFLLENBQUMsY0FBY0E7UUFDM0IsT0FBT0wsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUMxQkMsU0FBUztZQUNUQyxPQUFPQSxpQkFBaUJRLFFBQVFSLE1BQU1TLE9BQU8sR0FBRztZQUNoRFIsVUFBVTtnQkFDUkQsT0FBT0EsaUJBQWlCUSxRQUFRUixNQUFNVSxLQUFLLEdBQUc7WUFDaEQ7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aWNrZXQtc2VhcmNoZXIvLi9wYWdlcy9hcGkvZXZlbnRzL3NlYXJjaC50cz9hZWJiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcclxuaW1wb3J0IHsgc2VhcmNoU2VydmljZSB9IGZyb20gJ0AvbGliL3NlcnZpY2VzL3NlYXJjaC1zZXJ2aWNlJztcclxuaW1wb3J0IHR5cGUgeyBTZWFyY2hQYXJhbXMsIFNlYXJjaFJlc3VsdCB9IGZyb20gJ0AvbGliL3R5cGVzL2FwaSc7XHJcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0AvbGliL3V0aWxzL2xvZ2dlcic7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxyXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXHJcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2U8U2VhcmNoUmVzdWx0PlxyXG4pIHtcclxuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnLFxyXG4gICAgICBtZXRhZGF0YToge31cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHBhcmFtcyA9IHJlcS5ib2R5IGFzIFNlYXJjaFBhcmFtcztcclxuICAgIGxvZ2dlci5pbmZvKCdTZWFyY2ggcmVxdWVzdCByZWNlaXZlZCcsIHBhcmFtcyk7XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VhcmNoU2VydmljZS5zZWFyY2hBbGwoe1xyXG4gICAgICAuLi5wYXJhbXMsXHJcbiAgICAgIHNvdXJjZTogJ2FsbCdcclxuICAgIH0pO1xyXG5cclxuICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgbG9nZ2VyLmVycm9yKCdTZWFyY2ggZmFpbGVkOicsIHJlc3VsdC5lcnJvcik7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbihyZXN1bHQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihyZXN1bHQpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBsb2dnZXIuZXJyb3IoJ0FQSSBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ludGVybmFsIHNlcnZlciBlcnJvcicsXHJcbiAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6ICdVbmtub3duIGVycm9yJ1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbInNlYXJjaFNlcnZpY2UiLCJsb2dnZXIiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsIm1ldGFkYXRhIiwicGFyYW1zIiwiYm9keSIsImluZm8iLCJyZXN1bHQiLCJzZWFyY2hBbGwiLCJzb3VyY2UiLCJFcnJvciIsIm1lc3NhZ2UiLCJzdGFjayJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/events/search.ts\n");

/***/ }),

/***/ "(api)/./src/config/env.ts":
/*!***************************!*\
  !*** ./src/config/env.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config)\n/* harmony export */ });\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dotenv */ \"dotenv\");\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(dotenv__WEBPACK_IMPORTED_MODULE_0__);\n\n// Load environment variables\ndotenv__WEBPACK_IMPORTED_MODULE_0___default().config();\nconst config = {\n    supabase: {\n        url: \"https://rkctqjbksmszuhrocxxm.supabase.co\",\n        serviceKey: process.env.SUPABASE_SERVICE_KEY,\n        anonKey: process.env.SUPABASE_KEY\n    },\n    environment: \"development\" || 0\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvY29uZmlnL2Vudi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNEI7QUFFNUIsNkJBQTZCO0FBQzdCQSxvREFBYTtBQUVOLE1BQU1DLFNBQVM7SUFDcEJDLFVBQVU7UUFDUkMsS0FBS0MsMENBQW9DO1FBQ3pDRyxZQUFZSCxRQUFRQyxHQUFHLENBQUNHLG9CQUFvQjtRQUM1Q0MsU0FBU0wsUUFBUUMsR0FBRyxDQUFDSyxZQUFZO0lBQ25DO0lBQ0FDLGFBQWFQLGlCQUF3QjtBQUN2QyxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGlja2V0LXNlYXJjaGVyLy4vc3JjL2NvbmZpZy9lbnYudHM/NWFmMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZG90ZW52IGZyb20gJ2RvdGVudic7XHJcblxyXG4vLyBMb2FkIGVudmlyb25tZW50IHZhcmlhYmxlc1xyXG5kb3RlbnYuY29uZmlnKCk7XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIHN1cGFiYXNlOiB7XHJcbiAgICB1cmw6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXHJcbiAgICBzZXJ2aWNlS2V5OiBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX0tFWSEsXHJcbiAgICBhbm9uS2V5OiBwcm9jZXNzLmVudi5TVVBBQkFTRV9LRVkhXHJcbiAgfSxcclxuICBlbnZpcm9ubWVudDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50J1xyXG59OyAiXSwibmFtZXMiOlsiZG90ZW52IiwiY29uZmlnIiwic3VwYWJhc2UiLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic2VydmljZUtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfS0VZIiwiYW5vbktleSIsIlNVUEFCQVNFX0tFWSIsImVudmlyb25tZW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/config/env.ts\n");

/***/ }),

/***/ "(api)/./src/event-utils.js":
/*!****************************!*\
  !*** ./src/event-utils.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   findMatchingEvent: () => (/* binding */ findMatchingEvent),\n/* harmony export */   getBaseArtistName: () => (/* binding */ getBaseArtistName),\n/* harmony export */   getNameSimilarity: () => (/* binding */ getNameSimilarity),\n/* harmony export */   normalizeString: () => (/* binding */ normalizeString)\n/* harmony export */ });\n/* harmony import */ var _barrel_optimize_names_isSameDay_parse_date_fns__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! __barrel_optimize__?names=isSameDay,parse!=!date-fns */ \"(api)/__barrel_optimize__?names=isSameDay,parse!=!./node_modules/date-fns/index.js\");\n\n// Function to normalize strings for comparison\nfunction normalizeString(str) {\n    if (!str) return \"\";\n    return str.toLowerCase().replace(/[^a-z0-9]/g, \"\").replace(/\\s+/g, \"\");\n}\n// Function to get the base artist name (removing suffixes like \"(18+ Event)\")\nfunction getBaseArtistName(name) {\n    if (!name) return \"\";\n    return name.split(/[\\(\\[]/, 1)[0].trim();\n}\n// Function to score name similarity\nfunction getNameSimilarity(name1, name2) {\n    if (!name1 || !name2) return 0;\n    const norm1 = normalizeString(name1);\n    const norm2 = normalizeString(name2);\n    // Direct match\n    if (norm1 === norm2) return 1;\n    // One contains the other\n    if (norm1.includes(norm2) || norm2.includes(norm1)) return 0.8;\n    // Calculate character overlap\n    const chars1 = new Set(norm1);\n    const chars2 = new Set(norm2);\n    const intersection = new Set([\n        ...chars1\n    ].filter((x)=>chars2.has(x)));\n    return intersection.size / Math.max(chars1.size, chars2.size);\n}\n// Function to parse date from different formats\nfunction parseEventDate(dateStr) {\n    if (!dateStr) return null;\n    // Try VividSeats format first (e.g., \"Jan 17 Fri 7:00pm\")\n    const vividSeatsRegex = /([A-Za-z]+)\\s+(\\d+)\\s+[A-Za-z]+\\s+(\\d+:\\d+[ap]m)/i;\n    const vividMatch = dateStr.match(vividSeatsRegex);\n    if (vividMatch) {\n        const [_, month, day, time] = vividMatch;\n        const year = \"2025\"; // Default to 2025 for future dates\n        const standardDateStr = `${month} ${day} ${year} ${time}`;\n        return (0,_barrel_optimize_names_isSameDay_parse_date_fns__WEBPACK_IMPORTED_MODULE_0__.parse)(standardDateStr, \"MMM d yyyy h:mma\", new Date());\n    }\n    // Try StubHub format (e.g., \"Jan 17 2025 7:00 PM\")\n    const stubHubRegex = /([A-Za-z]+)\\s+(\\d+)\\s+(\\d{4}).*?(\\d+:\\d+\\s*[AP]M)/i;\n    const stubMatch = dateStr.match(stubHubRegex);\n    if (stubMatch) {\n        const [_, month, day, year, time] = stubMatch;\n        const standardDateStr = `${month} ${day} ${year} ${time}`;\n        return (0,_barrel_optimize_names_isSameDay_parse_date_fns__WEBPACK_IMPORTED_MODULE_0__.parse)(standardDateStr, \"MMM d yyyy h:mm a\", new Date());\n    }\n    // If no matches, try direct parsing\n    try {\n        return new Date(dateStr);\n    } catch (e) {\n        console.error(\"Failed to parse date:\", dateStr);\n        return null;\n    }\n}\n// Function to find matching event\nasync function findMatchingEvent(supabaseClient, eventDetails, source) {\n    console.log(\"Searching for matching event:\", {\n        name: eventDetails.name || eventDetails.title,\n        date: eventDetails.date,\n        venue: eventDetails.venue,\n        source\n    });\n    try {\n        // First, try to find exact matches\n        const { data: exactMatches, error: exactError } = await supabaseClient.from(\"events\").select(`\r\n        id,\r\n        name,\r\n        date,\r\n        venue,\r\n        event_links (\r\n          url,\r\n          source\r\n        )\r\n      `).ilike(\"name\", getBaseArtistName(eventDetails.name || eventDetails.title)).gte(\"date\", new Date().toISOString());\n        if (exactError) {\n            console.error(\"Error searching for exact matches:\", exactError);\n            return null;\n        }\n        // Parse the new event's date\n        const newEventDate = parseEventDate(eventDetails.date);\n        if (!newEventDate) {\n            console.error(\"Could not parse event date:\", eventDetails.date);\n            return null;\n        }\n        console.log(\"Parsed new event date:\", newEventDate);\n        // First, try to find an exact match (same artist, same day, similar venue)\n        const exactMatch = exactMatches?.find((existingEvent)=>{\n            const existingDate = new Date(existingEvent.date);\n            return (0,_barrel_optimize_names_isSameDay_parse_date_fns__WEBPACK_IMPORTED_MODULE_0__.isSameDay)(existingDate, newEventDate) && getNameSimilarity(existingEvent.venue, eventDetails.venue) > 0.6;\n        });\n        if (exactMatch) {\n            console.log(\"Found exact match:\", exactMatch.name);\n            return {\n                ...exactMatch,\n                hasSourceLink: exactMatch.event_links.some((link)=>link.source === source)\n            };\n        }\n        // If no exact match, look for similar events\n        const matches = exactMatches.map((existingEvent)=>{\n            const existingDate = new Date(existingEvent.date);\n            const nameSimilarity = getNameSimilarity(getBaseArtistName(existingEvent.name), getBaseArtistName(eventDetails.name || eventDetails.title));\n            const venueSimilarity = getNameSimilarity(existingEvent.venue, eventDetails.venue);\n            const dateMatch = (0,_barrel_optimize_names_isSameDay_parse_date_fns__WEBPACK_IMPORTED_MODULE_0__.isSameDay)(existingDate, newEventDate);\n            const dateDiffInDays = Math.abs(existingDate.getTime() - newEventDate.getTime()) / (1000 * 60 * 60 * 24);\n            // Scoring system:\n            // - Name similarity: 0-40 points\n            // - Venue similarity: 0-30 points\n            // - Date match: 30 points\n            // - Date proximity penalty: -2 points per day difference (up to -20)\n            const score = nameSimilarity * 0.4 + venueSimilarity * 0.3 + (dateMatch ? 0.3 : Math.max(-0.2, -0.02 * dateDiffInDays));\n            console.log(\"Match details:\", {\n                existingName: existingEvent.name,\n                newName: eventDetails.name || eventDetails.title,\n                nameSimilarity,\n                venueSimilarity,\n                dateMatch,\n                dateDiffInDays,\n                score\n            });\n            return {\n                event: existingEvent,\n                score,\n                hasSourceLink: existingEvent.event_links.some((link)=>link.source === source)\n            };\n        }).filter((match)=>match.score > 0.8) // Require a very high match score\n        .sort((a, b)=>b.score - a.score);\n        if (matches.length > 0) {\n            const bestMatch = matches[0];\n            console.log(`Found matching event: \"${bestMatch.event.name}\" (score: ${bestMatch.score.toFixed(2)})`);\n            // Choose the better name\n            const existingName = bestMatch.event.name;\n            const newName = eventDetails.name || eventDetails.title;\n            // Prefer names without parentheses or special characters\n            const shouldUpdateName = existingName.includes(\"(\") && !newName.includes(\"(\") || existingName.includes(\"[\") && !newName.includes(\"[\") || existingName.length > newName.length && newName.length > 3;\n            if (shouldUpdateName) {\n                console.log(`Updating event name from \"${existingName}\" to \"${newName}\"`);\n                await supabaseClient.from(\"events\").update({\n                    name: newName\n                }).eq(\"id\", bestMatch.event.id);\n                bestMatch.event.name = newName;\n            }\n            return {\n                ...bestMatch.event,\n                hasSourceLink: bestMatch.hasSourceLink\n            };\n        }\n        return null;\n    } catch (error) {\n        console.error(\"Error in findMatchingEvent:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUM1QjNCLFFBQVFNLEdBQUcsQ0FBQyxDQUFDLHVCQUF1QixFQUFFcUMsVUFBVUwsS0FBSyxDQUFDeEUsSUFBSSxDQUFDLFVBQVUsRUFBRTZFLFVBQVVSLEtBQUssQ0FBQ1MsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRXBHLHlCQUF5QjtZQUN6QixNQUFNUixlQUFlTyxVQUFVTCxLQUFLLENBQUN4RSxJQUFJO1lBQ3pDLE1BQU11RSxVQUFVakMsYUFBYXRDLElBQUksSUFBSXNDLGFBQWFHLEtBQUs7WUFFdkQseURBQXlEO1lBQ3pELE1BQU1zQyxtQkFDSixhQUFjdkUsUUFBUSxDQUFDLFFBQVEsQ0FBQytELFFBQVEvRCxRQUFRLENBQUMsUUFDaEQ4RCxhQUFhOUQsUUFBUSxDQUFDLFFBQVEsQ0FBQytELFFBQVEvRCxRQUFRLENBQUMsUUFDaEQ4RCxhQUFhTSxNQUFNLEdBQUdMLFFBQVFLLE1BQU0sSUFBSUwsUUFBUUssTUFBTSxHQUFHO1lBRTVELElBQUlHLGtCQUFrQjtnQkFDcEI3QyxRQUFRTSxHQUFHLENBQUMsQ0FBQywwQkFBMEIsRUFBRThCLGFBQWEsTUFBTSxFQUFFQyxRQUFRLENBQUMsQ0FBQztnQkFDeEUsTUFBTWxDLGVBQ0hVLElBQUksQ0FBQyxVQUNMaUMsTUFBTSxDQUFDO29CQUFFaEYsTUFBTXVFO2dCQUFRLEdBQ3ZCVSxFQUFFLENBQUMsTUFBTUosVUFBVUwsS0FBSyxDQUFDVSxFQUFFO2dCQUU5QkwsVUFBVUwsS0FBSyxDQUFDeEUsSUFBSSxHQUFHdUU7WUFDekI7WUFFQSxPQUFPO2dCQUNMLEdBQUdNLFVBQVVMLEtBQUs7Z0JBQ2xCZixlQUFlb0IsVUFBVXBCLGFBQWE7WUFDeEM7UUFDRjtRQUVBLE9BQU87SUFDVCxFQUFFLE9BQU90QixPQUFPO1FBQ2RELFFBQVFDLEtBQUssQ0FBQywrQkFBK0JBO1FBQzdDLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGlja2V0LXNlYXJjaGVyLy4vc3JjL2V2ZW50LXV0aWxzLmpzP2U3MjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcGFyc2UsIGlzU2FtZURheSB9IGZyb20gJ2RhdGUtZm5zJztcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIG5vcm1hbGl6ZSBzdHJpbmdzIGZvciBjb21wYXJpc29uXHJcbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVTdHJpbmcoc3RyKSB7XHJcbiAgaWYgKCFzdHIpIHJldHVybiAnJztcclxuICByZXR1cm4gc3RyLnRvTG93ZXJDYXNlKClcclxuICAgIC5yZXBsYWNlKC9bXmEtejAtOV0vZywgJycpXHJcbiAgICAucmVwbGFjZSgvXFxzKy9nLCAnJyk7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGdldCB0aGUgYmFzZSBhcnRpc3QgbmFtZSAocmVtb3Zpbmcgc3VmZml4ZXMgbGlrZSBcIigxOCsgRXZlbnQpXCIpXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRCYXNlQXJ0aXN0TmFtZShuYW1lKSB7XHJcbiAgaWYgKCFuYW1lKSByZXR1cm4gJyc7XHJcbiAgcmV0dXJuIG5hbWUuc3BsaXQoL1tcXChcXFtdLywgMSlbMF0udHJpbSgpO1xyXG59XHJcblxyXG4vLyBGdW5jdGlvbiB0byBzY29yZSBuYW1lIHNpbWlsYXJpdHlcclxuZXhwb3J0IGZ1bmN0aW9uIGdldE5hbWVTaW1pbGFyaXR5KG5hbWUxLCBuYW1lMikge1xyXG4gIGlmICghbmFtZTEgfHwgIW5hbWUyKSByZXR1cm4gMDtcclxuICBcclxuICBjb25zdCBub3JtMSA9IG5vcm1hbGl6ZVN0cmluZyhuYW1lMSk7XHJcbiAgY29uc3Qgbm9ybTIgPSBub3JtYWxpemVTdHJpbmcobmFtZTIpO1xyXG4gIFxyXG4gIC8vIERpcmVjdCBtYXRjaFxyXG4gIGlmIChub3JtMSA9PT0gbm9ybTIpIHJldHVybiAxO1xyXG4gIFxyXG4gIC8vIE9uZSBjb250YWlucyB0aGUgb3RoZXJcclxuICBpZiAobm9ybTEuaW5jbHVkZXMobm9ybTIpIHx8IG5vcm0yLmluY2x1ZGVzKG5vcm0xKSkgcmV0dXJuIDAuODtcclxuICBcclxuICAvLyBDYWxjdWxhdGUgY2hhcmFjdGVyIG92ZXJsYXBcclxuICBjb25zdCBjaGFyczEgPSBuZXcgU2V0KG5vcm0xKTtcclxuICBjb25zdCBjaGFyczIgPSBuZXcgU2V0KG5vcm0yKTtcclxuICBjb25zdCBpbnRlcnNlY3Rpb24gPSBuZXcgU2V0KFsuLi5jaGFyczFdLmZpbHRlcih4ID0+IGNoYXJzMi5oYXMoeCkpKTtcclxuICByZXR1cm4gaW50ZXJzZWN0aW9uLnNpemUgLyBNYXRoLm1heChjaGFyczEuc2l6ZSwgY2hhcnMyLnNpemUpO1xyXG59XHJcblxyXG4vLyBGdW5jdGlvbiB0byBwYXJzZSBkYXRlIGZyb20gZGlmZmVyZW50IGZvcm1hdHNcclxuZnVuY3Rpb24gcGFyc2VFdmVudERhdGUoZGF0ZVN0cikge1xyXG4gIGlmICghZGF0ZVN0cikgcmV0dXJuIG51bGw7XHJcblxyXG4gIC8vIFRyeSBWaXZpZFNlYXRzIGZvcm1hdCBmaXJzdCAoZS5nLiwgXCJKYW4gMTcgRnJpIDc6MDBwbVwiKVxyXG4gIGNvbnN0IHZpdmlkU2VhdHNSZWdleCA9IC8oW0EtWmEtel0rKVxccysoXFxkKylcXHMrW0EtWmEtel0rXFxzKyhcXGQrOlxcZCtbYXBdbSkvaTtcclxuICBjb25zdCB2aXZpZE1hdGNoID0gZGF0ZVN0ci5tYXRjaCh2aXZpZFNlYXRzUmVnZXgpO1xyXG4gIGlmICh2aXZpZE1hdGNoKSB7XHJcbiAgICBjb25zdCBbXywgbW9udGgsIGRheSwgdGltZV0gPSB2aXZpZE1hdGNoO1xyXG4gICAgY29uc3QgeWVhciA9ICcyMDI1JzsgLy8gRGVmYXVsdCB0byAyMDI1IGZvciBmdXR1cmUgZGF0ZXNcclxuICAgIGNvbnN0IHN0YW5kYXJkRGF0ZVN0ciA9IGAke21vbnRofSAke2RheX0gJHt5ZWFyfSAke3RpbWV9YDtcclxuICAgIHJldHVybiBwYXJzZShzdGFuZGFyZERhdGVTdHIsICdNTU0gZCB5eXl5IGg6bW1hJywgbmV3IERhdGUoKSk7XHJcbiAgfVxyXG5cclxuICAvLyBUcnkgU3R1Ykh1YiBmb3JtYXQgKGUuZy4sIFwiSmFuIDE3IDIwMjUgNzowMCBQTVwiKVxyXG4gIGNvbnN0IHN0dWJIdWJSZWdleCA9IC8oW0EtWmEtel0rKVxccysoXFxkKylcXHMrKFxcZHs0fSkuKj8oXFxkKzpcXGQrXFxzKltBUF1NKS9pO1xyXG4gIGNvbnN0IHN0dWJNYXRjaCA9IGRhdGVTdHIubWF0Y2goc3R1Ykh1YlJlZ2V4KTtcclxuICBpZiAoc3R1Yk1hdGNoKSB7XHJcbiAgICBjb25zdCBbXywgbW9udGgsIGRheSwgeWVhciwgdGltZV0gPSBzdHViTWF0Y2g7XHJcbiAgICBjb25zdCBzdGFuZGFyZERhdGVTdHIgPSBgJHttb250aH0gJHtkYXl9ICR7eWVhcn0gJHt0aW1lfWA7XHJcbiAgICByZXR1cm4gcGFyc2Uoc3RhbmRhcmREYXRlU3RyLCAnTU1NIGQgeXl5eSBoOm1tIGEnLCBuZXcgRGF0ZSgpKTtcclxuICB9XHJcblxyXG4gIC8vIElmIG5vIG1hdGNoZXMsIHRyeSBkaXJlY3QgcGFyc2luZ1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gbmV3IERhdGUoZGF0ZVN0cik7XHJcbiAgfSBjYXRjaCAoZSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIGRhdGU6JywgZGF0ZVN0cik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGZpbmQgbWF0Y2hpbmcgZXZlbnRcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRNYXRjaGluZ0V2ZW50KHN1cGFiYXNlQ2xpZW50LCBldmVudERldGFpbHMsIHNvdXJjZSkge1xyXG4gIGNvbnNvbGUubG9nKCdTZWFyY2hpbmcgZm9yIG1hdGNoaW5nIGV2ZW50OicsIHtcclxuICAgIG5hbWU6IGV2ZW50RGV0YWlscy5uYW1lIHx8IGV2ZW50RGV0YWlscy50aXRsZSxcclxuICAgIGRhdGU6IGV2ZW50RGV0YWlscy5kYXRlLFxyXG4gICAgdmVudWU6IGV2ZW50RGV0YWlscy52ZW51ZSxcclxuICAgIHNvdXJjZVxyXG4gIH0pO1xyXG5cclxuICB0cnkge1xyXG4gICAgLy8gRmlyc3QsIHRyeSB0byBmaW5kIGV4YWN0IG1hdGNoZXNcclxuICAgIGNvbnN0IHsgZGF0YTogZXhhY3RNYXRjaGVzLCBlcnJvcjogZXhhY3RFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VDbGllbnRcclxuICAgICAgLmZyb20oJ2V2ZW50cycpXHJcbiAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgIGlkLFxyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgZGF0ZSxcclxuICAgICAgICB2ZW51ZSxcclxuICAgICAgICBldmVudF9saW5rcyAoXHJcbiAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICBzb3VyY2VcclxuICAgICAgICApXHJcbiAgICAgIGApXHJcbiAgICAgIC5pbGlrZSgnbmFtZScsIGdldEJhc2VBcnRpc3ROYW1lKGV2ZW50RGV0YWlscy5uYW1lIHx8IGV2ZW50RGV0YWlscy50aXRsZSkpXHJcbiAgICAgIC5ndGUoJ2RhdGUnLCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkpO1xyXG5cclxuICAgIGlmIChleGFjdEVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlYXJjaGluZyBmb3IgZXhhY3QgbWF0Y2hlczonLCBleGFjdEVycm9yKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUGFyc2UgdGhlIG5ldyBldmVudCdzIGRhdGVcclxuICAgIGNvbnN0IG5ld0V2ZW50RGF0ZSA9IHBhcnNlRXZlbnREYXRlKGV2ZW50RGV0YWlscy5kYXRlKTtcclxuICAgIGlmICghbmV3RXZlbnREYXRlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NvdWxkIG5vdCBwYXJzZSBldmVudCBkYXRlOicsIGV2ZW50RGV0YWlscy5kYXRlKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ1BhcnNlZCBuZXcgZXZlbnQgZGF0ZTonLCBuZXdFdmVudERhdGUpO1xyXG5cclxuICAgIC8vIEZpcnN0LCB0cnkgdG8gZmluZCBhbiBleGFjdCBtYXRjaCAoc2FtZSBhcnRpc3QsIHNhbWUgZGF5LCBzaW1pbGFyIHZlbnVlKVxyXG4gICAgY29uc3QgZXhhY3RNYXRjaCA9IGV4YWN0TWF0Y2hlcz8uZmluZChleGlzdGluZ0V2ZW50ID0+IHtcclxuICAgICAgY29uc3QgZXhpc3RpbmdEYXRlID0gbmV3IERhdGUoZXhpc3RpbmdFdmVudC5kYXRlKTtcclxuICAgICAgcmV0dXJuIGlzU2FtZURheShleGlzdGluZ0RhdGUsIG5ld0V2ZW50RGF0ZSkgJiZcclxuICAgICAgICAgICAgIGdldE5hbWVTaW1pbGFyaXR5KGV4aXN0aW5nRXZlbnQudmVudWUsIGV2ZW50RGV0YWlscy52ZW51ZSkgPiAwLjY7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoZXhhY3RNYXRjaCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnRm91bmQgZXhhY3QgbWF0Y2g6JywgZXhhY3RNYXRjaC5uYW1lKTtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICAuLi5leGFjdE1hdGNoLFxyXG4gICAgICAgIGhhc1NvdXJjZUxpbms6IGV4YWN0TWF0Y2guZXZlbnRfbGlua3Muc29tZShsaW5rID0+IGxpbmsuc291cmNlID09PSBzb3VyY2UpXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgbm8gZXhhY3QgbWF0Y2gsIGxvb2sgZm9yIHNpbWlsYXIgZXZlbnRzXHJcbiAgICBjb25zdCBtYXRjaGVzID0gZXhhY3RNYXRjaGVzXHJcbiAgICAgIC5tYXAoZXhpc3RpbmdFdmVudCA9PiB7XHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdEYXRlID0gbmV3IERhdGUoZXhpc3RpbmdFdmVudC5kYXRlKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBuYW1lU2ltaWxhcml0eSA9IGdldE5hbWVTaW1pbGFyaXR5KFxyXG4gICAgICAgICAgZ2V0QmFzZUFydGlzdE5hbWUoZXhpc3RpbmdFdmVudC5uYW1lKSxcclxuICAgICAgICAgIGdldEJhc2VBcnRpc3ROYW1lKGV2ZW50RGV0YWlscy5uYW1lIHx8IGV2ZW50RGV0YWlscy50aXRsZSlcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHZlbnVlU2ltaWxhcml0eSA9IGdldE5hbWVTaW1pbGFyaXR5KFxyXG4gICAgICAgICAgZXhpc3RpbmdFdmVudC52ZW51ZSxcclxuICAgICAgICAgIGV2ZW50RGV0YWlscy52ZW51ZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgZGF0ZU1hdGNoID0gaXNTYW1lRGF5KGV4aXN0aW5nRGF0ZSwgbmV3RXZlbnREYXRlKTtcclxuICAgICAgICBjb25zdCBkYXRlRGlmZkluRGF5cyA9IE1hdGguYWJzKGV4aXN0aW5nRGF0ZS5nZXRUaW1lKCkgLSBuZXdFdmVudERhdGUuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KTtcclxuXHJcbiAgICAgICAgLy8gU2NvcmluZyBzeXN0ZW06XHJcbiAgICAgICAgLy8gLSBOYW1lIHNpbWlsYXJpdHk6IDAtNDAgcG9pbnRzXHJcbiAgICAgICAgLy8gLSBWZW51ZSBzaW1pbGFyaXR5OiAwLTMwIHBvaW50c1xyXG4gICAgICAgIC8vIC0gRGF0ZSBtYXRjaDogMzAgcG9pbnRzXHJcbiAgICAgICAgLy8gLSBEYXRlIHByb3hpbWl0eSBwZW5hbHR5OiAtMiBwb2ludHMgcGVyIGRheSBkaWZmZXJlbmNlICh1cCB0byAtMjApXHJcbiAgICAgICAgY29uc3Qgc2NvcmUgPSAobmFtZVNpbWlsYXJpdHkgKiAwLjQpICsgXHJcbiAgICAgICAgICAgICAgICAgICAgICh2ZW51ZVNpbWlsYXJpdHkgKiAwLjMpICsgXHJcbiAgICAgICAgICAgICAgICAgICAgIChkYXRlTWF0Y2ggPyAwLjMgOiBNYXRoLm1heCgtMC4yLCAtMC4wMiAqIGRhdGVEaWZmSW5EYXlzKSk7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdNYXRjaCBkZXRhaWxzOicsIHtcclxuICAgICAgICAgIGV4aXN0aW5nTmFtZTogZXhpc3RpbmdFdmVudC5uYW1lLFxyXG4gICAgICAgICAgbmV3TmFtZTogZXZlbnREZXRhaWxzLm5hbWUgfHwgZXZlbnREZXRhaWxzLnRpdGxlLFxyXG4gICAgICAgICAgbmFtZVNpbWlsYXJpdHksXHJcbiAgICAgICAgICB2ZW51ZVNpbWlsYXJpdHksXHJcbiAgICAgICAgICBkYXRlTWF0Y2gsXHJcbiAgICAgICAgICBkYXRlRGlmZkluRGF5cyxcclxuICAgICAgICAgIHNjb3JlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBldmVudDogZXhpc3RpbmdFdmVudCxcclxuICAgICAgICAgIHNjb3JlLFxyXG4gICAgICAgICAgaGFzU291cmNlTGluazogZXhpc3RpbmdFdmVudC5ldmVudF9saW5rcy5zb21lKGxpbmsgPT4gbGluay5zb3VyY2UgPT09IHNvdXJjZSlcclxuICAgICAgICB9O1xyXG4gICAgICB9KVxyXG4gICAgICAuZmlsdGVyKG1hdGNoID0+IG1hdGNoLnNjb3JlID4gMC44KSAvLyBSZXF1aXJlIGEgdmVyeSBoaWdoIG1hdGNoIHNjb3JlXHJcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSk7XHJcblxyXG4gICAgaWYgKG1hdGNoZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zdCBiZXN0TWF0Y2ggPSBtYXRjaGVzWzBdO1xyXG4gICAgICBjb25zb2xlLmxvZyhgRm91bmQgbWF0Y2hpbmcgZXZlbnQ6IFwiJHtiZXN0TWF0Y2guZXZlbnQubmFtZX1cIiAoc2NvcmU6ICR7YmVzdE1hdGNoLnNjb3JlLnRvRml4ZWQoMil9KWApO1xyXG4gICAgICBcclxuICAgICAgLy8gQ2hvb3NlIHRoZSBiZXR0ZXIgbmFtZVxyXG4gICAgICBjb25zdCBleGlzdGluZ05hbWUgPSBiZXN0TWF0Y2guZXZlbnQubmFtZTtcclxuICAgICAgY29uc3QgbmV3TmFtZSA9IGV2ZW50RGV0YWlscy5uYW1lIHx8IGV2ZW50RGV0YWlscy50aXRsZTtcclxuICAgICAgXHJcbiAgICAgIC8vIFByZWZlciBuYW1lcyB3aXRob3V0IHBhcmVudGhlc2VzIG9yIHNwZWNpYWwgY2hhcmFjdGVyc1xyXG4gICAgICBjb25zdCBzaG91bGRVcGRhdGVOYW1lID0gXHJcbiAgICAgICAgKGV4aXN0aW5nTmFtZS5pbmNsdWRlcygnKCcpICYmICFuZXdOYW1lLmluY2x1ZGVzKCcoJykpIHx8XHJcbiAgICAgICAgKGV4aXN0aW5nTmFtZS5pbmNsdWRlcygnWycpICYmICFuZXdOYW1lLmluY2x1ZGVzKCdbJykpIHx8XHJcbiAgICAgICAgKGV4aXN0aW5nTmFtZS5sZW5ndGggPiBuZXdOYW1lLmxlbmd0aCAmJiBuZXdOYW1lLmxlbmd0aCA+IDMpO1xyXG4gICAgICBcclxuICAgICAgaWYgKHNob3VsZFVwZGF0ZU5hbWUpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgVXBkYXRpbmcgZXZlbnQgbmFtZSBmcm9tIFwiJHtleGlzdGluZ05hbWV9XCIgdG8gXCIke25ld05hbWV9XCJgKTtcclxuICAgICAgICBhd2FpdCBzdXBhYmFzZUNsaWVudFxyXG4gICAgICAgICAgLmZyb20oJ2V2ZW50cycpXHJcbiAgICAgICAgICAudXBkYXRlKHsgbmFtZTogbmV3TmFtZSB9KVxyXG4gICAgICAgICAgLmVxKCdpZCcsIGJlc3RNYXRjaC5ldmVudC5pZCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgYmVzdE1hdGNoLmV2ZW50Lm5hbWUgPSBuZXdOYW1lO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIC4uLmJlc3RNYXRjaC5ldmVudCxcclxuICAgICAgICBoYXNTb3VyY2VMaW5rOiBiZXN0TWF0Y2guaGFzU291cmNlTGlua1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBmaW5kTWF0Y2hpbmdFdmVudDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbInBhcnNlIiwiaXNTYW1lRGF5Iiwibm9ybWFsaXplU3RyaW5nIiwic3RyIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwiZ2V0QmFzZUFydGlzdE5hbWUiLCJuYW1lIiwic3BsaXQiLCJ0cmltIiwiZ2V0TmFtZVNpbWlsYXJpdHkiLCJuYW1lMSIsIm5hbWUyIiwibm9ybTEiLCJub3JtMiIsImluY2x1ZGVzIiwiY2hhcnMxIiwiU2V0IiwiY2hhcnMyIiwiaW50ZXJzZWN0aW9uIiwiZmlsdGVyIiwieCIsImhhcyIsInNpemUiLCJNYXRoIiwibWF4IiwicGFyc2VFdmVudERhdGUiLCJkYXRlU3RyIiwidml2aWRTZWF0c1JlZ2V4Iiwidml2aWRNYXRjaCIsIm1hdGNoIiwiXyIsIm1vbnRoIiwiZGF5IiwidGltZSIsInllYXIiLCJzdGFuZGFyZERhdGVTdHIiLCJEYXRlIiwic3R1Ykh1YlJlZ2V4Iiwic3R1Yk1hdGNoIiwiZSIsImNvbnNvbGUiLCJlcnJvciIsImZpbmRNYXRjaGluZ0V2ZW50Iiwic3VwYWJhc2VDbGllbnQiLCJldmVudERldGFpbHMiLCJzb3VyY2UiLCJsb2ciLCJ0aXRsZSIsImRhdGUiLCJ2ZW51ZSIsImRhdGEiLCJleGFjdE1hdGNoZXMiLCJleGFjdEVycm9yIiwiZnJvbSIsInNlbGVjdCIsImlsaWtlIiwiZ3RlIiwidG9JU09TdHJpbmciLCJuZXdFdmVudERhdGUiLCJleGFjdE1hdGNoIiwiZmluZCIsImV4aXN0aW5nRXZlbnQiLCJleGlzdGluZ0RhdGUiLCJoYXNTb3VyY2VMaW5rIiwiZXZlbnRfbGlua3MiLCJzb21lIiwibGluayIsIm1hdGNoZXMiLCJtYXAiLCJuYW1lU2ltaWxhcml0eSIsInZlbnVlU2ltaWxhcml0eSIsImRhdGVNYXRjaCIsImRhdGVEaWZmSW5EYXlzIiwiYWJzIiwiZ2V0VGltZSIsInNjb3JlIiwiZXhpc3RpbmdOYW1lIiwibmV3TmFtZSIsImV2ZW50Iiwic29ydCIsImEiLCJiIiwibGVuZ3RoIiwiYmVzdE1hdGNoIiwidG9GaXhlZCIsInNob3VsZFVwZGF0ZU5hbWUiLCJ1cGRhdGUiLCJlcSIsImlkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/event-utils.js\n");

/***/ }),

/***/ "(api)/./src/stub-hub.js":
/*!*************************!*\
  !*** ./src/stub-hub.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _src_config_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/src/config/env */ \"(api)/./src/config/env.ts\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils.js */ \"(api)/./src/utils.js\");\n\n\n\n\nconst supabaseClient = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(_src_config_env__WEBPACK_IMPORTED_MODULE_1__.config.supabase.url, _src_config_env__WEBPACK_IMPORTED_MODULE_1__.config.supabase.serviceKey);\nclass StubHubSearcher {\n    constructor(){\n        this.baseUrl = \"https://www.stubhub.com/secure/search\";\n    }\n    generateSearchUrl(artist, venue, location) {\n        const searchParams = new URLSearchParams();\n        const searchTerms = [\n            artist,\n            venue,\n            location\n        ].filter(Boolean);\n        searchParams.append(\"q\", searchTerms.join(\" \"));\n        return `${this.baseUrl}?${searchParams.toString()}`;\n    }\n    async setupBrowser() {\n        return await (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.setupBrowser)();\n    }\n    async setupPage(browser) {\n        return await (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.setupPage)(browser);\n    }\n    async getTicketPrices(eventUrl, existingPage = null) {\n        let browser = null;\n        let page = existingPage;\n        try {\n            if (!existingPage) {\n                browser = await this.setupBrowser();\n                page = await this.setupPage(browser);\n                console.log(\"Navigating to event page:\", eventUrl);\n                // Initial navigation\n                await page.goto(eventUrl, {\n                    waitUntil: \"domcontentloaded\",\n                    timeout: 30000\n                });\n            }\n            // Function to check for listings container\n            const checkListingsContainer = async ()=>{\n                console.log(\"Checking for listings container...\");\n                const content = await page.content();\n                return content.includes(\"listings-container\");\n            };\n            // First check\n            let hasListings = await checkListingsContainer();\n            // If not found, try reloading\n            if (!hasListings) {\n                console.log(\"Listings container not found, reloading page...\");\n                try {\n                    await Promise.race([\n                        page.reload({\n                            waitUntil: \"domcontentloaded\"\n                        }),\n                        new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Reload timeout\")), 10000))\n                    ]);\n                    // Wait a moment for any dynamic content\n                    await page.waitForTimeout(2000);\n                    // Check again after reload\n                    hasListings = await checkListingsContainer();\n                    if (!hasListings) {\n                        console.log(\"Listings container still not found after reload, trying alternative approach...\");\n                        // Try navigating to the URL again\n                        await page.goto(eventUrl, {\n                            waitUntil: \"domcontentloaded\",\n                            timeout: 10000\n                        });\n                        await page.waitForTimeout(2000);\n                        hasListings = await checkListingsContainer();\n                    }\n                } catch (reloadError) {\n                    console.log(\"Reload failed, trying alternative approach...\", reloadError.message);\n                    // If reload times out, try navigating to the URL again\n                    await page.goto(eventUrl, {\n                        waitUntil: \"domcontentloaded\",\n                        timeout: 10000\n                    });\n                    await page.waitForTimeout(2000);\n                    hasListings = await checkListingsContainer();\n                }\n            }\n            // Wait for listings container with multiple selector attempts\n            let listingsFound = false;\n            const selectors = [\n                \"#listings-container\",\n                '[data-testid=\"listings-container\"]',\n                \".listing-container\",\n                '[data-testid=\"event-listings\"]'\n            ];\n            console.log(\"Waiting for listings container to be visible...\");\n            for (const selector of selectors){\n                try {\n                    await page.waitForSelector(selector, {\n                        timeout: 5000,\n                        visible: true\n                    });\n                    console.log(`Found listings container with selector: ${selector}`);\n                    listingsFound = true;\n                    break;\n                } catch (error) {\n                    console.log(`Selector ${selector} not found, trying next...`);\n                }\n            }\n            if (!listingsFound) {\n                console.error(\"Could not find listings container with any known selector\");\n                await page.screenshot({\n                    path: \"listings-error.png\",\n                    fullPage: true\n                });\n                throw new Error(\"Listings container not found after all attempts\");\n            }\n            // Wait for actual ticket listings to load with shorter timeout\n            await page.waitForFunction(()=>{\n                const listings = document.querySelectorAll(\"[data-listing-id]\");\n                return listings.length > 0;\n            }, {\n                timeout: 10000\n            });\n            // Additional delay to ensure all dynamic content is loaded\n            await page.waitForTimeout(1000);\n            const tickets = await page.evaluate(()=>{\n                const listings = Array.from(document.querySelectorAll(\"[data-listing-id]\"));\n                console.log(`Processing ${listings.length} listings`);\n                const ticketsBySection = {};\n                listings.forEach((listing, index)=>{\n                    try {\n                        // Skip sold tickets\n                        if (listing.getAttribute(\"data-is-sold\") === \"1\") return;\n                        // Get section name with multiple selector attempts\n                        const section = listing.querySelector(\".sc-hlalgf-6\")?.textContent?.trim() || listing.querySelector('[data-testid=\"section-name\"]')?.textContent?.trim() || listing.querySelector('[data-auto=\"listing-section\"]')?.textContent?.trim() || \"General Admission\";\n                        // Get price with multiple selector attempts\n                        const priceElement = listing.querySelector('[data-testid=\"listing-price\"]') || listing.querySelector(\".sc-hlalgf-1\") || listing.querySelector('[data-auto=\"listing-price\"]');\n                        const price = priceElement?.textContent?.trim();\n                        // Get quantity with multiple selector attempts\n                        const quantity = listing.querySelector(\".sc-hlalgf-14\")?.textContent?.trim() || listing.querySelector('[data-testid=\"quantity\"]')?.textContent?.trim() || listing.querySelector('[data-auto=\"listing-quantity\"]')?.textContent?.trim();\n                        if (!price) return;\n                        if (!ticketsBySection[section]) {\n                            ticketsBySection[section] = {\n                                section,\n                                tickets: [],\n                                lowestPrice: Infinity,\n                                highestPrice: -Infinity,\n                                numberOfListings: 0\n                            };\n                        }\n                        const numericPrice = parseFloat(price.replace(/[^0-9.]/g, \"\"));\n                        const ticketInfo = {\n                            quantity,\n                            price,\n                            rawPrice: numericPrice,\n                            listingUrl: window.location.href,\n                            listingId: listing.getAttribute(\"data-listing-id\")\n                        };\n                        ticketsBySection[section].tickets.push(ticketInfo);\n                        if (!isNaN(numericPrice)) {\n                            ticketsBySection[section].lowestPrice = Math.min(ticketsBySection[section].lowestPrice, numericPrice);\n                            ticketsBySection[section].highestPrice = Math.max(ticketsBySection[section].highestPrice, numericPrice);\n                            ticketsBySection[section].numberOfListings++;\n                        }\n                    } catch (err) {\n                        console.log(`Error processing listing ${index}:`, err);\n                    }\n                });\n                Object.values(ticketsBySection).forEach((section)=>{\n                    if (section.lowestPrice === Infinity) section.lowestPrice = null;\n                    if (section.highestPrice === -Infinity) section.highestPrice = null;\n                    section.tickets.sort((a, b)=>(a.rawPrice || Infinity) - (b.rawPrice || Infinity));\n                });\n                return {\n                    totalSections: Object.keys(ticketsBySection).length,\n                    sections: Object.values(ticketsBySection)\n                };\n            });\n            console.log(`Found tickets in ${tickets.totalSections} sections`);\n            return tickets;\n        } catch (error) {\n            console.error(\"Error fetching ticket prices:\", error);\n            if (page) {\n                await page.screenshot({\n                    path: \"error-state.png\",\n                    fullPage: true\n                });\n                const content = await page.content();\n                console.log(\"Page content at error:\", content.substring(0, 500) + \"...\");\n            }\n            return {\n                totalSections: 0,\n                sections: []\n            };\n        } finally{\n            if (browser && !existingPage) {\n                await browser.close();\n            }\n        }\n    }\n    async searchConcerts(artist, venue, location) {\n        const browser = await this.setupBrowser();\n        let searchPage;\n        let eventPage;\n        try {\n            searchPage = await this.setupPage(browser);\n            const searchUrl = this.generateSearchUrl(artist, venue, location);\n            console.log(\"Searching StubHub:\", searchUrl);\n            await searchPage.goto(searchUrl, {\n                waitUntil: \"networkidle0\",\n                timeout: 30000\n            });\n            console.log(\"Page loaded, checking content...\");\n            await searchPage.waitForTimeout(2000);\n            let content = await searchPage.content();\n            if (!content.includes('data-testid=\"primaryGrid\"')) {\n                console.log(\"Reloading page due to missing content...\");\n                await searchPage.reload({\n                    waitUntil: \"domcontentloaded\"\n                });\n                await searchPage.waitForTimeout(3000);\n            }\n            console.log(\"Waiting for primary grid...\");\n            await searchPage.waitForSelector('[data-testid=\"primaryGrid\"]');\n            console.log(\"Found primary grid, extracting events...\");\n            await searchPage.waitForTimeout(2000);\n            const events = await this.extractEventDetails(searchPage);\n            console.log(`\\nRaw events extracted: ${events.length}`);\n            const matchingEvents = events.filter((event)=>{\n                console.log(\"Checking event:\", event.name);\n                const titleMatch = !artist || event.name.toLowerCase().includes(artist.toLowerCase());\n                const venueMatch = !venue || event.venue.toLowerCase().includes(venue.toLowerCase());\n                const locationMatch = !location || event.location.toLowerCase().includes(location.toLowerCase());\n                console.log(\"Match results:\", {\n                    titleMatch,\n                    venueMatch,\n                    locationMatch\n                });\n                return titleMatch && venueMatch && locationMatch;\n            });\n            console.log(\"Found matching events:\", matchingEvents.length);\n            // Create a Set to track processed event URLs\n            const processedUrls = new Set();\n            const eventsWithTickets = [];\n            for (const event of matchingEvents){\n                // Skip if we've already processed this event URL\n                if (processedUrls.has(event.link)) {\n                    console.log(\"Skipping duplicate event URL:\", event.link);\n                    continue;\n                }\n                const { success, page: newPage } = await this.navigateToEvent(searchPage, event);\n                if (success && newPage) {\n                    eventPage = newPage;\n                    const tickets = await this.getTicketPrices(event.link, eventPage);\n                    console.log(\"Scraped Tickets:\", JSON.stringify(tickets, null, 2));\n                    eventsWithTickets.push({\n                        name: event.name,\n                        date: event.date,\n                        venue: event.venue,\n                        location: event.location,\n                        category: event.category,\n                        link: event.link,\n                        source: event.source,\n                        tickets: tickets\n                    });\n                    // Mark this URL as processed\n                    processedUrls.add(event.link);\n                    await eventPage.close();\n                    await searchPage.waitForTimeout(1000);\n                }\n            }\n            return eventsWithTickets;\n        } catch (error) {\n            console.error(\"Search error:\", error);\n            if (searchPage) {\n                await searchPage.screenshot({\n                    path: \"error.png\",\n                    fullPage: true\n                });\n            }\n            return [];\n        } finally{\n            if (eventPage && !eventPage.isClosed()) await eventPage.close();\n            if (searchPage && !searchPage.isClosed()) await searchPage.close();\n            if (browser) await browser.close();\n        }\n    }\n    // Updated extractEventDetails method\n    async extractEventDetails(page) {\n        console.log(\"Starting event extraction in Node\");\n        const results = await page.evaluate(()=>{\n            const results = {\n                logs: [],\n                events: []\n            };\n            const eventContainer = document.querySelector('[data-testid=\"primaryGrid\"]');\n            results.logs.push(`Found container: ${!!eventContainer}`);\n            if (!eventContainer) {\n                results.logs.push(\"No event container found\");\n                return results;\n            }\n            const listItems = Array.from(eventContainer.querySelectorAll(\"li\")).slice(1);\n            results.logs.push(`Processing ${listItems.length} event items`);\n            listItems.forEach((item, index)=>{\n                try {\n                    const link = item.querySelector(\"a\");\n                    const titleMatch = item.textContent.match(/(?:PM|AM)(.*?)(?:Byline|Shed|Theatre|Arena|Center|Complex|Bar|Bottle)/);\n                    const title = titleMatch?.[1]?.trim() || \"\";\n                    const timeElement = item.querySelector(\"time\");\n                    const dateText = timeElement?.textContent?.trim() || \"\";\n                    // Updated regex to handle year in the middle\n                    const dateMatch = dateText.match(/([A-Za-z]+)\\s+(\\d+)\\s+(\\d{4})([A-Za-z]+)(\\d+:\\d+\\s*[AP]M)/i);\n                    let formattedDate = null;\n                    if (dateMatch) {\n                        const [_, month, day, year, dayOfWeek, time] = dateMatch;\n                        const dateStr = `${month} ${day} ${year} ${time}`;\n                        formattedDate = dateStr;\n                        results.logs.push(`Parsed Date String: ${dateStr}`);\n                    } else {\n                        results.logs.push(`Failed to parse date from text: \"${dateText}\"`);\n                    }\n                    const venueMatch = item.textContent.match(/(?:at\\s)?((?:Byline|Shed|Theatre|Arena|Center|Complex|Bar|Bottle)[^,]+)/);\n                    const venue = venueMatch?.[1]?.trim() || \"\";\n                    const locationMatch = item.textContent.match(/([^,]+,\\s*[A-Z]{2})/);\n                    const location = locationMatch?.[1]?.trim() || \"\";\n                    // Set category\n                    const category = \"Concert\";\n                    if (title && formattedDate && venue && location && link?.href) {\n                        results.events.push({\n                            name: title,\n                            date: formattedDate,\n                            venue,\n                            location,\n                            category,\n                            link: link.href,\n                            source: \"stubhub\"\n                        });\n                        // Add debug logging for successful event\n                        results.logs.push(`Successfully parsed event: ${title} on ${formattedDate}`);\n                    } else {\n                        results.logs.push(`Incomplete data for event ${index + 1}, skipping insertion.`);\n                        results.logs.push(`Title: ${title}`);\n                        results.logs.push(`Date: ${formattedDate}`);\n                        results.logs.push(`Venue: ${venue}`);\n                        results.logs.push(`Location: ${location}`);\n                        results.logs.push(`Has link: ${!!link?.href}`);\n                    }\n                    // Debug logging\n                    results.logs.push(`\\nList Item ${index + 1}:`);\n                    results.logs.push(`Name: ${title}`);\n                    results.logs.push(`Date: ${formattedDate}`);\n                    results.logs.push(`Original Date Text: ${dateText}`);\n                    results.logs.push(`Venue: ${venue}`);\n                    results.logs.push(`Location: ${location}`);\n                    results.logs.push(`Category: ${category}`);\n                    results.logs.push(`Has link: ${!!link?.href}`);\n                } catch (err) {\n                    results.logs.push(`Error processing item ${index + 1}: ${err.message}`);\n                }\n            });\n            return results;\n        });\n        // Log debug information\n        results.logs.forEach((log)=>console.log(log));\n        return results.events;\n    }\n    // navigateToEvent remains unchanged\n    async navigateToEvent(page, event) {\n        try {\n            console.log(\"Attempting to navigate to event:\", event.name);\n            const containerSelector = '[data-testid=\"primaryGrid\"]';\n            await page.waitForSelector(containerSelector);\n            console.log(\"Found event container\");\n            // Get all event links\n            const eventLinks = await page.$$(`${containerSelector} a[href*=\"/event/\"]`);\n            console.log(\"Found event links:\", eventLinks.length);\n            for (const link of eventLinks){\n                const linkContent = await link.evaluate((el)=>{\n                    return {\n                        text: el.textContent.replace(/\\s+/g, \" \").trim(),\n                        href: el.href\n                    };\n                });\n                console.log(\"Checking link:\", linkContent);\n                if (linkContent.text.includes(event.name)) {\n                    console.log(\"Found matching event, clicking link\");\n                    // Create a promise that resolves when a new page is created\n                    const newPagePromise = new Promise((resolve)=>page.browser().once(\"targetcreated\", async (target)=>{\n                            const newPage = await target.page();\n                            resolve(newPage);\n                        }));\n                    // Click the link\n                    await link.click();\n                    // Wait for the new page to open\n                    const newPage = await newPagePromise;\n                    console.log(\"New page opened\");\n                    // Wait for the listings container in the new page\n                    await newPage.waitForSelector(\"#listings-container\", {\n                        timeout: 60000\n                    });\n                    console.log(\"Event page loaded\");\n                    // Return both success status and the new page\n                    return {\n                        success: true,\n                        page: newPage\n                    };\n                }\n            }\n            console.log(`Could not find event with name: ${event.name}`);\n            return {\n                success: false,\n                page: null\n            };\n        } catch (error) {\n            console.error(\"Navigation error:\", error);\n            return {\n                success: false,\n                page: null\n            };\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StubHubSearcher);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxVQUFVLE1BQU1vQyxPQUFPdEksSUFBSTs0QkFDakNvSSxRQUFRbEM7d0JBQ1Y7b0JBR0YsaUJBQWlCO29CQUNqQixNQUFNRixLQUFLdUMsS0FBSztvQkFFaEIsZ0NBQWdDO29CQUNoQyxNQUFNckMsVUFBVSxNQUFNaUM7b0JBQ3RCbEksUUFBUUMsR0FBRyxDQUFDO29CQUVaLGtEQUFrRDtvQkFDbEQsTUFBTWdHLFFBQVEzRSxlQUFlLENBQUMsdUJBQXVCO3dCQUFFbEIsU0FBUztvQkFBTTtvQkFDdEVKLFFBQVFDLEdBQUcsQ0FBQztvQkFFWiw4Q0FBOEM7b0JBQzlDLE9BQU87d0JBQUUrRixTQUFTO3dCQUFNakcsTUFBTWtHO29CQUFRO2dCQUN4QztZQUNGO1lBRUFqRyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxnQ0FBZ0MsRUFBRW9GLE1BQU1DLElBQUksQ0FBQyxDQUFDO1lBQzNELE9BQU87Z0JBQUVVLFNBQVM7Z0JBQU9qRyxNQUFNO1lBQUs7UUFDdEMsRUFBRSxPQUFPeUIsT0FBTztZQUNkeEIsUUFBUXdCLEtBQUssQ0FBQyxxQkFBcUJBO1lBQ25DLE9BQU87Z0JBQUV3RSxTQUFTO2dCQUFPakcsTUFBTTtZQUFLO1FBQ3RDO0lBQ0Y7QUFDRjtBQUVBLGlFQUFlbkIsZUFBZUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3RpY2tldC1zZWFyY2hlci8uL3NyYy9zdHViLWh1Yi5qcz82MWQwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XHJcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gJ0Avc3JjL2NvbmZpZy9lbnYnO1xyXG5pbXBvcnQgeyBzZXR1cEJyb3dzZXIsIHNldHVwUGFnZSB9IGZyb20gJy4vdXRpbHMuanMnO1xyXG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJ2RhdGUtZm5zJztcclxuXHJcbmNvbnN0IHN1cGFiYXNlQ2xpZW50ID0gY3JlYXRlQ2xpZW50KFxyXG4gIGNvbmZpZy5zdXBhYmFzZS51cmwsXHJcbiAgY29uZmlnLnN1cGFiYXNlLnNlcnZpY2VLZXlcclxuKTtcclxuXHJcbmNsYXNzIFN0dWJIdWJTZWFyY2hlciB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmJhc2VVcmwgPSAnaHR0cHM6Ly93d3cuc3R1Ymh1Yi5jb20vc2VjdXJlL3NlYXJjaCc7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZVNlYXJjaFVybChhcnRpc3QsIHZlbnVlLCBsb2NhdGlvbikge1xyXG4gICAgY29uc3Qgc2VhcmNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xyXG4gICAgY29uc3Qgc2VhcmNoVGVybXMgPSBbYXJ0aXN0LCB2ZW51ZSwgbG9jYXRpb25dLmZpbHRlcihCb29sZWFuKTtcclxuICAgIHNlYXJjaFBhcmFtcy5hcHBlbmQoJ3EnLCBzZWFyY2hUZXJtcy5qb2luKCcgJykpO1xyXG4gICAgcmV0dXJuIGAke3RoaXMuYmFzZVVybH0/JHtzZWFyY2hQYXJhbXMudG9TdHJpbmcoKX1gO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2V0dXBCcm93c2VyKCkge1xyXG4gICAgcmV0dXJuIGF3YWl0IHNldHVwQnJvd3NlcigpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2V0dXBQYWdlKGJyb3dzZXIpIHtcclxuICAgIHJldHVybiBhd2FpdCBzZXR1cFBhZ2UoYnJvd3Nlcik7XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRUaWNrZXRQcmljZXMoZXZlbnRVcmwsIGV4aXN0aW5nUGFnZSA9IG51bGwpIHtcclxuICAgIGxldCBicm93c2VyID0gbnVsbDtcclxuICAgIGxldCBwYWdlID0gZXhpc3RpbmdQYWdlO1xyXG4gICAgXHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAoIWV4aXN0aW5nUGFnZSkge1xyXG4gICAgICAgIGJyb3dzZXIgPSBhd2FpdCB0aGlzLnNldHVwQnJvd3NlcigpO1xyXG4gICAgICAgIHBhZ2UgPSBhd2FpdCB0aGlzLnNldHVwUGFnZShicm93c2VyKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnTmF2aWdhdGluZyB0byBldmVudCBwYWdlOicsIGV2ZW50VXJsKTtcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbCBuYXZpZ2F0aW9uXHJcbiAgICAgICAgYXdhaXQgcGFnZS5nb3RvKGV2ZW50VXJsLCB7IFxyXG4gICAgICAgICAgd2FpdFVudGlsOiAnZG9tY29udGVudGxvYWRlZCcsXHJcbiAgICAgICAgICB0aW1lb3V0OiAzMDAwMCBcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRnVuY3Rpb24gdG8gY2hlY2sgZm9yIGxpc3RpbmdzIGNvbnRhaW5lclxyXG4gICAgICBjb25zdCBjaGVja0xpc3RpbmdzQ29udGFpbmVyID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdDaGVja2luZyBmb3IgbGlzdGluZ3MgY29udGFpbmVyLi4uJyk7XHJcbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHBhZ2UuY29udGVudCgpO1xyXG4gICAgICAgIHJldHVybiBjb250ZW50LmluY2x1ZGVzKCdsaXN0aW5ncy1jb250YWluZXInKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIEZpcnN0IGNoZWNrXHJcbiAgICAgIGxldCBoYXNMaXN0aW5ncyA9IGF3YWl0IGNoZWNrTGlzdGluZ3NDb250YWluZXIoKTtcclxuXHJcbiAgICAgIC8vIElmIG5vdCBmb3VuZCwgdHJ5IHJlbG9hZGluZ1xyXG4gICAgICBpZiAoIWhhc0xpc3RpbmdzKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0xpc3RpbmdzIGNvbnRhaW5lciBub3QgZm91bmQsIHJlbG9hZGluZyBwYWdlLi4uJyk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGF3YWl0IFByb21pc2UucmFjZShbXHJcbiAgICAgICAgICAgIHBhZ2UucmVsb2FkKHsgd2FpdFVudGlsOiAnZG9tY29udGVudGxvYWRlZCcgfSksXHJcbiAgICAgICAgICAgIG5ldyBQcm9taXNlKChfLCByZWplY3QpID0+IHNldFRpbWVvdXQoKCkgPT4gcmVqZWN0KG5ldyBFcnJvcignUmVsb2FkIHRpbWVvdXQnKSksIDEwMDAwKSlcclxuICAgICAgICAgIF0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBXYWl0IGEgbW9tZW50IGZvciBhbnkgZHluYW1pYyBjb250ZW50XHJcbiAgICAgICAgICBhd2FpdCBwYWdlLndhaXRGb3JUaW1lb3V0KDIwMDApO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBDaGVjayBhZ2FpbiBhZnRlciByZWxvYWRcclxuICAgICAgICAgIGhhc0xpc3RpbmdzID0gYXdhaXQgY2hlY2tMaXN0aW5nc0NvbnRhaW5lcigpO1xyXG4gICAgICAgICAgaWYgKCFoYXNMaXN0aW5ncykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTGlzdGluZ3MgY29udGFpbmVyIHN0aWxsIG5vdCBmb3VuZCBhZnRlciByZWxvYWQsIHRyeWluZyBhbHRlcm5hdGl2ZSBhcHByb2FjaC4uLicpO1xyXG4gICAgICAgICAgICAvLyBUcnkgbmF2aWdhdGluZyB0byB0aGUgVVJMIGFnYWluXHJcbiAgICAgICAgICAgIGF3YWl0IHBhZ2UuZ290byhldmVudFVybCwgeyBcclxuICAgICAgICAgICAgICB3YWl0VW50aWw6ICdkb21jb250ZW50bG9hZGVkJyxcclxuICAgICAgICAgICAgICB0aW1lb3V0OiAxMDAwMCBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGF3YWl0IHBhZ2Uud2FpdEZvclRpbWVvdXQoMjAwMCk7XHJcbiAgICAgICAgICAgIGhhc0xpc3RpbmdzID0gYXdhaXQgY2hlY2tMaXN0aW5nc0NvbnRhaW5lcigpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKHJlbG9hZEVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnUmVsb2FkIGZhaWxlZCwgdHJ5aW5nIGFsdGVybmF0aXZlIGFwcHJvYWNoLi4uJywgcmVsb2FkRXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgICAvLyBJZiByZWxvYWQgdGltZXMgb3V0LCB0cnkgbmF2aWdhdGluZyB0byB0aGUgVVJMIGFnYWluXHJcbiAgICAgICAgICBhd2FpdCBwYWdlLmdvdG8oZXZlbnRVcmwsIHsgXHJcbiAgICAgICAgICAgIHdhaXRVbnRpbDogJ2RvbWNvbnRlbnRsb2FkZWQnLFxyXG4gICAgICAgICAgICB0aW1lb3V0OiAxMDAwMCBcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgYXdhaXQgcGFnZS53YWl0Rm9yVGltZW91dCgyMDAwKTtcclxuICAgICAgICAgIGhhc0xpc3RpbmdzID0gYXdhaXQgY2hlY2tMaXN0aW5nc0NvbnRhaW5lcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gV2FpdCBmb3IgbGlzdGluZ3MgY29udGFpbmVyIHdpdGggbXVsdGlwbGUgc2VsZWN0b3IgYXR0ZW1wdHNcclxuICAgICAgbGV0IGxpc3RpbmdzRm91bmQgPSBmYWxzZTtcclxuICAgICAgY29uc3Qgc2VsZWN0b3JzID0gW1xyXG4gICAgICAgICcjbGlzdGluZ3MtY29udGFpbmVyJyxcclxuICAgICAgICAnW2RhdGEtdGVzdGlkPVwibGlzdGluZ3MtY29udGFpbmVyXCJdJyxcclxuICAgICAgICAnLmxpc3RpbmctY29udGFpbmVyJyxcclxuICAgICAgICAnW2RhdGEtdGVzdGlkPVwiZXZlbnQtbGlzdGluZ3NcIl0nXHJcbiAgICAgIF07XHJcblxyXG4gICAgICBjb25zb2xlLmxvZygnV2FpdGluZyBmb3IgbGlzdGluZ3MgY29udGFpbmVyIHRvIGJlIHZpc2libGUuLi4nKTtcclxuICAgICAgZm9yIChjb25zdCBzZWxlY3RvciBvZiBzZWxlY3RvcnMpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgYXdhaXQgcGFnZS53YWl0Rm9yU2VsZWN0b3Ioc2VsZWN0b3IsIHsgXHJcbiAgICAgICAgICAgIHRpbWVvdXQ6IDUwMDAsXHJcbiAgICAgICAgICAgIHZpc2libGU6IHRydWUgXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGBGb3VuZCBsaXN0aW5ncyBjb250YWluZXIgd2l0aCBzZWxlY3RvcjogJHtzZWxlY3Rvcn1gKTtcclxuICAgICAgICAgIGxpc3RpbmdzRm91bmQgPSB0cnVlO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGBTZWxlY3RvciAke3NlbGVjdG9yfSBub3QgZm91bmQsIHRyeWluZyBuZXh0Li4uYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIWxpc3RpbmdzRm91bmQpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdDb3VsZCBub3QgZmluZCBsaXN0aW5ncyBjb250YWluZXIgd2l0aCBhbnkga25vd24gc2VsZWN0b3InKTtcclxuICAgICAgICBhd2FpdCBwYWdlLnNjcmVlbnNob3QoeyBwYXRoOiAnbGlzdGluZ3MtZXJyb3IucG5nJywgZnVsbFBhZ2U6IHRydWUgfSk7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdMaXN0aW5ncyBjb250YWluZXIgbm90IGZvdW5kIGFmdGVyIGFsbCBhdHRlbXB0cycpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBXYWl0IGZvciBhY3R1YWwgdGlja2V0IGxpc3RpbmdzIHRvIGxvYWQgd2l0aCBzaG9ydGVyIHRpbWVvdXRcclxuICAgICAgYXdhaXQgcGFnZS53YWl0Rm9yRnVuY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGxpc3RpbmdzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbGlzdGluZy1pZF0nKTtcclxuICAgICAgICByZXR1cm4gbGlzdGluZ3MubGVuZ3RoID4gMDtcclxuICAgICAgfSwgeyB0aW1lb3V0OiAxMDAwMCB9KTtcclxuXHJcbiAgICAgIC8vIEFkZGl0aW9uYWwgZGVsYXkgdG8gZW5zdXJlIGFsbCBkeW5hbWljIGNvbnRlbnQgaXMgbG9hZGVkXHJcbiAgICAgIGF3YWl0IHBhZ2Uud2FpdEZvclRpbWVvdXQoMTAwMCk7XHJcblxyXG4gICAgICBjb25zdCB0aWNrZXRzID0gYXdhaXQgcGFnZS5ldmFsdWF0ZSgoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgbGlzdGluZ3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWxpc3RpbmctaWRdJykpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nICR7bGlzdGluZ3MubGVuZ3RofSBsaXN0aW5nc2ApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHRpY2tldHNCeVNlY3Rpb24gPSB7fTtcclxuICAgICAgICBcclxuICAgICAgICBsaXN0aW5ncy5mb3JFYWNoKChsaXN0aW5nLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gU2tpcCBzb2xkIHRpY2tldHNcclxuICAgICAgICAgICAgaWYgKGxpc3RpbmcuZ2V0QXR0cmlidXRlKCdkYXRhLWlzLXNvbGQnKSA9PT0gJzEnKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgc2VjdGlvbiBuYW1lIHdpdGggbXVsdGlwbGUgc2VsZWN0b3IgYXR0ZW1wdHNcclxuICAgICAgICAgICAgY29uc3Qgc2VjdGlvbiA9IGxpc3RpbmcucXVlcnlTZWxlY3RvcignLnNjLWhsYWxnZi02Jyk/LnRleHRDb250ZW50Py50cmltKCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGluZy5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0aWQ9XCJzZWN0aW9uLW5hbWVcIl0nKT8udGV4dENvbnRlbnQ/LnRyaW0oKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0aW5nLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWF1dG89XCJsaXN0aW5nLXNlY3Rpb25cIl0nKT8udGV4dENvbnRlbnQ/LnRyaW0oKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAnR2VuZXJhbCBBZG1pc3Npb24nO1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IHByaWNlIHdpdGggbXVsdGlwbGUgc2VsZWN0b3IgYXR0ZW1wdHNcclxuICAgICAgICAgICAgY29uc3QgcHJpY2VFbGVtZW50ID0gbGlzdGluZy5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0aWQ9XCJsaXN0aW5nLXByaWNlXCJdJykgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0aW5nLnF1ZXJ5U2VsZWN0b3IoJy5zYy1obGFsZ2YtMScpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGluZy5xdWVyeVNlbGVjdG9yKCdbZGF0YS1hdXRvPVwibGlzdGluZy1wcmljZVwiXScpO1xyXG4gICAgICAgICAgICBjb25zdCBwcmljZSA9IHByaWNlRWxlbWVudD8udGV4dENvbnRlbnQ/LnRyaW0oKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEdldCBxdWFudGl0eSB3aXRoIG11bHRpcGxlIHNlbGVjdG9yIGF0dGVtcHRzXHJcbiAgICAgICAgICAgIGNvbnN0IHF1YW50aXR5ID0gbGlzdGluZy5xdWVyeVNlbGVjdG9yKCcuc2MtaGxhbGdmLTE0Jyk/LnRleHRDb250ZW50Py50cmltKCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RpbmcucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdGlkPVwicXVhbnRpdHlcIl0nKT8udGV4dENvbnRlbnQ/LnRyaW0oKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGluZy5xdWVyeVNlbGVjdG9yKCdbZGF0YS1hdXRvPVwibGlzdGluZy1xdWFudGl0eVwiXScpPy50ZXh0Q29udGVudD8udHJpbSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFwcmljZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaWYgKCF0aWNrZXRzQnlTZWN0aW9uW3NlY3Rpb25dKSB7XHJcbiAgICAgICAgICAgICAgdGlja2V0c0J5U2VjdGlvbltzZWN0aW9uXSA9IHtcclxuICAgICAgICAgICAgICAgIHNlY3Rpb24sXHJcbiAgICAgICAgICAgICAgICB0aWNrZXRzOiBbXSxcclxuICAgICAgICAgICAgICAgIGxvd2VzdFByaWNlOiBJbmZpbml0eSxcclxuICAgICAgICAgICAgICAgIGhpZ2hlc3RQcmljZTogLUluZmluaXR5LFxyXG4gICAgICAgICAgICAgICAgbnVtYmVyT2ZMaXN0aW5nczogMFxyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG51bWVyaWNQcmljZSA9IHBhcnNlRmxvYXQocHJpY2UucmVwbGFjZSgvW14wLTkuXS9nLCAnJykpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgdGlja2V0SW5mbyA9IHtcclxuICAgICAgICAgICAgICBxdWFudGl0eSxcclxuICAgICAgICAgICAgICBwcmljZSxcclxuICAgICAgICAgICAgICByYXdQcmljZTogbnVtZXJpY1ByaWNlLFxyXG4gICAgICAgICAgICAgIGxpc3RpbmdVcmw6IHdpbmRvdy5sb2NhdGlvbi5ocmVmLFxyXG4gICAgICAgICAgICAgIGxpc3RpbmdJZDogbGlzdGluZy5nZXRBdHRyaWJ1dGUoJ2RhdGEtbGlzdGluZy1pZCcpXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB0aWNrZXRzQnlTZWN0aW9uW3NlY3Rpb25dLnRpY2tldHMucHVzaCh0aWNrZXRJbmZvKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICghaXNOYU4obnVtZXJpY1ByaWNlKSkge1xyXG4gICAgICAgICAgICAgIHRpY2tldHNCeVNlY3Rpb25bc2VjdGlvbl0ubG93ZXN0UHJpY2UgPSBNYXRoLm1pbih0aWNrZXRzQnlTZWN0aW9uW3NlY3Rpb25dLmxvd2VzdFByaWNlLCBudW1lcmljUHJpY2UpO1xyXG4gICAgICAgICAgICAgIHRpY2tldHNCeVNlY3Rpb25bc2VjdGlvbl0uaGlnaGVzdFByaWNlID0gTWF0aC5tYXgodGlja2V0c0J5U2VjdGlvbltzZWN0aW9uXS5oaWdoZXN0UHJpY2UsIG51bWVyaWNQcmljZSk7XHJcbiAgICAgICAgICAgICAgdGlja2V0c0J5U2VjdGlvbltzZWN0aW9uXS5udW1iZXJPZkxpc3RpbmdzKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgcHJvY2Vzc2luZyBsaXN0aW5nICR7aW5kZXh9OmAsIGVycik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIE9iamVjdC52YWx1ZXModGlja2V0c0J5U2VjdGlvbikuZm9yRWFjaChzZWN0aW9uID0+IHtcclxuICAgICAgICAgIGlmIChzZWN0aW9uLmxvd2VzdFByaWNlID09PSBJbmZpbml0eSkgc2VjdGlvbi5sb3dlc3RQcmljZSA9IG51bGw7XHJcbiAgICAgICAgICBpZiAoc2VjdGlvbi5oaWdoZXN0UHJpY2UgPT09IC1JbmZpbml0eSkgc2VjdGlvbi5oaWdoZXN0UHJpY2UgPSBudWxsO1xyXG4gICAgICAgICAgc2VjdGlvbi50aWNrZXRzLnNvcnQoKGEsIGIpID0+IChhLnJhd1ByaWNlIHx8IEluZmluaXR5KSAtIChiLnJhd1ByaWNlIHx8IEluZmluaXR5KSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICB0b3RhbFNlY3Rpb25zOiBPYmplY3Qua2V5cyh0aWNrZXRzQnlTZWN0aW9uKS5sZW5ndGgsXHJcbiAgICAgICAgICBzZWN0aW9uczogT2JqZWN0LnZhbHVlcyh0aWNrZXRzQnlTZWN0aW9uKVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coYEZvdW5kIHRpY2tldHMgaW4gJHt0aWNrZXRzLnRvdGFsU2VjdGlvbnN9IHNlY3Rpb25zYCk7XHJcbiAgICAgIHJldHVybiB0aWNrZXRzO1xyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHRpY2tldCBwcmljZXM6JywgZXJyb3IpO1xyXG4gICAgICBpZiAocGFnZSkge1xyXG4gICAgICAgIGF3YWl0IHBhZ2Uuc2NyZWVuc2hvdCh7IHBhdGg6ICdlcnJvci1zdGF0ZS5wbmcnLCBmdWxsUGFnZTogdHJ1ZSB9KTtcclxuICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgcGFnZS5jb250ZW50KCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1BhZ2UgY29udGVudCBhdCBlcnJvcjonLCBjb250ZW50LnN1YnN0cmluZygwLCA1MDApICsgJy4uLicpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB7IHRvdGFsU2VjdGlvbnM6IDAsIHNlY3Rpb25zOiBbXSB9O1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgaWYgKGJyb3dzZXIgJiYgIWV4aXN0aW5nUGFnZSkge1xyXG4gICAgICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2VhcmNoQ29uY2VydHMoYXJ0aXN0LCB2ZW51ZSwgbG9jYXRpb24pIHtcclxuICAgIGNvbnN0IGJyb3dzZXIgPSBhd2FpdCB0aGlzLnNldHVwQnJvd3NlcigpO1xyXG4gICAgbGV0IHNlYXJjaFBhZ2U7XHJcbiAgICBsZXQgZXZlbnRQYWdlO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIHNlYXJjaFBhZ2UgPSBhd2FpdCB0aGlzLnNldHVwUGFnZShicm93c2VyKTtcclxuICAgICAgY29uc3Qgc2VhcmNoVXJsID0gdGhpcy5nZW5lcmF0ZVNlYXJjaFVybChhcnRpc3QsIHZlbnVlLCBsb2NhdGlvbik7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdTZWFyY2hpbmcgU3R1Ykh1YjonLCBzZWFyY2hVcmwpO1xyXG5cclxuICAgICAgYXdhaXQgc2VhcmNoUGFnZS5nb3RvKHNlYXJjaFVybCwgeyB3YWl0VW50aWw6ICduZXR3b3JraWRsZTAnLCB0aW1lb3V0OiAzMDAwMCB9KTtcclxuICAgICAgY29uc29sZS5sb2coJ1BhZ2UgbG9hZGVkLCBjaGVja2luZyBjb250ZW50Li4uJyk7XHJcblxyXG4gICAgICBhd2FpdCBzZWFyY2hQYWdlLndhaXRGb3JUaW1lb3V0KDIwMDApO1xyXG4gICAgICBsZXQgY29udGVudCA9IGF3YWl0IHNlYXJjaFBhZ2UuY29udGVudCgpO1xyXG5cclxuICAgICAgaWYgKCFjb250ZW50LmluY2x1ZGVzKCdkYXRhLXRlc3RpZD1cInByaW1hcnlHcmlkXCInKSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdSZWxvYWRpbmcgcGFnZSBkdWUgdG8gbWlzc2luZyBjb250ZW50Li4uJyk7XHJcbiAgICAgICAgYXdhaXQgc2VhcmNoUGFnZS5yZWxvYWQoeyB3YWl0VW50aWw6ICdkb21jb250ZW50bG9hZGVkJyB9KTtcclxuICAgICAgICBhd2FpdCBzZWFyY2hQYWdlLndhaXRGb3JUaW1lb3V0KDMwMDApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmxvZygnV2FpdGluZyBmb3IgcHJpbWFyeSBncmlkLi4uJyk7XHJcbiAgICAgIGF3YWl0IHNlYXJjaFBhZ2Uud2FpdEZvclNlbGVjdG9yKCdbZGF0YS10ZXN0aWQ9XCJwcmltYXJ5R3JpZFwiXScpO1xyXG4gICAgICBjb25zb2xlLmxvZygnRm91bmQgcHJpbWFyeSBncmlkLCBleHRyYWN0aW5nIGV2ZW50cy4uLicpO1xyXG5cclxuICAgICAgYXdhaXQgc2VhcmNoUGFnZS53YWl0Rm9yVGltZW91dCgyMDAwKTtcclxuXHJcbiAgICAgIGNvbnN0IGV2ZW50cyA9IGF3YWl0IHRoaXMuZXh0cmFjdEV2ZW50RGV0YWlscyhzZWFyY2hQYWdlKTtcclxuICAgICAgY29uc29sZS5sb2coYFxcblJhdyBldmVudHMgZXh0cmFjdGVkOiAke2V2ZW50cy5sZW5ndGh9YCk7XHJcblxyXG4gICAgICBjb25zdCBtYXRjaGluZ0V2ZW50cyA9IGV2ZW50cy5maWx0ZXIoZXZlbnQgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdDaGVja2luZyBldmVudDonLCBldmVudC5uYW1lKTtcclxuICAgICAgICBjb25zdCB0aXRsZU1hdGNoID0gIWFydGlzdCB8fCBldmVudC5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoYXJ0aXN0LnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgIGNvbnN0IHZlbnVlTWF0Y2ggPSAhdmVudWUgfHwgZXZlbnQudmVudWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh2ZW51ZS50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICBjb25zdCBsb2NhdGlvbk1hdGNoID0gIWxvY2F0aW9uIHx8IGV2ZW50LmxvY2F0aW9uLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG9jYXRpb24udG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ01hdGNoIHJlc3VsdHM6JywgeyB0aXRsZU1hdGNoLCB2ZW51ZU1hdGNoLCBsb2NhdGlvbk1hdGNoIH0pO1xyXG4gICAgICAgIHJldHVybiB0aXRsZU1hdGNoICYmIHZlbnVlTWF0Y2ggJiYgbG9jYXRpb25NYXRjaDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZygnRm91bmQgbWF0Y2hpbmcgZXZlbnRzOicsIG1hdGNoaW5nRXZlbnRzLmxlbmd0aCk7XHJcblxyXG4gICAgICAvLyBDcmVhdGUgYSBTZXQgdG8gdHJhY2sgcHJvY2Vzc2VkIGV2ZW50IFVSTHNcclxuICAgICAgY29uc3QgcHJvY2Vzc2VkVXJscyA9IG5ldyBTZXQoKTtcclxuICAgICAgY29uc3QgZXZlbnRzV2l0aFRpY2tldHMgPSBbXTtcclxuXHJcbiAgICAgIGZvciAoY29uc3QgZXZlbnQgb2YgbWF0Y2hpbmdFdmVudHMpIHtcclxuICAgICAgICAvLyBTa2lwIGlmIHdlJ3ZlIGFscmVhZHkgcHJvY2Vzc2VkIHRoaXMgZXZlbnQgVVJMXHJcbiAgICAgICAgaWYgKHByb2Nlc3NlZFVybHMuaGFzKGV2ZW50LmxpbmspKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnU2tpcHBpbmcgZHVwbGljYXRlIGV2ZW50IFVSTDonLCBldmVudC5saW5rKTtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgeyBzdWNjZXNzLCBwYWdlOiBuZXdQYWdlIH0gPSBhd2FpdCB0aGlzLm5hdmlnYXRlVG9FdmVudChzZWFyY2hQYWdlLCBldmVudCk7XHJcbiAgICAgICAgaWYgKHN1Y2Nlc3MgJiYgbmV3UGFnZSkge1xyXG4gICAgICAgICAgZXZlbnRQYWdlID0gbmV3UGFnZTtcclxuICAgICAgICAgIGNvbnN0IHRpY2tldHMgPSBhd2FpdCB0aGlzLmdldFRpY2tldFByaWNlcyhldmVudC5saW5rLCBldmVudFBhZ2UpO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ1NjcmFwZWQgVGlja2V0czonLCBKU09OLnN0cmluZ2lmeSh0aWNrZXRzLCBudWxsLCAyKSk7XHJcblxyXG4gICAgICAgICAgZXZlbnRzV2l0aFRpY2tldHMucHVzaCh7XHJcbiAgICAgICAgICAgIG5hbWU6IGV2ZW50Lm5hbWUsXHJcbiAgICAgICAgICAgIGRhdGU6IGV2ZW50LmRhdGUsXHJcbiAgICAgICAgICAgIHZlbnVlOiBldmVudC52ZW51ZSxcclxuICAgICAgICAgICAgbG9jYXRpb246IGV2ZW50LmxvY2F0aW9uLFxyXG4gICAgICAgICAgICBjYXRlZ29yeTogZXZlbnQuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgIGxpbms6IGV2ZW50LmxpbmssXHJcbiAgICAgICAgICAgIHNvdXJjZTogZXZlbnQuc291cmNlLFxyXG4gICAgICAgICAgICB0aWNrZXRzOiB0aWNrZXRzXHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAvLyBNYXJrIHRoaXMgVVJMIGFzIHByb2Nlc3NlZFxyXG4gICAgICAgICAgcHJvY2Vzc2VkVXJscy5hZGQoZXZlbnQubGluayk7XHJcblxyXG4gICAgICAgICAgYXdhaXQgZXZlbnRQYWdlLmNsb3NlKCk7XHJcbiAgICAgICAgICBhd2FpdCBzZWFyY2hQYWdlLndhaXRGb3JUaW1lb3V0KDEwMDApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIGV2ZW50c1dpdGhUaWNrZXRzO1xyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1NlYXJjaCBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIGlmIChzZWFyY2hQYWdlKSB7XHJcbiAgICAgICAgYXdhaXQgc2VhcmNoUGFnZS5zY3JlZW5zaG90KHsgcGF0aDogJ2Vycm9yLnBuZycsIGZ1bGxQYWdlOiB0cnVlIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIGlmIChldmVudFBhZ2UgJiYgIWV2ZW50UGFnZS5pc0Nsb3NlZCgpKSBhd2FpdCBldmVudFBhZ2UuY2xvc2UoKTtcclxuICAgICAgaWYgKHNlYXJjaFBhZ2UgJiYgIXNlYXJjaFBhZ2UuaXNDbG9zZWQoKSkgYXdhaXQgc2VhcmNoUGFnZS5jbG9zZSgpO1xyXG4gICAgICBpZiAoYnJvd3NlcikgYXdhaXQgYnJvd3Nlci5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gVXBkYXRlZCBleHRyYWN0RXZlbnREZXRhaWxzIG1ldGhvZFxyXG4gIGFzeW5jIGV4dHJhY3RFdmVudERldGFpbHMocGFnZSkge1xyXG4gICAgY29uc29sZS5sb2coJ1N0YXJ0aW5nIGV2ZW50IGV4dHJhY3Rpb24gaW4gTm9kZScpO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgcGFnZS5ldmFsdWF0ZSgoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSB7IGxvZ3M6IFtdLCBldmVudHM6IFtdIH07XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBldmVudENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRlc3RpZD1cInByaW1hcnlHcmlkXCJdJyk7XHJcbiAgICAgIHJlc3VsdHMubG9ncy5wdXNoKGBGb3VuZCBjb250YWluZXI6ICR7ISFldmVudENvbnRhaW5lcn1gKTtcclxuICAgICAgXHJcbiAgICAgIGlmICghZXZlbnRDb250YWluZXIpIHtcclxuICAgICAgICByZXN1bHRzLmxvZ3MucHVzaCgnTm8gZXZlbnQgY29udGFpbmVyIGZvdW5kJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGxpc3RJdGVtcyA9IEFycmF5LmZyb20oZXZlbnRDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnbGknKSkuc2xpY2UoMSk7XHJcbiAgICAgIHJlc3VsdHMubG9ncy5wdXNoKGBQcm9jZXNzaW5nICR7bGlzdEl0ZW1zLmxlbmd0aH0gZXZlbnQgaXRlbXNgKTtcclxuXHJcbiAgICAgIGxpc3RJdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCBsaW5rID0gaXRlbS5xdWVyeVNlbGVjdG9yKCdhJyk7XHJcbiAgICAgICAgICBjb25zdCB0aXRsZU1hdGNoID0gaXRlbS50ZXh0Q29udGVudC5tYXRjaCgvKD86UE18QU0pKC4qPykoPzpCeWxpbmV8U2hlZHxUaGVhdHJlfEFyZW5hfENlbnRlcnxDb21wbGV4fEJhcnxCb3R0bGUpLyk7XHJcbiAgICAgICAgICBjb25zdCB0aXRsZSA9IHRpdGxlTWF0Y2g/LlsxXT8udHJpbSgpIHx8ICcnO1xyXG5cclxuICAgICAgICAgIGNvbnN0IHRpbWVFbGVtZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKCd0aW1lJyk7XHJcbiAgICAgICAgICBjb25zdCBkYXRlVGV4dCA9IHRpbWVFbGVtZW50Py50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBVcGRhdGVkIHJlZ2V4IHRvIGhhbmRsZSB5ZWFyIGluIHRoZSBtaWRkbGVcclxuICAgICAgICAgIGNvbnN0IGRhdGVNYXRjaCA9IGRhdGVUZXh0Lm1hdGNoKC8oW0EtWmEtel0rKVxccysoXFxkKylcXHMrKFxcZHs0fSkoW0EtWmEtel0rKShcXGQrOlxcZCtcXHMqW0FQXU0pL2kpO1xyXG4gICAgICAgICAgbGV0IGZvcm1hdHRlZERhdGUgPSBudWxsO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoZGF0ZU1hdGNoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IFtfLCBtb250aCwgZGF5LCB5ZWFyLCBkYXlPZldlZWssIHRpbWVdID0gZGF0ZU1hdGNoO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gYCR7bW9udGh9ICR7ZGF5fSAke3llYXJ9ICR7dGltZX1gO1xyXG4gICAgICAgICAgICBmb3JtYXR0ZWREYXRlID0gZGF0ZVN0cjtcclxuICAgICAgICAgICAgcmVzdWx0cy5sb2dzLnB1c2goYFBhcnNlZCBEYXRlIFN0cmluZzogJHtkYXRlU3RyfWApO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVzdWx0cy5sb2dzLnB1c2goYEZhaWxlZCB0byBwYXJzZSBkYXRlIGZyb20gdGV4dDogXCIke2RhdGVUZXh0fVwiYCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgY29uc3QgdmVudWVNYXRjaCA9IGl0ZW0udGV4dENvbnRlbnQubWF0Y2goLyg/OmF0XFxzKT8oKD86QnlsaW5lfFNoZWR8VGhlYXRyZXxBcmVuYXxDZW50ZXJ8Q29tcGxleHxCYXJ8Qm90dGxlKVteLF0rKS8pO1xyXG4gICAgICAgICAgY29uc3QgdmVudWUgPSB2ZW51ZU1hdGNoPy5bMV0/LnRyaW0oKSB8fCAnJztcclxuXHJcbiAgICAgICAgICBjb25zdCBsb2NhdGlvbk1hdGNoID0gaXRlbS50ZXh0Q29udGVudC5tYXRjaCgvKFteLF0rLFxccypbQS1aXXsyfSkvKTtcclxuICAgICAgICAgIGNvbnN0IGxvY2F0aW9uID0gbG9jYXRpb25NYXRjaD8uWzFdPy50cmltKCkgfHwgJyc7XHJcblxyXG4gICAgICAgICAgLy8gU2V0IGNhdGVnb3J5XHJcbiAgICAgICAgICBjb25zdCBjYXRlZ29yeSA9ICdDb25jZXJ0JztcclxuXHJcbiAgICAgICAgICBpZiAodGl0bGUgJiYgZm9ybWF0dGVkRGF0ZSAmJiB2ZW51ZSAmJiBsb2NhdGlvbiAmJiBsaW5rPy5ocmVmKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdHMuZXZlbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgIG5hbWU6IHRpdGxlLFxyXG4gICAgICAgICAgICAgIGRhdGU6IGZvcm1hdHRlZERhdGUsXHJcbiAgICAgICAgICAgICAgdmVudWUsXHJcbiAgICAgICAgICAgICAgbG9jYXRpb24sXHJcbiAgICAgICAgICAgICAgY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgbGluazogbGluay5ocmVmLFxyXG4gICAgICAgICAgICAgIHNvdXJjZTogJ3N0dWJodWInXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQWRkIGRlYnVnIGxvZ2dpbmcgZm9yIHN1Y2Nlc3NmdWwgZXZlbnRcclxuICAgICAgICAgICAgcmVzdWx0cy5sb2dzLnB1c2goYFN1Y2Nlc3NmdWxseSBwYXJzZWQgZXZlbnQ6ICR7dGl0bGV9IG9uICR7Zm9ybWF0dGVkRGF0ZX1gKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlc3VsdHMubG9ncy5wdXNoKGBJbmNvbXBsZXRlIGRhdGEgZm9yIGV2ZW50ICR7aW5kZXggKyAxfSwgc2tpcHBpbmcgaW5zZXJ0aW9uLmApO1xyXG4gICAgICAgICAgICByZXN1bHRzLmxvZ3MucHVzaChgVGl0bGU6ICR7dGl0bGV9YCk7XHJcbiAgICAgICAgICAgIHJlc3VsdHMubG9ncy5wdXNoKGBEYXRlOiAke2Zvcm1hdHRlZERhdGV9YCk7XHJcbiAgICAgICAgICAgIHJlc3VsdHMubG9ncy5wdXNoKGBWZW51ZTogJHt2ZW51ZX1gKTtcclxuICAgICAgICAgICAgcmVzdWx0cy5sb2dzLnB1c2goYExvY2F0aW9uOiAke2xvY2F0aW9ufWApO1xyXG4gICAgICAgICAgICByZXN1bHRzLmxvZ3MucHVzaChgSGFzIGxpbms6ICR7ISFsaW5rPy5ocmVmfWApO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIERlYnVnIGxvZ2dpbmdcclxuICAgICAgICAgIHJlc3VsdHMubG9ncy5wdXNoKGBcXG5MaXN0IEl0ZW0gJHtpbmRleCArIDF9OmApO1xyXG4gICAgICAgICAgcmVzdWx0cy5sb2dzLnB1c2goYE5hbWU6ICR7dGl0bGV9YCk7XHJcbiAgICAgICAgICByZXN1bHRzLmxvZ3MucHVzaChgRGF0ZTogJHtmb3JtYXR0ZWREYXRlfWApO1xyXG4gICAgICAgICAgcmVzdWx0cy5sb2dzLnB1c2goYE9yaWdpbmFsIERhdGUgVGV4dDogJHtkYXRlVGV4dH1gKTtcclxuICAgICAgICAgIHJlc3VsdHMubG9ncy5wdXNoKGBWZW51ZTogJHt2ZW51ZX1gKTtcclxuICAgICAgICAgIHJlc3VsdHMubG9ncy5wdXNoKGBMb2NhdGlvbjogJHtsb2NhdGlvbn1gKTtcclxuICAgICAgICAgIHJlc3VsdHMubG9ncy5wdXNoKGBDYXRlZ29yeTogJHtjYXRlZ29yeX1gKTtcclxuICAgICAgICAgIHJlc3VsdHMubG9ncy5wdXNoKGBIYXMgbGluazogJHshIWxpbms/LmhyZWZ9YCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICByZXN1bHRzLmxvZ3MucHVzaChgRXJyb3IgcHJvY2Vzc2luZyBpdGVtICR7aW5kZXggKyAxfTogJHtlcnIubWVzc2FnZX1gKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBMb2cgZGVidWcgaW5mb3JtYXRpb25cclxuICAgIHJlc3VsdHMubG9ncy5mb3JFYWNoKGxvZyA9PiBjb25zb2xlLmxvZyhsb2cpKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHJlc3VsdHMuZXZlbnRzO1xyXG4gIH1cclxuXHJcbiAgLy8gbmF2aWdhdGVUb0V2ZW50IHJlbWFpbnMgdW5jaGFuZ2VkXHJcbiAgYXN5bmMgbmF2aWdhdGVUb0V2ZW50KHBhZ2UsIGV2ZW50KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZygnQXR0ZW1wdGluZyB0byBuYXZpZ2F0ZSB0byBldmVudDonLCBldmVudC5uYW1lKTtcclxuICAgICAgY29uc3QgY29udGFpbmVyU2VsZWN0b3IgPSAnW2RhdGEtdGVzdGlkPVwicHJpbWFyeUdyaWRcIl0nO1xyXG4gICAgICBhd2FpdCBwYWdlLndhaXRGb3JTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdGb3VuZCBldmVudCBjb250YWluZXInKTtcclxuXHJcbiAgICAgIC8vIEdldCBhbGwgZXZlbnQgbGlua3NcclxuICAgICAgY29uc3QgZXZlbnRMaW5rcyA9IGF3YWl0IHBhZ2UuJCQoYCR7Y29udGFpbmVyU2VsZWN0b3J9IGFbaHJlZio9XCIvZXZlbnQvXCJdYCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdGb3VuZCBldmVudCBsaW5rczonLCBldmVudExpbmtzLmxlbmd0aCk7XHJcbiAgICAgIFxyXG4gICAgICBmb3IgKGNvbnN0IGxpbmsgb2YgZXZlbnRMaW5rcykge1xyXG4gICAgICAgIGNvbnN0IGxpbmtDb250ZW50ID0gYXdhaXQgbGluay5ldmFsdWF0ZShlbCA9PiB7XHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0ZXh0OiBlbC50ZXh0Q29udGVudC5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpLFxyXG4gICAgICAgICAgICBocmVmOiBlbC5ocmVmXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdDaGVja2luZyBsaW5rOicsIGxpbmtDb250ZW50KTtcclxuXHJcbiAgICAgICAgaWYgKGxpbmtDb250ZW50LnRleHQuaW5jbHVkZXMoZXZlbnQubmFtZSkpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdGb3VuZCBtYXRjaGluZyBldmVudCwgY2xpY2tpbmcgbGluaycpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBDcmVhdGUgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiBhIG5ldyBwYWdlIGlzIGNyZWF0ZWRcclxuICAgICAgICAgIGNvbnN0IG5ld1BhZ2VQcm9taXNlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBcclxuICAgICAgICAgICAgcGFnZS5icm93c2VyKCkub25jZSgndGFyZ2V0Y3JlYXRlZCcsIGFzeW5jIHRhcmdldCA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgbmV3UGFnZSA9IGF3YWl0IHRhcmdldC5wYWdlKCk7XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZShuZXdQYWdlKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgLy8gQ2xpY2sgdGhlIGxpbmtcclxuICAgICAgICAgIGF3YWl0IGxpbmsuY2xpY2soKTtcclxuXHJcbiAgICAgICAgICAvLyBXYWl0IGZvciB0aGUgbmV3IHBhZ2UgdG8gb3BlblxyXG4gICAgICAgICAgY29uc3QgbmV3UGFnZSA9IGF3YWl0IG5ld1BhZ2VQcm9taXNlO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ05ldyBwYWdlIG9wZW5lZCcpO1xyXG5cclxuICAgICAgICAgIC8vIFdhaXQgZm9yIHRoZSBsaXN0aW5ncyBjb250YWluZXIgaW4gdGhlIG5ldyBwYWdlXHJcbiAgICAgICAgICBhd2FpdCBuZXdQYWdlLndhaXRGb3JTZWxlY3RvcignI2xpc3RpbmdzLWNvbnRhaW5lcicsIHsgdGltZW91dDogNjAwMDAgfSk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnRXZlbnQgcGFnZSBsb2FkZWQnKTtcclxuXHJcbiAgICAgICAgICAvLyBSZXR1cm4gYm90aCBzdWNjZXNzIHN0YXR1cyBhbmQgdGhlIG5ldyBwYWdlXHJcbiAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBwYWdlOiBuZXdQYWdlIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhgQ291bGQgbm90IGZpbmQgZXZlbnQgd2l0aCBuYW1lOiAke2V2ZW50Lm5hbWV9YCk7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBwYWdlOiBudWxsIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdOYXZpZ2F0aW9uIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIHBhZ2U6IG51bGwgfTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFN0dWJIdWJTZWFyY2hlcjsiXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50IiwiY29uZmlnIiwic2V0dXBCcm93c2VyIiwic2V0dXBQYWdlIiwicGFyc2UiLCJzdXBhYmFzZUNsaWVudCIsInN1cGFiYXNlIiwidXJsIiwic2VydmljZUtleSIsIlN0dWJIdWJTZWFyY2hlciIsImNvbnN0cnVjdG9yIiwiYmFzZVVybCIsImdlbmVyYXRlU2VhcmNoVXJsIiwiYXJ0aXN0IiwidmVudWUiLCJsb2NhdGlvbiIsInNlYXJjaFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsInNlYXJjaFRlcm1zIiwiZmlsdGVyIiwiQm9vbGVhbiIsImFwcGVuZCIsImpvaW4iLCJ0b1N0cmluZyIsImJyb3dzZXIiLCJnZXRUaWNrZXRQcmljZXMiLCJldmVudFVybCIsImV4aXN0aW5nUGFnZSIsInBhZ2UiLCJjb25zb2xlIiwibG9nIiwiZ290byIsIndhaXRVbnRpbCIsInRpbWVvdXQiLCJjaGVja0xpc3RpbmdzQ29udGFpbmVyIiwiY29udGVudCIsImluY2x1ZGVzIiwiaGFzTGlzdGluZ3MiLCJQcm9taXNlIiwicmFjZSIsInJlbG9hZCIsIl8iLCJyZWplY3QiLCJzZXRUaW1lb3V0IiwiRXJyb3IiLCJ3YWl0Rm9yVGltZW91dCIsInJlbG9hZEVycm9yIiwibWVzc2FnZSIsImxpc3RpbmdzRm91bmQiLCJzZWxlY3RvcnMiLCJzZWxlY3RvciIsIndhaXRGb3JTZWxlY3RvciIsInZpc2libGUiLCJlcnJvciIsInNjcmVlbnNob3QiLCJwYXRoIiwiZnVsbFBhZ2UiLCJ3YWl0Rm9yRnVuY3Rpb24iLCJsaXN0aW5ncyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImxlbmd0aCIsInRpY2tldHMiLCJldmFsdWF0ZSIsIkFycmF5IiwiZnJvbSIsInRpY2tldHNCeVNlY3Rpb24iLCJmb3JFYWNoIiwibGlzdGluZyIsImluZGV4IiwiZ2V0QXR0cmlidXRlIiwic2VjdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsInRyaW0iLCJwcmljZUVsZW1lbnQiLCJwcmljZSIsInF1YW50aXR5IiwibG93ZXN0UHJpY2UiLCJJbmZpbml0eSIsImhpZ2hlc3RQcmljZSIsIm51bWJlck9mTGlzdGluZ3MiLCJudW1lcmljUHJpY2UiLCJwYXJzZUZsb2F0IiwicmVwbGFjZSIsInRpY2tldEluZm8iLCJyYXdQcmljZSIsImxpc3RpbmdVcmwiLCJ3aW5kb3ciLCJocmVmIiwibGlzdGluZ0lkIiwicHVzaCIsImlzTmFOIiwiTWF0aCIsIm1pbiIsIm1heCIsImVyciIsIk9iamVjdCIsInZhbHVlcyIsInNvcnQiLCJhIiwiYiIsInRvdGFsU2VjdGlvbnMiLCJrZXlzIiwic2VjdGlvbnMiLCJzdWJzdHJpbmciLCJjbG9zZSIsInNlYXJjaENvbmNlcnRzIiwic2VhcmNoUGFnZSIsImV2ZW50UGFnZSIsInNlYXJjaFVybCIsImV2ZW50cyIsImV4dHJhY3RFdmVudERldGFpbHMiLCJtYXRjaGluZ0V2ZW50cyIsImV2ZW50IiwibmFtZSIsInRpdGxlTWF0Y2giLCJ0b0xvd2VyQ2FzZSIsInZlbnVlTWF0Y2giLCJsb2NhdGlvbk1hdGNoIiwicHJvY2Vzc2VkVXJscyIsIlNldCIsImV2ZW50c1dpdGhUaWNrZXRzIiwiaGFzIiwibGluayIsInN1Y2Nlc3MiLCJuZXdQYWdlIiwibmF2aWdhdGVUb0V2ZW50IiwiSlNPTiIsInN0cmluZ2lmeSIsImRhdGUiLCJjYXRlZ29yeSIsInNvdXJjZSIsImFkZCIsImlzQ2xvc2VkIiwicmVzdWx0cyIsImxvZ3MiLCJldmVudENvbnRhaW5lciIsImxpc3RJdGVtcyIsInNsaWNlIiwiaXRlbSIsIm1hdGNoIiwidGl0bGUiLCJ0aW1lRWxlbWVudCIsImRhdGVUZXh0IiwiZGF0ZU1hdGNoIiwiZm9ybWF0dGVkRGF0ZSIsIm1vbnRoIiwiZGF5IiwieWVhciIsImRheU9mV2VlayIsInRpbWUiLCJkYXRlU3RyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJldmVudExpbmtzIiwiJCQiLCJsaW5rQ29udGVudCIsImVsIiwidGV4dCIsIm5ld1BhZ2VQcm9taXNlIiwicmVzb2x2ZSIsIm9uY2UiLCJ0YXJnZXQiLCJjbGljayJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/stub-hub.js\n");

/***/ }),

/***/ "(api)/./src/utils.js":
/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   formatPrice: () => (/* binding */ formatPrice),\n/* harmony export */   setupBrowser: () => (/* binding */ setupBrowser),\n/* harmony export */   setupPage: () => (/* binding */ setupPage)\n/* harmony export */ });\n/* harmony import */ var puppeteer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! puppeteer */ \"puppeteer\");\n/* harmony import */ var puppeteer__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(puppeteer__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var puppeteer_extra_plugin_stealth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! puppeteer-extra-plugin-stealth */ \"puppeteer-extra-plugin-stealth\");\n/* harmony import */ var puppeteer_extra_plugin_stealth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(puppeteer_extra_plugin_stealth__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var puppeteer_extra__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! puppeteer-extra */ \"puppeteer-extra\");\n/* harmony import */ var puppeteer_extra__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(puppeteer_extra__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst isDev = \"development\" === \"development\";\nconst isRender = process.env.RENDER === \"1\";\nconst isDebug = process.argv.includes(\"--debug\");\nasync function setupBrowser() {\n    try {\n        // Add stealth plugin to puppeteer\n        const puppeteerExtra = (0,puppeteer_extra__WEBPACK_IMPORTED_MODULE_2__.addExtra)((puppeteer__WEBPACK_IMPORTED_MODULE_0___default()));\n        puppeteerExtra.use(puppeteer_extra_plugin_stealth__WEBPACK_IMPORTED_MODULE_1___default()());\n        const launchOptions = {\n            headless: !isDebug,\n            args: [\n                \"--no-sandbox\",\n                \"--disable-setuid-sandbox\",\n                \"--disable-blink-features=AutomationControlled\",\n                \"--disable-features=IsolateOrigins,site-per-process\",\n                \"--disable-web-security\",\n                \"--disable-sync\",\n                \"--window-size=1920,1080\",\n                \"--disable-background-timer-throttling\",\n                \"--disable-backgrounding-occluded-windows\",\n                \"--disable-renderer-backgrounding\",\n                \"--disable-dev-shm-usage\",\n                \"--disable-accelerated-2d-canvas\",\n                \"--disable-gpu\"\n            ],\n            ignoreDefaultArgs: [\n                \"--enable-automation\"\n            ],\n            defaultViewport: {\n                width: 1920,\n                height: 1080\n            }\n        };\n        // Add production-specific options\n        if (!isDev || isRender) {\n            launchOptions.args.push(\"--hide-scrollbars\");\n            launchOptions.headless = true;\n        }\n        const browser = await puppeteerExtra.launch(launchOptions);\n        console.log(\"Browser launched successfully in\", isDebug ? \"visible\" : \"headless\", \"mode\");\n        return browser;\n    } catch (error) {\n        console.error(\"Error setting up browser:\", error);\n        console.error(\"Launch options:\", {\n            isDev,\n            isRender,\n            isDebug,\n            platform: process.platform\n        });\n        throw error;\n    }\n}\nasync function setupPage(browser) {\n    const page = await browser.newPage();\n    // Enhanced stealth settings\n    await page.evaluateOnNewDocument(()=>{\n        // Overwrite navigator properties\n        Object.defineProperties(navigator, {\n            webdriver: {\n                get: ()=>undefined\n            },\n            languages: {\n                get: ()=>[\n                        \"en-US\",\n                        \"en\"\n                    ]\n            },\n            plugins: {\n                get: ()=>[\n                        {\n                            0: {\n                                type: \"application/x-google-chrome-pdf\",\n                                suffixes: \"pdf\",\n                                description: \"Portable Document Format\",\n                                enabledPlugin: true\n                            },\n                            description: \"Portable Document Format\",\n                            filename: \"internal-pdf-viewer\",\n                            length: 1,\n                            name: \"Chrome PDF Plugin\"\n                        }\n                    ]\n            },\n            platform: {\n                get: ()=>\"Win32\"\n            },\n            vendor: {\n                get: ()=>\"Google Inc.\"\n            }\n        });\n        // Add missing chrome properties\n        window.chrome = {\n            app: {\n                isInstalled: false,\n                InstallState: {\n                    DISABLED: \"disabled\",\n                    INSTALLED: \"installed\",\n                    NOT_INSTALLED: \"not_installed\"\n                },\n                RunningState: {\n                    CANNOT_RUN: \"cannot_run\",\n                    READY_TO_RUN: \"ready_to_run\",\n                    RUNNING: \"running\"\n                }\n            },\n            runtime: {\n                PlatformOs: {\n                    MAC: \"mac\",\n                    WIN: \"win\",\n                    ANDROID: \"android\",\n                    CROS: \"cros\",\n                    LINUX: \"linux\",\n                    OPENBSD: \"openbsd\"\n                },\n                PlatformArch: {\n                    ARM: \"arm\",\n                    X86_32: \"x86-32\",\n                    X86_64: \"x86-64\"\n                },\n                RequestUpdateCheckStatus: {\n                    THROTTLED: \"throttled\",\n                    NO_UPDATE: \"no_update\",\n                    UPDATE_AVAILABLE: \"update_available\"\n                },\n                OnInstalledReason: {\n                    INSTALL: \"install\",\n                    UPDATE: \"update\",\n                    CHROME_UPDATE: \"chrome_update\",\n                    SHARED_MODULE_UPDATE: \"shared_module_update\"\n                },\n                OnRestartRequiredReason: {\n                    APP_UPDATE: \"app_update\",\n                    OS_UPDATE: \"os_update\",\n                    PERIODIC: \"periodic\"\n                }\n            }\n        };\n        // Modify permissions API\n        const originalQuery = window.navigator.permissions?.query;\n        window.navigator.permissions.query = (parameters)=>parameters.name === \"notifications\" ? Promise.resolve({\n                state: Notification.permission\n            }) : originalQuery(parameters);\n        // Add WebGL properties\n        const getParameter = WebGLRenderingContext.prototype.getParameter;\n        WebGLRenderingContext.prototype.getParameter = function(parameter) {\n            // Spoof renderer info\n            if (parameter === 37445) {\n                return \"Intel Inc.\";\n            }\n            if (parameter === 37446) {\n                return \"Intel Iris OpenGL Engine\";\n            }\n            return getParameter.apply(this, [\n                parameter\n            ]);\n        };\n    });\n    // Set convincing headers\n    await page.setExtraHTTPHeaders({\n        \"Accept-Language\": \"en-US,en;q=0.9\",\n        \"Accept-Encoding\": \"gzip, deflate, br\",\n        \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8\",\n        \"Connection\": \"keep-alive\",\n        \"Upgrade-Insecure-Requests\": \"1\",\n        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\",\n        \"sec-ch-ua\": '\"Not_A Brand\";v=\"8\", \"Chromium\";v=\"120\", \"Google Chrome\";v=\"120\"',\n        \"sec-ch-ua-mobile\": \"?0\",\n        \"sec-ch-ua-platform\": '\"Windows\"'\n    });\n    // Set viewport and user agent\n    await page.setViewport({\n        width: 1920,\n        height: 1080\n    });\n    await page.setUserAgent(\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\");\n    // Add additional page configurations\n    await page.setDefaultNavigationTimeout(60000);\n    await page.setDefaultTimeout(30000);\n    return page;\n}\nfunction formatPrice(price) {\n    if (typeof price === \"string\") {\n        return parseFloat(price.replace(/[^0-9.]/g, \"\"));\n    }\n    return price;\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUksT0FBT0EsVUFBVSxVQUFVO1FBQzdCLE9BQU9DLFdBQVdELE1BQU1FLE9BQU8sQ0FBQyxZQUFZO0lBQzlDO0lBQ0EsT0FBT0Y7QUFDVDtBQU1FIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGlja2V0LXNlYXJjaGVyLy4vc3JjL3V0aWxzLmpzPzVkODAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHB1cHBldGVlciBmcm9tICdwdXBwZXRlZXInO1xyXG5pbXBvcnQgU3RlYWx0aFBsdWdpbiBmcm9tICdwdXBwZXRlZXItZXh0cmEtcGx1Z2luLXN0ZWFsdGgnO1xyXG5pbXBvcnQgeyBhZGRFeHRyYSB9IGZyb20gJ3B1cHBldGVlci1leHRyYSc7XHJcblxyXG5jb25zdCBpc0RldiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnO1xyXG5jb25zdCBpc1JlbmRlciA9IHByb2Nlc3MuZW52LlJFTkRFUiA9PT0gJzEnO1xyXG5jb25zdCBpc0RlYnVnID0gcHJvY2Vzcy5hcmd2LmluY2x1ZGVzKCctLWRlYnVnJyk7XHJcblxyXG5hc3luYyBmdW5jdGlvbiBzZXR1cEJyb3dzZXIoKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEFkZCBzdGVhbHRoIHBsdWdpbiB0byBwdXBwZXRlZXJcclxuICAgIGNvbnN0IHB1cHBldGVlckV4dHJhID0gYWRkRXh0cmEocHVwcGV0ZWVyKTtcclxuICAgIHB1cHBldGVlckV4dHJhLnVzZShTdGVhbHRoUGx1Z2luKCkpO1xyXG5cclxuICAgIGNvbnN0IGxhdW5jaE9wdGlvbnMgPSB7XHJcbiAgICAgIGhlYWRsZXNzOiAhaXNEZWJ1ZyxcclxuICAgICAgYXJnczogW1xyXG4gICAgICAgICctLW5vLXNhbmRib3gnLFxyXG4gICAgICAgICctLWRpc2FibGUtc2V0dWlkLXNhbmRib3gnLFxyXG4gICAgICAgICctLWRpc2FibGUtYmxpbmstZmVhdHVyZXM9QXV0b21hdGlvbkNvbnRyb2xsZWQnLFxyXG4gICAgICAgICctLWRpc2FibGUtZmVhdHVyZXM9SXNvbGF0ZU9yaWdpbnMsc2l0ZS1wZXItcHJvY2VzcycsXHJcbiAgICAgICAgJy0tZGlzYWJsZS13ZWItc2VjdXJpdHknLFxyXG4gICAgICAgICctLWRpc2FibGUtc3luYycsXHJcbiAgICAgICAgJy0td2luZG93LXNpemU9MTkyMCwxMDgwJyxcclxuICAgICAgICAnLS1kaXNhYmxlLWJhY2tncm91bmQtdGltZXItdGhyb3R0bGluZycsXHJcbiAgICAgICAgJy0tZGlzYWJsZS1iYWNrZ3JvdW5kaW5nLW9jY2x1ZGVkLXdpbmRvd3MnLFxyXG4gICAgICAgICctLWRpc2FibGUtcmVuZGVyZXItYmFja2dyb3VuZGluZycsXHJcbiAgICAgICAgJy0tZGlzYWJsZS1kZXYtc2htLXVzYWdlJyxcclxuICAgICAgICAnLS1kaXNhYmxlLWFjY2VsZXJhdGVkLTJkLWNhbnZhcycsXHJcbiAgICAgICAgJy0tZGlzYWJsZS1ncHUnXHJcbiAgICAgIF0sXHJcbiAgICAgIGlnbm9yZURlZmF1bHRBcmdzOiBbJy0tZW5hYmxlLWF1dG9tYXRpb24nXSxcclxuICAgICAgZGVmYXVsdFZpZXdwb3J0OiB7IHdpZHRoOiAxOTIwLCBoZWlnaHQ6IDEwODAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBBZGQgcHJvZHVjdGlvbi1zcGVjaWZpYyBvcHRpb25zXHJcbiAgICBpZiAoIWlzRGV2IHx8IGlzUmVuZGVyKSB7XHJcbiAgICAgIGxhdW5jaE9wdGlvbnMuYXJncy5wdXNoKFxyXG4gICAgICAgICctLWhpZGUtc2Nyb2xsYmFycydcclxuICAgICAgKTtcclxuICAgICAgbGF1bmNoT3B0aW9ucy5oZWFkbGVzcyA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYnJvd3NlciA9IGF3YWl0IHB1cHBldGVlckV4dHJhLmxhdW5jaChsYXVuY2hPcHRpb25zKTtcclxuICAgIGNvbnNvbGUubG9nKCdCcm93c2VyIGxhdW5jaGVkIHN1Y2Nlc3NmdWxseSBpbicsIGlzRGVidWcgPyAndmlzaWJsZScgOiAnaGVhZGxlc3MnLCAnbW9kZScpO1xyXG4gICAgcmV0dXJuIGJyb3dzZXI7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZXR0aW5nIHVwIGJyb3dzZXI6JywgZXJyb3IpO1xyXG4gICAgY29uc29sZS5lcnJvcignTGF1bmNoIG9wdGlvbnM6Jywge1xyXG4gICAgICBpc0RldixcclxuICAgICAgaXNSZW5kZXIsXHJcbiAgICAgIGlzRGVidWcsXHJcbiAgICAgIHBsYXRmb3JtOiBwcm9jZXNzLnBsYXRmb3JtXHJcbiAgICB9KTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gc2V0dXBQYWdlKGJyb3dzZXIpIHtcclxuICBjb25zdCBwYWdlID0gYXdhaXQgYnJvd3Nlci5uZXdQYWdlKCk7XHJcbiAgXHJcbiAgLy8gRW5oYW5jZWQgc3RlYWx0aCBzZXR0aW5nc1xyXG4gIGF3YWl0IHBhZ2UuZXZhbHVhdGVPbk5ld0RvY3VtZW50KCgpID0+IHtcclxuICAgIC8vIE92ZXJ3cml0ZSBuYXZpZ2F0b3IgcHJvcGVydGllc1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMobmF2aWdhdG9yLCB7XHJcbiAgICAgIHdlYmRyaXZlcjogeyBnZXQ6ICgpID0+IHVuZGVmaW5lZCB9LFxyXG4gICAgICBsYW5ndWFnZXM6IHsgZ2V0OiAoKSA9PiBbJ2VuLVVTJywgJ2VuJ10gfSxcclxuICAgICAgcGx1Z2luczoge1xyXG4gICAgICAgIGdldDogKCkgPT4gW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICAwOiB7XHJcbiAgICAgICAgICAgICAgdHlwZTogJ2FwcGxpY2F0aW9uL3gtZ29vZ2xlLWNocm9tZS1wZGYnLFxyXG4gICAgICAgICAgICAgIHN1ZmZpeGVzOiAncGRmJyxcclxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1BvcnRhYmxlIERvY3VtZW50IEZvcm1hdCcsXHJcbiAgICAgICAgICAgICAgZW5hYmxlZFBsdWdpbjogdHJ1ZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1BvcnRhYmxlIERvY3VtZW50IEZvcm1hdCcsXHJcbiAgICAgICAgICAgIGZpbGVuYW1lOiAnaW50ZXJuYWwtcGRmLXZpZXdlcicsXHJcbiAgICAgICAgICAgIGxlbmd0aDogMSxcclxuICAgICAgICAgICAgbmFtZTogJ0Nocm9tZSBQREYgUGx1Z2luJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIF1cclxuICAgICAgfSxcclxuICAgICAgcGxhdGZvcm06IHsgZ2V0OiAoKSA9PiAnV2luMzInIH0sXHJcbiAgICAgIHZlbmRvcjogeyBnZXQ6ICgpID0+ICdHb29nbGUgSW5jLicgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQWRkIG1pc3NpbmcgY2hyb21lIHByb3BlcnRpZXNcclxuICAgIHdpbmRvdy5jaHJvbWUgPSB7XHJcbiAgICAgIGFwcDoge1xyXG4gICAgICAgIGlzSW5zdGFsbGVkOiBmYWxzZSxcclxuICAgICAgICBJbnN0YWxsU3RhdGU6IHtcclxuICAgICAgICAgIERJU0FCTEVEOiAnZGlzYWJsZWQnLFxyXG4gICAgICAgICAgSU5TVEFMTEVEOiAnaW5zdGFsbGVkJyxcclxuICAgICAgICAgIE5PVF9JTlNUQUxMRUQ6ICdub3RfaW5zdGFsbGVkJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgUnVubmluZ1N0YXRlOiB7XHJcbiAgICAgICAgICBDQU5OT1RfUlVOOiAnY2Fubm90X3J1bicsXHJcbiAgICAgICAgICBSRUFEWV9UT19SVU46ICdyZWFkeV90b19ydW4nLFxyXG4gICAgICAgICAgUlVOTklORzogJ3J1bm5pbmcnXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBydW50aW1lOiB7XHJcbiAgICAgICAgUGxhdGZvcm1Pczoge1xyXG4gICAgICAgICAgTUFDOiAnbWFjJyxcclxuICAgICAgICAgIFdJTjogJ3dpbicsXHJcbiAgICAgICAgICBBTkRST0lEOiAnYW5kcm9pZCcsXHJcbiAgICAgICAgICBDUk9TOiAnY3JvcycsXHJcbiAgICAgICAgICBMSU5VWDogJ2xpbnV4JyxcclxuICAgICAgICAgIE9QRU5CU0Q6ICdvcGVuYnNkJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgUGxhdGZvcm1BcmNoOiB7XHJcbiAgICAgICAgICBBUk06ICdhcm0nLFxyXG4gICAgICAgICAgWDg2XzMyOiAneDg2LTMyJyxcclxuICAgICAgICAgIFg4Nl82NDogJ3g4Ni02NCdcclxuICAgICAgICB9LFxyXG4gICAgICAgIFJlcXVlc3RVcGRhdGVDaGVja1N0YXR1czoge1xyXG4gICAgICAgICAgVEhST1RUTEVEOiAndGhyb3R0bGVkJyxcclxuICAgICAgICAgIE5PX1VQREFURTogJ25vX3VwZGF0ZScsXHJcbiAgICAgICAgICBVUERBVEVfQVZBSUxBQkxFOiAndXBkYXRlX2F2YWlsYWJsZSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIE9uSW5zdGFsbGVkUmVhc29uOiB7XHJcbiAgICAgICAgICBJTlNUQUxMOiAnaW5zdGFsbCcsXHJcbiAgICAgICAgICBVUERBVEU6ICd1cGRhdGUnLFxyXG4gICAgICAgICAgQ0hST01FX1VQREFURTogJ2Nocm9tZV91cGRhdGUnLFxyXG4gICAgICAgICAgU0hBUkVEX01PRFVMRV9VUERBVEU6ICdzaGFyZWRfbW9kdWxlX3VwZGF0ZSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIE9uUmVzdGFydFJlcXVpcmVkUmVhc29uOiB7XHJcbiAgICAgICAgICBBUFBfVVBEQVRFOiAnYXBwX3VwZGF0ZScsXHJcbiAgICAgICAgICBPU19VUERBVEU6ICdvc191cGRhdGUnLFxyXG4gICAgICAgICAgUEVSSU9ESUM6ICdwZXJpb2RpYydcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gTW9kaWZ5IHBlcm1pc3Npb25zIEFQSVxyXG4gICAgY29uc3Qgb3JpZ2luYWxRdWVyeSA9IHdpbmRvdy5uYXZpZ2F0b3IucGVybWlzc2lvbnM/LnF1ZXJ5O1xyXG4gICAgd2luZG93Lm5hdmlnYXRvci5wZXJtaXNzaW9ucy5xdWVyeSA9IChwYXJhbWV0ZXJzKSA9PiAoXHJcbiAgICAgIHBhcmFtZXRlcnMubmFtZSA9PT0gJ25vdGlmaWNhdGlvbnMnID9cclxuICAgICAgICBQcm9taXNlLnJlc29sdmUoeyBzdGF0ZTogTm90aWZpY2F0aW9uLnBlcm1pc3Npb24gfSkgOlxyXG4gICAgICAgIG9yaWdpbmFsUXVlcnkocGFyYW1ldGVycylcclxuICAgICk7XHJcblxyXG4gICAgLy8gQWRkIFdlYkdMIHByb3BlcnRpZXNcclxuICAgIGNvbnN0IGdldFBhcmFtZXRlciA9IFdlYkdMUmVuZGVyaW5nQ29udGV4dC5wcm90b3R5cGUuZ2V0UGFyYW1ldGVyO1xyXG4gICAgV2ViR0xSZW5kZXJpbmdDb250ZXh0LnByb3RvdHlwZS5nZXRQYXJhbWV0ZXIgPSBmdW5jdGlvbihwYXJhbWV0ZXIpIHtcclxuICAgICAgLy8gU3Bvb2YgcmVuZGVyZXIgaW5mb1xyXG4gICAgICBpZiAocGFyYW1ldGVyID09PSAzNzQ0NSkge1xyXG4gICAgICAgIHJldHVybiAnSW50ZWwgSW5jLic7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHBhcmFtZXRlciA9PT0gMzc0NDYpIHtcclxuICAgICAgICByZXR1cm4gJ0ludGVsIElyaXMgT3BlbkdMIEVuZ2luZSc7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGdldFBhcmFtZXRlci5hcHBseSh0aGlzLCBbcGFyYW1ldGVyXSk7XHJcbiAgICB9O1xyXG4gIH0pO1xyXG5cclxuICAvLyBTZXQgY29udmluY2luZyBoZWFkZXJzXHJcbiAgYXdhaXQgcGFnZS5zZXRFeHRyYUhUVFBIZWFkZXJzKHtcclxuICAgICdBY2NlcHQtTGFuZ3VhZ2UnOiAnZW4tVVMsZW47cT0wLjknLFxyXG4gICAgJ0FjY2VwdC1FbmNvZGluZyc6ICdnemlwLCBkZWZsYXRlLCBicicsXHJcbiAgICAnQWNjZXB0JzogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCcsXHJcbiAgICAnQ29ubmVjdGlvbic6ICdrZWVwLWFsaXZlJyxcclxuICAgICdVcGdyYWRlLUluc2VjdXJlLVJlcXVlc3RzJzogJzEnLFxyXG4gICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEyMC4wLjAuMCBTYWZhcmkvNTM3LjM2JyxcclxuICAgICdzZWMtY2gtdWEnOiAnXCJOb3RfQSBCcmFuZFwiO3Y9XCI4XCIsIFwiQ2hyb21pdW1cIjt2PVwiMTIwXCIsIFwiR29vZ2xlIENocm9tZVwiO3Y9XCIxMjBcIicsXHJcbiAgICAnc2VjLWNoLXVhLW1vYmlsZSc6ICc/MCcsXHJcbiAgICAnc2VjLWNoLXVhLXBsYXRmb3JtJzogJ1wiV2luZG93c1wiJ1xyXG4gIH0pO1xyXG5cclxuICAvLyBTZXQgdmlld3BvcnQgYW5kIHVzZXIgYWdlbnRcclxuICBhd2FpdCBwYWdlLnNldFZpZXdwb3J0KHsgd2lkdGg6IDE5MjAsIGhlaWdodDogMTA4MCB9KTtcclxuICBhd2FpdCBwYWdlLnNldFVzZXJBZ2VudCgnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEyMC4wLjAuMCBTYWZhcmkvNTM3LjM2Jyk7XHJcblxyXG4gIC8vIEFkZCBhZGRpdGlvbmFsIHBhZ2UgY29uZmlndXJhdGlvbnNcclxuICBhd2FpdCBwYWdlLnNldERlZmF1bHROYXZpZ2F0aW9uVGltZW91dCg2MDAwMCk7XHJcbiAgYXdhaXQgcGFnZS5zZXREZWZhdWx0VGltZW91dCgzMDAwMCk7XHJcblxyXG4gIHJldHVybiBwYWdlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBmb3JtYXRQcmljZShwcmljZSkge1xyXG4gIGlmICh0eXBlb2YgcHJpY2UgPT09ICdzdHJpbmcnKSB7XHJcbiAgICByZXR1cm4gcGFyc2VGbG9hdChwcmljZS5yZXBsYWNlKC9bXjAtOS5dL2csICcnKSk7XHJcbiAgfVxyXG4gIHJldHVybiBwcmljZTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICBzZXR1cEJyb3dzZXIsXHJcbiAgc2V0dXBQYWdlLFxyXG4gIGZvcm1hdFByaWNlXHJcbn07Il0sIm5hbWVzIjpbInB1cHBldGVlciIsIlN0ZWFsdGhQbHVnaW4iLCJhZGRFeHRyYSIsImlzRGV2IiwicHJvY2VzcyIsImlzUmVuZGVyIiwiZW52IiwiUkVOREVSIiwiaXNEZWJ1ZyIsImFyZ3YiLCJpbmNsdWRlcyIsInNldHVwQnJvd3NlciIsInB1cHBldGVlckV4dHJhIiwidXNlIiwibGF1bmNoT3B0aW9ucyIsImhlYWRsZXNzIiwiYXJncyIsImlnbm9yZURlZmF1bHRBcmdzIiwiZGVmYXVsdFZpZXdwb3J0Iiwid2lkdGgiLCJoZWlnaHQiLCJwdXNoIiwiYnJvd3NlciIsImxhdW5jaCIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsInBsYXRmb3JtIiwic2V0dXBQYWdlIiwicGFnZSIsIm5ld1BhZ2UiLCJldmFsdWF0ZU9uTmV3RG9jdW1lbnQiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0aWVzIiwibmF2aWdhdG9yIiwid2ViZHJpdmVyIiwiZ2V0IiwidW5kZWZpbmVkIiwibGFuZ3VhZ2VzIiwicGx1Z2lucyIsInR5cGUiLCJzdWZmaXhlcyIsImRlc2NyaXB0aW9uIiwiZW5hYmxlZFBsdWdpbiIsImZpbGVuYW1lIiwibGVuZ3RoIiwibmFtZSIsInZlbmRvciIsIndpbmRvdyIsImNocm9tZSIsImFwcCIsImlzSW5zdGFsbGVkIiwiSW5zdGFsbFN0YXRlIiwiRElTQUJMRUQiLCJJTlNUQUxMRUQiLCJOT1RfSU5TVEFMTEVEIiwiUnVubmluZ1N0YXRlIiwiQ0FOTk9UX1JVTiIsIlJFQURZX1RPX1JVTiIsIlJVTk5JTkciLCJydW50aW1lIiwiUGxhdGZvcm1PcyIsIk1BQyIsIldJTiIsIkFORFJPSUQiLCJDUk9TIiwiTElOVVgiLCJPUEVOQlNEIiwiUGxhdGZvcm1BcmNoIiwiQVJNIiwiWDg2XzMyIiwiWDg2XzY0IiwiUmVxdWVzdFVwZGF0ZUNoZWNrU3RhdHVzIiwiVEhST1RUTEVEIiwiTk9fVVBEQVRFIiwiVVBEQVRFX0FWQUlMQUJMRSIsIk9uSW5zdGFsbGVkUmVhc29uIiwiSU5TVEFMTCIsIlVQREFURSIsIkNIUk9NRV9VUERBVEUiLCJTSEFSRURfTU9EVUxFX1VQREFURSIsIk9uUmVzdGFydFJlcXVpcmVkUmVhc29uIiwiQVBQX1VQREFURSIsIk9TX1VQREFURSIsIlBFUklPRElDIiwib3JpZ2luYWxRdWVyeSIsInBlcm1pc3Npb25zIiwicXVlcnkiLCJwYXJhbWV0ZXJzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzdGF0ZSIsIk5vdGlmaWNhdGlvbiIsInBlcm1pc3Npb24iLCJnZXRQYXJhbWV0ZXIiLCJXZWJHTFJlbmRlcmluZ0NvbnRleHQiLCJwcm90b3R5cGUiLCJwYXJhbWV0ZXIiLCJhcHBseSIsInNldEV4dHJhSFRUUEhlYWRlcnMiLCJzZXRWaWV3cG9ydCIsInNldFVzZXJBZ2VudCIsInNldERlZmF1bHROYXZpZ2F0aW9uVGltZW91dCIsInNldERlZmF1bHRUaW1lb3V0IiwiZm9ybWF0UHJpY2UiLCJwcmljZSIsInBhcnNlRmxvYXQiLCJyZXBsYWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/utils.js\n");

/***/ }),

/***/ "(api)/./src/vivid-seats.js":
/*!****************************!*\
  !*** ./src/vivid-seats.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _src_config_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/src/config/env */ \"(api)/./src/config/env.ts\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils.js */ \"(api)/./src/utils.js\");\n/* harmony import */ var _barrel_optimize_names_parse_date_fns__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! __barrel_optimize__?names=parse!=!date-fns */ \"(api)/__barrel_optimize__?names=parse!=!./node_modules/date-fns/index.js\");\n\n\n\n\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(_src_config_env__WEBPACK_IMPORTED_MODULE_1__.config.supabase.url, _src_config_env__WEBPACK_IMPORTED_MODULE_1__.config.supabase.serviceKey);\n// Function to check if an event exists\nasync function eventExists(name, date) {\n    const { data, error } = await supabase.from(\"events\").select(\"id\").eq(\"name\", name).eq(\"date\", date).single();\n    if (error && error.code !== \"PGRST116\") {\n        console.error(\"Error checking event existence:\", error);\n        return false;\n    }\n    return data ? true : false;\n}\n// Function to check if a link exists\nasync function linkExists(eventId, source) {\n    const { data, error } = await supabase.from(\"event_links\").select(\"id\").eq(\"event_id\", eventId).eq(\"source\", source).single();\n    if (error && error.code !== \"PGRST116\") {\n        console.error(\"Error checking link existence:\", error);\n        return false;\n    }\n    return data ? true : false;\n}\n// Function to insert an event\nasync function insertEvent(event) {\n    const parsedDate = (0,_barrel_optimize_names_parse_date_fns__WEBPACK_IMPORTED_MODULE_3__.parse)(event.date, \"MMM d yyyy h:mm a\", new Date());\n    console.log(`Parsed Date Object: ${parsedDate} | Timestamp: ${parsedDate.getTime()}`);\n    if (isNaN(parsedDate)) {\n        console.error(\"Invalid Date object:\", event.date);\n        return null;\n    }\n    // Check if the event already exists\n    const exists = await eventExists(event.title, parsedDate.toISOString());\n    if (exists) {\n        console.log(`Event \"${event.title}\" on ${parsedDate.toISOString()} already exists. Skipping insertion.`);\n        return null;\n    }\n    const eventData = {\n        name: event.title,\n        type: event.type || \"Concert\",\n        category: event.category || \"Unknown\",\n        date: parsedDate.toISOString(),\n        venue: event.venue\n    };\n    console.log(\"Attempting to insert event:\", eventData);\n    const { data, error } = await supabase.from(\"events\").insert([\n        eventData\n    ]).select(\"id\");\n    if (error) {\n        console.error(\"Error inserting event:\", error);\n        console.error(\"Error details:\", {\n            code: error.code,\n            message: error.message,\n            details: error.details,\n            hint: error.hint\n        });\n        return null;\n    }\n    console.log(\"Successfully inserted event:\", data[0].id);\n    return data[0].id;\n}\n// Function to insert event links\nasync function insertEventLink(eventId, source, url) {\n    // Check if the link already exists to prevent duplicates\n    const exists = await linkExists(eventId, source);\n    if (exists) {\n        console.log(`Event link from ${source} already exists for event ID ${eventId}. Skipping insertion.`);\n        return;\n    }\n    const linkData = {\n        event_id: eventId,\n        source: source,\n        url: url\n    };\n    const { data, error } = await supabase.from(\"event_links\").insert([\n        linkData\n    ]);\n    if (error) {\n        console.error(`Error inserting event link (${source}):`, error);\n    } else {\n        console.log(`Inserted event link (${source}):`, data[0].id);\n    }\n}\n// Function to insert tickets\nasync function insertTickets(eventId, tickets) {\n    const formattedTickets = tickets.sections.flatMap((section)=>section.tickets.map((ticket)=>({\n                event_id: eventId,\n                price: ticket.rawPrice,\n                type: section.category,\n                section: section.section,\n                row: ticket.row || null,\n                quantity: parseInt(ticket.quantity, 10) || 1,\n                source: \"vividseats\",\n                url: ticket.listingUrl,\n                raw_data: ticket\n            })));\n    const { data, error } = await supabase.from(\"tickets\").insert(formattedTickets);\n    if (error) {\n        console.error(\"Error inserting tickets:\", error);\n    } else {\n        console.log(\"Inserted tickets:\", data.length);\n    }\n}\nasync function mainSearch(artist, venue, location) {\n    const searcher = new VividSeatsSearcher();\n    const concertsWithPrices = await searcher.searchConcerts(artist, venue, location);\n    for (const concert of concertsWithPrices){\n        const eventId = await insertEvent(concert);\n        if (eventId) {\n            // Insert event links into event_links table\n            await insertEventLink(eventId, \"vividseats\", concert.link);\n            // Insert tickets into tickets table\n            if (concert.tickets) {\n                await insertTickets(eventId, concert.tickets);\n            }\n        }\n    }\n}\n// Call mainSearch with your parameters\n// mainSearch('Cake', 'Salt Shed', 'Chicago');\nclass VividSeatsSearcher {\n    constructor(){\n        this.baseUrl = \"https://www.vividseats.com/search\";\n    }\n    generateSearchUrl(artist, venue, location) {\n        const searchParams = new URLSearchParams();\n        let searchTerms = [];\n        if (artist) searchTerms.push(artist);\n        if (location) searchTerms.push(location);\n        searchParams.append(\"searchTerm\", searchTerms.join(\" \"));\n        return `${this.baseUrl}?${searchParams.toString()}`;\n    }\n    // ... existing methods including getTicketPrices and searchConcerts ...\n    async searchConcerts(artist, venue, location) {\n        const browser = await (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.setupBrowser)();\n        let searchPage;\n        try {\n            searchPage = await (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.setupPage)(browser);\n            const searchUrl = this.generateSearchUrl(artist, venue, location);\n            console.log(\"Searching VividSeats:\", searchUrl);\n            await searchPage.goto(searchUrl, {\n                waitUntil: \"networkidle0\",\n                timeout: 30000\n            });\n            // Wait for either productions list to appear\n            await searchPage.waitForSelector('[data-testid=\"productions-list\"]', {\n                timeout: 10000\n            });\n            const concerts = await searchPage.evaluate(({ artist, location, venue })=>{\n                // Get all production listings from both \"Upcoming Events\" and \"All Locations\" sections\n                const productionLists = Array.from(document.querySelectorAll('[data-testid=\"productions-list\"]'));\n                const allEvents = [];\n                productionLists.forEach((list)=>{\n                    // First, get all production listings\n                    const listings = Array.from(list.querySelectorAll('[data-testid^=\"production-listing-\"]'));\n                    console.log(`Found ${listings.length} listings`);\n                    listings.forEach((listing)=>{\n                        try {\n                            // Get the anchor element and check if it exists and has href\n                            const anchor = listing.querySelector(\"a\");\n                            if (!anchor || !anchor.href) {\n                                console.log(\"Skipping listing - no valid link found\");\n                                return;\n                            }\n                            // Skip parking listings\n                            if (anchor.href.toLowerCase().includes(\"parking\")) {\n                                console.log(\"Skipping parking listing\");\n                                return;\n                            }\n                            // Get date components with null checks\n                            const dateElement = listing.querySelector('[data-testid=\"date-time-left-element\"]');\n                            if (!dateElement) {\n                                console.log(\"Skipping listing - no date element found\");\n                                return;\n                            }\n                            const dayOfWeek = dateElement.querySelector(\".MuiTypography-overline\")?.textContent?.trim() || \"\";\n                            const date = dateElement.querySelector(\".MuiTypography-small-bold\")?.textContent?.trim() || \"\";\n                            const year = dateElement.querySelector(\".MuiTypography-small-bold:last-of-type\")?.textContent?.trim() || \"\";\n                            const time = dateElement.querySelector(\".MuiTypography-caption\")?.textContent?.trim() || \"\";\n                            // Get title with null check\n                            const titleElement = listing.querySelector(\".styles_titleTruncate__XiZ53\");\n                            if (!titleElement) {\n                                console.log(\"Skipping listing - no title element found\");\n                                return;\n                            }\n                            const title = titleElement.textContent.trim();\n                            // Find venue and location using the styles_labelContainer__ wildcard\n                            const labelContainer = listing.querySelector('[class^=\"styles_labelContainer__\"]');\n                            if (!labelContainer) {\n                                console.log(\"Skipping listing - no label container found\");\n                                return;\n                            }\n                            // Get all text truncate spans within the label container\n                            const truncateSpans = Array.from(labelContainer.querySelectorAll(\".styles_textTruncate__wsM3Q\"));\n                            if (truncateSpans.length < 2) {\n                                console.log(\"Skipping listing - incomplete venue/location info\");\n                                return;\n                            }\n                            // First span is venue, last span is location\n                            const venue = truncateSpans[0].textContent.trim();\n                            const eventLocation = truncateSpans[truncateSpans.length - 1].textContent.trim();\n                            // Only add event if we have all required fields\n                            if (title && date && venue && eventLocation && anchor.href) {\n                                console.log(`Found valid event: ${title} at ${venue}`);\n                                allEvents.push({\n                                    title,\n                                    date: `${date} ${dayOfWeek} ${time}`,\n                                    venue,\n                                    location: eventLocation,\n                                    link: anchor.href,\n                                    source: \"vividseats\",\n                                    rawData: {\n                                        dayOfWeek,\n                                        date,\n                                        year,\n                                        time,\n                                        fullTitle: title\n                                    }\n                                });\n                            }\n                        } catch (err) {\n                            console.log(\"Error parsing event:\", err);\n                        }\n                    });\n                });\n                // Score and sort events by relevance\n                return allEvents.map((event)=>{\n                    let score = 0;\n                    // Exact title match\n                    if (event.title.toLowerCase() === artist.toLowerCase()) score += 100;\n                    else if (event.title.toLowerCase().includes(artist.toLowerCase())) score += 50;\n                    // Location match\n                    if (event.location.toLowerCase().includes(location.toLowerCase())) score += 30;\n                    // Venue match (if provided)\n                    if (venue && event.venue.toLowerCase().includes(venue.toLowerCase())) score += 20;\n                    return {\n                        ...event,\n                        matchScore: score\n                    };\n                }).sort((a, b)=>b.matchScore - a.matchScore);\n            }, {\n                artist,\n                location,\n                venue\n            });\n            console.log(`Found ${concerts.length} matching VividSeats event(s)`);\n            // Get tickets for the best matching event(s)\n            const bestMatches = concerts.filter((event)=>event.matchScore >= 50);\n            const concertsWithPrices = [];\n            // Process each event only once\n            const processedUrls = new Set();\n            for (const concert of bestMatches){\n                // Skip if we've already processed this URL\n                if (processedUrls.has(concert.link)) {\n                    continue;\n                }\n                console.log(`Processing event: \"${concert.title}\" (match score: ${concert.matchScore})`);\n                // Use the existing page to navigate to the event\n                await searchPage.goto(concert.link, {\n                    waitUntil: \"networkidle0\",\n                    timeout: 30000\n                });\n                // Extract tickets directly from the loaded page\n                const tickets = await searchPage.evaluate(()=>{\n                    const groupListings = Array.from(document.querySelectorAll('[data-testid=\"listing-group-row-container\"]'));\n                    const individualListings = Array.from(document.querySelectorAll('[data-testid=\"listing-row-container\"]'));\n                    console.log(`Found ${groupListings.length} group listings and ${individualListings.length} individual listings`);\n                    const allListings = [\n                        ...groupListings,\n                        ...individualListings\n                    ];\n                    const normalizeSection = (section)=>{\n                        if (!section) return \"UNKNOWN\";\n                        const sectionUpper = section.toUpperCase();\n                        const categories = {\n                            \"GENERAL ADMISSION\": [\n                                \"GA\",\n                                \"GEN\",\n                                \"GENADM\"\n                            ],\n                            \"GRANDSTAND\": [\n                                \"GRAND\",\n                                \"GSADA\",\n                                \"GS\"\n                            ],\n                            \"PREMIUM\": [\n                                \"PREM\",\n                                \"PRM\"\n                            ],\n                            \"VIP\": [\n                                \"VIP\"\n                            ],\n                            \"BALCONY\": [\n                                \"BAL\",\n                                \"BALC\"\n                            ],\n                            \"FLOOR\": [\n                                \"FLR\",\n                                \"FLOOR\"\n                            ],\n                            \"STANDING\": [\n                                \"STAND\"\n                            ]\n                        };\n                        for (const [category, keywords] of Object.entries(categories)){\n                            if (keywords.some((keyword)=>sectionUpper.includes(keyword))) {\n                                return category;\n                            }\n                        }\n                        return `UNCATEGORIZED: ${section}`;\n                    };\n                    const ticketsBySection = {};\n                    allListings.forEach((listing, index)=>{\n                        try {\n                            const section = listing.querySelector('[data-testid^=\"GRANDS\"], [data-testid^=\"GSADA\"], [data-testid^=\"PREM\"], [data-testid^=\"GENADM\"], .MuiTypography-small-medium')?.textContent?.trim() || \"\";\n                            const quantity = listing.querySelector(\".MuiTypography-caption-regular\")?.textContent?.trim() || \"\";\n                            const price = listing.querySelector('[data-testid=\"listing-price\"]')?.textContent?.trim() || \"\";\n                            const row = listing.querySelector('[data-testid=\"row\"]')?.textContent?.trim();\n                            const dealScore = listing.querySelector('[data-testid=\"deal-score\"], .styles_greatestScoreLabel__Kq4O3')?.textContent?.trim() || \"\";\n                            const listingId = listing.getAttribute(\"data-listing-id\");\n                            const normalizedSection = normalizeSection(section);\n                            if (!ticketsBySection[normalizedSection]) {\n                                ticketsBySection[normalizedSection] = {\n                                    section: normalizedSection,\n                                    originalSection: section,\n                                    category: normalizedSection.startsWith(\"UNCATEGORIZED\") ? \"UNKNOWN\" : normalizedSection,\n                                    tickets: []\n                                };\n                            }\n                            if (price && section) {\n                                ticketsBySection[normalizedSection].tickets.push({\n                                    quantity,\n                                    price,\n                                    dealScore,\n                                    rawPrice: parseFloat(price.replace(/[^0-9.]/g, \"\")),\n                                    row: row || null,\n                                    listingId,\n                                    originalSection: section,\n                                    listingUrl: window.location.href\n                                });\n                            }\n                        } catch (err) {\n                            console.log(`Error processing listing ${index + 1}:`, err);\n                        }\n                    });\n                    Object.values(ticketsBySection).forEach((section)=>{\n                        section.tickets.sort((a, b)=>a.rawPrice - b.rawPrice);\n                        section.lowestPrice = section.tickets[0]?.rawPrice || null;\n                        section.highestPrice = section.tickets[section.tickets.length - 1]?.rawPrice || null;\n                        section.numberOfListings = section.tickets.length;\n                    });\n                    return {\n                        totalSections: Object.keys(ticketsBySection).length,\n                        sections: Object.values(ticketsBySection).sort((a, b)=>a.lowestPrice - b.lowestPrice)\n                    };\n                });\n                if (tickets && tickets.totalSections > 0) {\n                    console.log(`Found tickets in ${tickets.totalSections} sections`);\n                    concertsWithPrices.push({\n                        ...concert,\n                        tickets\n                    });\n                }\n                // Mark this URL as processed\n                processedUrls.add(concert.link);\n            }\n            return concertsWithPrices;\n        } catch (error) {\n            console.error(\"VividSeats error details:\", error);\n            if (searchPage) {\n                await searchPage.screenshot({\n                    path: \"vividseats-error.png\",\n                    fullPage: true\n                });\n            }\n            return [];\n        } finally{\n            if (browser) {\n                await browser.close();\n            }\n        }\n    }\n    async getTicketPrices(eventUrl, existingPage = null) {\n        let browser = null;\n        let page = existingPage;\n        try {\n            if (!existingPage) {\n                browser = await (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.setupBrowser)();\n                page = await (0,_utils_js__WEBPACK_IMPORTED_MODULE_2__.setupPage)(browser);\n                console.log(\"Navigating to event page:\", eventUrl);\n            }\n            // Function to check for content\n            const checkContent = async ()=>{\n                try {\n                    const content = await page.evaluate(()=>{\n                        const selectors = [\n                            \".styles_listingRowContainer__KNM4_\",\n                            \".styles_listingRowContainer__d8WLZ\",\n                            '[data-testid=\"listing-group-row-container\"]',\n                            '[data-testid=\"listing-row-container\"]'\n                        ];\n                        for (const selector of selectors){\n                            if (document.querySelector(selector)) {\n                                return true;\n                            }\n                        }\n                        return false;\n                    });\n                    return content;\n                } catch (error) {\n                    console.log(\"Error checking content:\", error);\n                    return false;\n                }\n            };\n            // Initial navigation\n            try {\n                await page.goto(eventUrl, {\n                    waitUntil: \"domcontentloaded\",\n                    timeout: 30000\n                });\n                await page.waitForTimeout(2000);\n            } catch (error) {\n                console.log(\"Initial navigation error:\", error);\n            }\n            // Check for content\n            let contentFound = await checkContent();\n            let attempts = 1;\n            const maxAttempts = 3;\n            while(!contentFound && attempts < maxAttempts){\n                console.log(`Content check attempt ${attempts} of ${maxAttempts}`);\n                try {\n                    await page.reload({\n                        waitUntil: \"domcontentloaded\"\n                    });\n                    await page.waitForTimeout(2000);\n                    contentFound = await checkContent();\n                    if (contentFound) {\n                        console.log(\"Found content on attempt\", attempts);\n                        break;\n                    }\n                } catch (error) {\n                    console.log(`Error on attempt ${attempts}:`, error);\n                }\n                attempts++;\n            }\n            if (!contentFound) {\n                throw new Error(\"Could not find content after multiple attempts\");\n            }\n            // Extract tickets only if content was found\n            const tickets = await page.evaluate(()=>{\n                const groupListings = Array.from(document.querySelectorAll('[data-testid=\"listing-group-row-container\"]'));\n                const individualListings = Array.from(document.querySelectorAll('[data-testid=\"listing-row-container\"]'));\n                console.log(`Found ${groupListings.length} group listings and ${individualListings.length} individual listings`);\n                const allListings = [\n                    ...groupListings,\n                    ...individualListings\n                ];\n                const normalizeSection = (section)=>{\n                    if (!section) return \"UNKNOWN\";\n                    const sectionUpper = section.toUpperCase();\n                    const categories = {\n                        \"GENERAL ADMISSION\": [\n                            \"GA\",\n                            \"GEN\",\n                            \"GENADM\"\n                        ],\n                        \"GRANDSTAND\": [\n                            \"GRAND\",\n                            \"GSADA\",\n                            \"GS\"\n                        ],\n                        \"PREMIUM\": [\n                            \"PREM\",\n                            \"PRM\"\n                        ],\n                        \"VIP\": [\n                            \"VIP\"\n                        ],\n                        \"BALCONY\": [\n                            \"BAL\",\n                            \"BALC\"\n                        ],\n                        \"FLOOR\": [\n                            \"FLR\",\n                            \"FLOOR\"\n                        ],\n                        \"STANDING\": [\n                            \"STAND\"\n                        ]\n                    };\n                    for (const [category, keywords] of Object.entries(categories)){\n                        if (keywords.some((keyword)=>sectionUpper.includes(keyword))) {\n                            return category;\n                        }\n                    }\n                    return `UNCATEGORIZED: ${section}`;\n                };\n                const ticketsBySection = {};\n                allListings.forEach((listing, index)=>{\n                    try {\n                        const section = listing.querySelector('[data-testid^=\"GRANDS\"], [data-testid^=\"GSADA\"], [data-testid^=\"PREM\"], [data-testid^=\"GENADM\"], .MuiTypography-small-medium')?.textContent?.trim() || \"\";\n                        const quantity = listing.querySelector(\".MuiTypography-caption-regular\")?.textContent?.trim() || \"\";\n                        const price = listing.querySelector('[data-testid=\"listing-price\"]')?.textContent?.trim() || \"\";\n                        const row = listing.querySelector('[data-testid=\"row\"]')?.textContent?.trim();\n                        const dealScore = listing.querySelector('[data-testid=\"deal-score\"], .styles_greatestScoreLabel__Kq4O3')?.textContent?.trim() || \"\";\n                        const listingId = listing.getAttribute(\"data-listing-id\");\n                        const normalizedSection = normalizeSection(section);\n                        if (!ticketsBySection[normalizedSection]) {\n                            ticketsBySection[normalizedSection] = {\n                                section: normalizedSection,\n                                originalSection: section,\n                                category: normalizedSection.startsWith(\"UNCATEGORIZED\") ? \"UNKNOWN\" : normalizedSection,\n                                tickets: []\n                            };\n                        }\n                        if (price && section) {\n                            ticketsBySection[normalizedSection].tickets.push({\n                                quantity,\n                                price,\n                                dealScore,\n                                rawPrice: parseFloat(price.replace(/[^0-9.]/g, \"\")),\n                                row: row || null,\n                                listingId,\n                                originalSection: section,\n                                listingUrl: window.location.href\n                            });\n                        }\n                    } catch (err) {\n                        console.log(`Error processing listing ${index + 1}:`, err);\n                    }\n                });\n                Object.values(ticketsBySection).forEach((section)=>{\n                    section.tickets.sort((a, b)=>a.rawPrice - b.rawPrice);\n                    section.lowestPrice = section.tickets[0]?.rawPrice || null;\n                    section.highestPrice = section.tickets[section.tickets.length - 1]?.rawPrice || null;\n                    section.numberOfListings = section.tickets.length;\n                });\n                return {\n                    totalSections: Object.keys(ticketsBySection).length,\n                    sections: Object.values(ticketsBySection).sort((a, b)=>a.lowestPrice - b.lowestPrice)\n                };\n            });\n            console.log(`Found tickets in ${tickets.totalSections} sections`);\n            return tickets;\n        } catch (error) {\n            console.error(\"Error fetching ticket prices:\", error);\n            return {\n                totalSections: 0,\n                sections: []\n            };\n        } finally{\n            if (browser && !existingPage) {\n                try {\n                    await browser.close();\n                } catch (error) {\n                    console.log(\"Error closing browser:\", error);\n                }\n            }\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (VividSeatsSearcher);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBTzNHO1FBRVQsRUFBRSxPQUFPakMsT0FBTztZQUNkTSxRQUFRTixLQUFLLENBQUMsaUNBQWlDQTtZQUMvQyxPQUFPO2dCQUFFNEksZUFBZTtnQkFBR3pHLFVBQVUsRUFBRTtZQUFDO1FBQzFDLFNBQVU7WUFDUixJQUFJZ0MsV0FBVyxDQUFDa0YsY0FBYztnQkFDNUIsSUFBSTtvQkFDRixNQUFNbEYsUUFBUStFLEtBQUs7Z0JBQ3JCLEVBQUUsT0FBT2xKLE9BQU87b0JBQ2RNLFFBQVFRLEdBQUcsQ0FBQywwQkFBMEJkO2dCQUN4QztZQUNGO1FBQ0Y7SUFDRjtBQUNGO0FBRUEsaUVBQWVvRCxrQkFBa0JBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aWNrZXQtc2VhcmNoZXIvLi9zcmMvdml2aWQtc2VhdHMuanM/YjkyMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xyXG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICdAL3NyYy9jb25maWcvZW52JztcclxuaW1wb3J0IHsgc2V0dXBCcm93c2VyLCBzZXR1cFBhZ2UsIGZvcm1hdFByaWNlIH0gZnJvbSAnLi91dGlscy5qcyc7XHJcbmltcG9ydCB7IHBhcnNlIH0gZnJvbSAnZGF0ZS1mbnMnO1xyXG5cclxuY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoXHJcbiAgY29uZmlnLnN1cGFiYXNlLnVybCxcclxuICBjb25maWcuc3VwYWJhc2Uuc2VydmljZUtleVxyXG4pO1xyXG5cclxuLy8gRnVuY3Rpb24gdG8gY2hlY2sgaWYgYW4gZXZlbnQgZXhpc3RzXHJcbmFzeW5jIGZ1bmN0aW9uIGV2ZW50RXhpc3RzKG5hbWUsIGRhdGUpIHtcclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ2V2ZW50cycpXHJcbiAgICAuc2VsZWN0KCdpZCcpXHJcbiAgICAuZXEoJ25hbWUnLCBuYW1lKVxyXG4gICAgLmVxKCdkYXRlJywgZGF0ZSlcclxuICAgIC5zaW5nbGUoKTtcclxuICBcclxuICBpZiAoZXJyb3IgJiYgZXJyb3IuY29kZSAhPT0gJ1BHUlNUMTE2Jykge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2hlY2tpbmcgZXZlbnQgZXhpc3RlbmNlOicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIGRhdGEgPyB0cnVlIDogZmFsc2U7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGNoZWNrIGlmIGEgbGluayBleGlzdHNcclxuYXN5bmMgZnVuY3Rpb24gbGlua0V4aXN0cyhldmVudElkLCBzb3VyY2UpIHtcclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ2V2ZW50X2xpbmtzJylcclxuICAgIC5zZWxlY3QoJ2lkJylcclxuICAgIC5lcSgnZXZlbnRfaWQnLCBldmVudElkKVxyXG4gICAgLmVxKCdzb3VyY2UnLCBzb3VyY2UpXHJcbiAgICAuc2luZ2xlKCk7XHJcbiAgXHJcbiAgaWYgKGVycm9yICYmIGVycm9yLmNvZGUgIT09ICdQR1JTVDExNicpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIGxpbmsgZXhpc3RlbmNlOicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIGRhdGEgPyB0cnVlIDogZmFsc2U7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGluc2VydCBhbiBldmVudFxyXG5hc3luYyBmdW5jdGlvbiBpbnNlcnRFdmVudChldmVudCkge1xyXG4gIGNvbnN0IHBhcnNlZERhdGUgPSBwYXJzZShldmVudC5kYXRlLCAnTU1NIGQgeXl5eSBoOm1tIGEnLCBuZXcgRGF0ZSgpKTtcclxuXHJcbiAgY29uc29sZS5sb2coYFBhcnNlZCBEYXRlIE9iamVjdDogJHtwYXJzZWREYXRlfSB8IFRpbWVzdGFtcDogJHtwYXJzZWREYXRlLmdldFRpbWUoKX1gKTtcclxuXHJcbiAgaWYgKGlzTmFOKHBhcnNlZERhdGUpKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIERhdGUgb2JqZWN0OicsIGV2ZW50LmRhdGUpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayBpZiB0aGUgZXZlbnQgYWxyZWFkeSBleGlzdHNcclxuICBjb25zdCBleGlzdHMgPSBhd2FpdCBldmVudEV4aXN0cyhldmVudC50aXRsZSwgcGFyc2VkRGF0ZS50b0lTT1N0cmluZygpKTtcclxuICBpZiAoZXhpc3RzKSB7XHJcbiAgICBjb25zb2xlLmxvZyhgRXZlbnQgXCIke2V2ZW50LnRpdGxlfVwiIG9uICR7cGFyc2VkRGF0ZS50b0lTT1N0cmluZygpfSBhbHJlYWR5IGV4aXN0cy4gU2tpcHBpbmcgaW5zZXJ0aW9uLmApO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBjb25zdCBldmVudERhdGEgPSB7XHJcbiAgICBuYW1lOiBldmVudC50aXRsZSxcclxuICAgIHR5cGU6IGV2ZW50LnR5cGUgfHwgJ0NvbmNlcnQnLFxyXG4gICAgY2F0ZWdvcnk6IGV2ZW50LmNhdGVnb3J5IHx8ICdVbmtub3duJyxcclxuICAgIGRhdGU6IHBhcnNlZERhdGUudG9JU09TdHJpbmcoKSxcclxuICAgIHZlbnVlOiBldmVudC52ZW51ZVxyXG4gIH07XHJcblxyXG4gIGNvbnNvbGUubG9nKCdBdHRlbXB0aW5nIHRvIGluc2VydCBldmVudDonLCBldmVudERhdGEpO1xyXG5cclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ2V2ZW50cycpXHJcbiAgICAuaW5zZXJ0KFtldmVudERhdGFdKVxyXG4gICAgLnNlbGVjdCgnaWQnKTtcclxuICBcclxuICBpZiAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluc2VydGluZyBldmVudDonLCBlcnJvcik7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZXRhaWxzOicsIHtcclxuICAgICAgY29kZTogZXJyb3IuY29kZSxcclxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcclxuICAgICAgZGV0YWlsczogZXJyb3IuZGV0YWlscyxcclxuICAgICAgaGludDogZXJyb3IuaGludFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbiAgXHJcbiAgY29uc29sZS5sb2coJ1N1Y2Nlc3NmdWxseSBpbnNlcnRlZCBldmVudDonLCBkYXRhWzBdLmlkKTtcclxuICByZXR1cm4gZGF0YVswXS5pZDtcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gaW5zZXJ0IGV2ZW50IGxpbmtzXHJcbmFzeW5jIGZ1bmN0aW9uIGluc2VydEV2ZW50TGluayhldmVudElkLCBzb3VyY2UsIHVybCkge1xyXG4gIC8vIENoZWNrIGlmIHRoZSBsaW5rIGFscmVhZHkgZXhpc3RzIHRvIHByZXZlbnQgZHVwbGljYXRlc1xyXG4gIGNvbnN0IGV4aXN0cyA9IGF3YWl0IGxpbmtFeGlzdHMoZXZlbnRJZCwgc291cmNlKTtcclxuICBpZiAoZXhpc3RzKSB7XHJcbiAgICBjb25zb2xlLmxvZyhgRXZlbnQgbGluayBmcm9tICR7c291cmNlfSBhbHJlYWR5IGV4aXN0cyBmb3IgZXZlbnQgSUQgJHtldmVudElkfS4gU2tpcHBpbmcgaW5zZXJ0aW9uLmApO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgbGlua0RhdGEgPSB7XHJcbiAgICBldmVudF9pZDogZXZlbnRJZCxcclxuICAgIHNvdXJjZTogc291cmNlLFxyXG4gICAgdXJsOiB1cmxcclxuICB9O1xyXG5cclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ2V2ZW50X2xpbmtzJylcclxuICAgIC5pbnNlcnQoW2xpbmtEYXRhXSk7XHJcbiAgXHJcbiAgaWYgKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBpbnNlcnRpbmcgZXZlbnQgbGluayAoJHtzb3VyY2V9KTpgLCBlcnJvcik7XHJcbiAgfSBlbHNlIHtcclxuICAgIGNvbnNvbGUubG9nKGBJbnNlcnRlZCBldmVudCBsaW5rICgke3NvdXJjZX0pOmAsIGRhdGFbMF0uaWQpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gaW5zZXJ0IHRpY2tldHNcclxuYXN5bmMgZnVuY3Rpb24gaW5zZXJ0VGlja2V0cyhldmVudElkLCB0aWNrZXRzKSB7XHJcbiAgY29uc3QgZm9ybWF0dGVkVGlja2V0cyA9IHRpY2tldHMuc2VjdGlvbnMuZmxhdE1hcChzZWN0aW9uID0+IFxyXG4gICAgc2VjdGlvbi50aWNrZXRzLm1hcCh0aWNrZXQgPT4gKHtcclxuICAgICAgZXZlbnRfaWQ6IGV2ZW50SWQsXHJcbiAgICAgIHByaWNlOiB0aWNrZXQucmF3UHJpY2UsXHJcbiAgICAgIHR5cGU6IHNlY3Rpb24uY2F0ZWdvcnksXHJcbiAgICAgIHNlY3Rpb246IHNlY3Rpb24uc2VjdGlvbixcclxuICAgICAgcm93OiB0aWNrZXQucm93IHx8IG51bGwsXHJcbiAgICAgIHF1YW50aXR5OiBwYXJzZUludCh0aWNrZXQucXVhbnRpdHksIDEwKSB8fCAxLFxyXG4gICAgICBzb3VyY2U6ICd2aXZpZHNlYXRzJyxcclxuICAgICAgdXJsOiB0aWNrZXQubGlzdGluZ1VybCxcclxuICAgICAgcmF3X2RhdGE6IHRpY2tldFxyXG4gICAgfSkpXHJcbiAgKTtcclxuICBcclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ3RpY2tldHMnKVxyXG4gICAgLmluc2VydChmb3JtYXR0ZWRUaWNrZXRzKTtcclxuICBcclxuICBpZiAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluc2VydGluZyB0aWNrZXRzOicsIGVycm9yKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY29uc29sZS5sb2coJ0luc2VydGVkIHRpY2tldHM6JywgZGF0YS5sZW5ndGgpO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gbWFpblNlYXJjaChhcnRpc3QsIHZlbnVlLCBsb2NhdGlvbikge1xyXG4gIGNvbnN0IHNlYXJjaGVyID0gbmV3IFZpdmlkU2VhdHNTZWFyY2hlcigpO1xyXG4gIGNvbnN0IGNvbmNlcnRzV2l0aFByaWNlcyA9IGF3YWl0IHNlYXJjaGVyLnNlYXJjaENvbmNlcnRzKGFydGlzdCwgdmVudWUsIGxvY2F0aW9uKTtcclxuICBcclxuICBmb3IgKGNvbnN0IGNvbmNlcnQgb2YgY29uY2VydHNXaXRoUHJpY2VzKSB7XHJcbiAgICBjb25zdCBldmVudElkID0gYXdhaXQgaW5zZXJ0RXZlbnQoY29uY2VydCk7XHJcbiAgICBpZiAoZXZlbnRJZCkge1xyXG4gICAgICAvLyBJbnNlcnQgZXZlbnQgbGlua3MgaW50byBldmVudF9saW5rcyB0YWJsZVxyXG4gICAgICBhd2FpdCBpbnNlcnRFdmVudExpbmsoZXZlbnRJZCwgJ3Zpdmlkc2VhdHMnLCBjb25jZXJ0LmxpbmspO1xyXG5cclxuICAgICAgLy8gSW5zZXJ0IHRpY2tldHMgaW50byB0aWNrZXRzIHRhYmxlXHJcbiAgICAgIGlmIChjb25jZXJ0LnRpY2tldHMpIHtcclxuICAgICAgICBhd2FpdCBpbnNlcnRUaWNrZXRzKGV2ZW50SWQsIGNvbmNlcnQudGlja2V0cyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8vIENhbGwgbWFpblNlYXJjaCB3aXRoIHlvdXIgcGFyYW1ldGVyc1xyXG4vLyBtYWluU2VhcmNoKCdDYWtlJywgJ1NhbHQgU2hlZCcsICdDaGljYWdvJyk7XHJcblxyXG5jbGFzcyBWaXZpZFNlYXRzU2VhcmNoZXIge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5iYXNlVXJsID0gJ2h0dHBzOi8vd3d3LnZpdmlkc2VhdHMuY29tL3NlYXJjaCc7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZVNlYXJjaFVybChhcnRpc3QsIHZlbnVlLCBsb2NhdGlvbikge1xyXG4gICAgY29uc3Qgc2VhcmNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xyXG4gICAgbGV0IHNlYXJjaFRlcm1zID0gW107XHJcbiAgICBcclxuICAgIGlmIChhcnRpc3QpIHNlYXJjaFRlcm1zLnB1c2goYXJ0aXN0KTtcclxuICAgIGlmIChsb2NhdGlvbikgc2VhcmNoVGVybXMucHVzaChsb2NhdGlvbik7XHJcbiAgICBcclxuICAgIHNlYXJjaFBhcmFtcy5hcHBlbmQoJ3NlYXJjaFRlcm0nLCBzZWFyY2hUZXJtcy5qb2luKCcgJykpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gYCR7dGhpcy5iYXNlVXJsfT8ke3NlYXJjaFBhcmFtcy50b1N0cmluZygpfWA7XHJcbiAgfVxyXG5cclxuICAvLyAuLi4gZXhpc3RpbmcgbWV0aG9kcyBpbmNsdWRpbmcgZ2V0VGlja2V0UHJpY2VzIGFuZCBzZWFyY2hDb25jZXJ0cyAuLi5cclxuXHJcbiAgYXN5bmMgc2VhcmNoQ29uY2VydHMoYXJ0aXN0LCB2ZW51ZSwgbG9jYXRpb24pIHtcclxuICAgIGNvbnN0IGJyb3dzZXIgPSBhd2FpdCBzZXR1cEJyb3dzZXIoKTtcclxuICAgIGxldCBzZWFyY2hQYWdlO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIHNlYXJjaFBhZ2UgPSBhd2FpdCBzZXR1cFBhZ2UoYnJvd3Nlcik7XHJcbiAgICAgIGNvbnN0IHNlYXJjaFVybCA9IHRoaXMuZ2VuZXJhdGVTZWFyY2hVcmwoYXJ0aXN0LCB2ZW51ZSwgbG9jYXRpb24pO1xyXG4gICAgICBjb25zb2xlLmxvZygnU2VhcmNoaW5nIFZpdmlkU2VhdHM6Jywgc2VhcmNoVXJsKTtcclxuXHJcbiAgICAgIGF3YWl0IHNlYXJjaFBhZ2UuZ290byhzZWFyY2hVcmwsIHtcclxuICAgICAgICB3YWl0VW50aWw6ICduZXR3b3JraWRsZTAnLFxyXG4gICAgICAgIHRpbWVvdXQ6IDMwMDAwXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gV2FpdCBmb3IgZWl0aGVyIHByb2R1Y3Rpb25zIGxpc3QgdG8gYXBwZWFyXHJcbiAgICAgIGF3YWl0IHNlYXJjaFBhZ2Uud2FpdEZvclNlbGVjdG9yKCdbZGF0YS10ZXN0aWQ9XCJwcm9kdWN0aW9ucy1saXN0XCJdJywgeyB0aW1lb3V0OiAxMDAwMCB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGNvbmNlcnRzID0gYXdhaXQgc2VhcmNoUGFnZS5ldmFsdWF0ZSgoeyBhcnRpc3QsIGxvY2F0aW9uLCB2ZW51ZSB9KSA9PiB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBwcm9kdWN0aW9uIGxpc3RpbmdzIGZyb20gYm90aCBcIlVwY29taW5nIEV2ZW50c1wiIGFuZCBcIkFsbCBMb2NhdGlvbnNcIiBzZWN0aW9uc1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3Rpb25MaXN0cyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdGVzdGlkPVwicHJvZHVjdGlvbnMtbGlzdFwiXScpKTtcclxuICAgICAgICBjb25zdCBhbGxFdmVudHMgPSBbXTtcclxuXHJcbiAgICAgICAgcHJvZHVjdGlvbkxpc3RzLmZvckVhY2gobGlzdCA9PiB7XHJcbiAgICAgICAgICAvLyBGaXJzdCwgZ2V0IGFsbCBwcm9kdWN0aW9uIGxpc3RpbmdzXHJcbiAgICAgICAgICBjb25zdCBsaXN0aW5ncyA9IEFycmF5LmZyb20obGlzdC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS10ZXN0aWRePVwicHJvZHVjdGlvbi1saXN0aW5nLVwiXScpKTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGBGb3VuZCAke2xpc3RpbmdzLmxlbmd0aH0gbGlzdGluZ3NgKTtcclxuXHJcbiAgICAgICAgICBsaXN0aW5ncy5mb3JFYWNoKGxpc3RpbmcgPT4ge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgIC8vIEdldCB0aGUgYW5jaG9yIGVsZW1lbnQgYW5kIGNoZWNrIGlmIGl0IGV4aXN0cyBhbmQgaGFzIGhyZWZcclxuICAgICAgICAgICAgICBjb25zdCBhbmNob3IgPSBsaXN0aW5nLnF1ZXJ5U2VsZWN0b3IoJ2EnKTtcclxuICAgICAgICAgICAgICBpZiAoIWFuY2hvciB8fCAhYW5jaG9yLmhyZWYpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTa2lwcGluZyBsaXN0aW5nIC0gbm8gdmFsaWQgbGluayBmb3VuZCcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLy8gU2tpcCBwYXJraW5nIGxpc3RpbmdzXHJcbiAgICAgICAgICAgICAgaWYgKGFuY2hvci5ocmVmLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3BhcmtpbmcnKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NraXBwaW5nIHBhcmtpbmcgbGlzdGluZycpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLy8gR2V0IGRhdGUgY29tcG9uZW50cyB3aXRoIG51bGwgY2hlY2tzXHJcbiAgICAgICAgICAgICAgY29uc3QgZGF0ZUVsZW1lbnQgPSBsaXN0aW5nLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRlc3RpZD1cImRhdGUtdGltZS1sZWZ0LWVsZW1lbnRcIl0nKTtcclxuICAgICAgICAgICAgICBpZiAoIWRhdGVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2tpcHBpbmcgbGlzdGluZyAtIG5vIGRhdGUgZWxlbWVudCBmb3VuZCcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgY29uc3QgZGF5T2ZXZWVrID0gZGF0ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLk11aVR5cG9ncmFwaHktb3ZlcmxpbmUnKT8udGV4dENvbnRlbnQ/LnRyaW0oKSB8fCAnJztcclxuICAgICAgICAgICAgICBjb25zdCBkYXRlID0gZGF0ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLk11aVR5cG9ncmFwaHktc21hbGwtYm9sZCcpPy50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgICAgICAgICAgIGNvbnN0IHllYXIgPSBkYXRlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuTXVpVHlwb2dyYXBoeS1zbWFsbC1ib2xkOmxhc3Qtb2YtdHlwZScpPy50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgICAgICAgICAgIGNvbnN0IHRpbWUgPSBkYXRlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuTXVpVHlwb2dyYXBoeS1jYXB0aW9uJyk/LnRleHRDb250ZW50Py50cmltKCkgfHwgJyc7XHJcblxyXG4gICAgICAgICAgICAgIC8vIEdldCB0aXRsZSB3aXRoIG51bGwgY2hlY2tcclxuICAgICAgICAgICAgICBjb25zdCB0aXRsZUVsZW1lbnQgPSBsaXN0aW5nLnF1ZXJ5U2VsZWN0b3IoJy5zdHlsZXNfdGl0bGVUcnVuY2F0ZV9fWGlaNTMnKTtcclxuICAgICAgICAgICAgICBpZiAoIXRpdGxlRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NraXBwaW5nIGxpc3RpbmcgLSBubyB0aXRsZSBlbGVtZW50IGZvdW5kJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gdGl0bGVFbGVtZW50LnRleHRDb250ZW50LnRyaW0oKTtcclxuXHJcbiAgICAgICAgICAgICAgLy8gRmluZCB2ZW51ZSBhbmQgbG9jYXRpb24gdXNpbmcgdGhlIHN0eWxlc19sYWJlbENvbnRhaW5lcl9fIHdpbGRjYXJkXHJcbiAgICAgICAgICAgICAgY29uc3QgbGFiZWxDb250YWluZXIgPSBsaXN0aW5nLnF1ZXJ5U2VsZWN0b3IoJ1tjbGFzc149XCJzdHlsZXNfbGFiZWxDb250YWluZXJfX1wiXScpO1xyXG4gICAgICAgICAgICAgIGlmICghbGFiZWxDb250YWluZXIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTa2lwcGluZyBsaXN0aW5nIC0gbm8gbGFiZWwgY29udGFpbmVyIGZvdW5kJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAvLyBHZXQgYWxsIHRleHQgdHJ1bmNhdGUgc3BhbnMgd2l0aGluIHRoZSBsYWJlbCBjb250YWluZXJcclxuICAgICAgICAgICAgICBjb25zdCB0cnVuY2F0ZVNwYW5zID0gQXJyYXkuZnJvbShsYWJlbENvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuc3R5bGVzX3RleHRUcnVuY2F0ZV9fd3NNM1EnKSk7XHJcbiAgICAgICAgICAgICAgaWYgKHRydW5jYXRlU3BhbnMubGVuZ3RoIDwgMikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NraXBwaW5nIGxpc3RpbmcgLSBpbmNvbXBsZXRlIHZlbnVlL2xvY2F0aW9uIGluZm8nKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIEZpcnN0IHNwYW4gaXMgdmVudWUsIGxhc3Qgc3BhbiBpcyBsb2NhdGlvblxyXG4gICAgICAgICAgICAgIGNvbnN0IHZlbnVlID0gdHJ1bmNhdGVTcGFuc1swXS50ZXh0Q29udGVudC50cmltKCk7XHJcbiAgICAgICAgICAgICAgY29uc3QgZXZlbnRMb2NhdGlvbiA9IHRydW5jYXRlU3BhbnNbdHJ1bmNhdGVTcGFucy5sZW5ndGggLSAxXS50ZXh0Q29udGVudC50cmltKCk7XHJcblxyXG4gICAgICAgICAgICAgIC8vIE9ubHkgYWRkIGV2ZW50IGlmIHdlIGhhdmUgYWxsIHJlcXVpcmVkIGZpZWxkc1xyXG4gICAgICAgICAgICAgIGlmICh0aXRsZSAmJiBkYXRlICYmIHZlbnVlICYmIGV2ZW50TG9jYXRpb24gJiYgYW5jaG9yLmhyZWYpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBGb3VuZCB2YWxpZCBldmVudDogJHt0aXRsZX0gYXQgJHt2ZW51ZX1gKTtcclxuICAgICAgICAgICAgICAgIGFsbEV2ZW50cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgdGl0bGUsXHJcbiAgICAgICAgICAgICAgICAgIGRhdGU6IGAke2RhdGV9ICR7ZGF5T2ZXZWVrfSAke3RpbWV9YCxcclxuICAgICAgICAgICAgICAgICAgdmVudWUsXHJcbiAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiBldmVudExvY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgICBsaW5rOiBhbmNob3IuaHJlZixcclxuICAgICAgICAgICAgICAgICAgc291cmNlOiAndml2aWRzZWF0cycsXHJcbiAgICAgICAgICAgICAgICAgIHJhd0RhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXlPZldlZWssXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICB5ZWFyLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVsbFRpdGxlOiB0aXRsZVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBwYXJzaW5nIGV2ZW50OicsIGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBTY29yZSBhbmQgc29ydCBldmVudHMgYnkgcmVsZXZhbmNlXHJcbiAgICAgICAgcmV0dXJuIGFsbEV2ZW50cy5tYXAoZXZlbnQgPT4ge1xyXG4gICAgICAgICAgbGV0IHNjb3JlID0gMDtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gRXhhY3QgdGl0bGUgbWF0Y2hcclxuICAgICAgICAgIGlmIChldmVudC50aXRsZS50b0xvd2VyQ2FzZSgpID09PSBhcnRpc3QudG9Mb3dlckNhc2UoKSkgc2NvcmUgKz0gMTAwO1xyXG4gICAgICAgICAgLy8gQ29udGFpbnMgYXJ0aXN0IG5hbWVcclxuICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoYXJ0aXN0LnRvTG93ZXJDYXNlKCkpKSBzY29yZSArPSA1MDtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gTG9jYXRpb24gbWF0Y2hcclxuICAgICAgICAgIGlmIChldmVudC5sb2NhdGlvbi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvY2F0aW9uLnRvTG93ZXJDYXNlKCkpKSBzY29yZSArPSAzMDtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gVmVudWUgbWF0Y2ggKGlmIHByb3ZpZGVkKVxyXG4gICAgICAgICAgaWYgKHZlbnVlICYmIGV2ZW50LnZlbnVlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModmVudWUudG9Mb3dlckNhc2UoKSkpIHNjb3JlICs9IDIwO1xyXG5cclxuICAgICAgICAgIHJldHVybiB7IC4uLmV2ZW50LCBtYXRjaFNjb3JlOiBzY29yZSB9O1xyXG4gICAgICAgIH0pLnNvcnQoKGEsIGIpID0+IGIubWF0Y2hTY29yZSAtIGEubWF0Y2hTY29yZSk7XHJcbiAgICAgIH0sIHsgYXJ0aXN0LCBsb2NhdGlvbiwgdmVudWUgfSk7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhgRm91bmQgJHtjb25jZXJ0cy5sZW5ndGh9IG1hdGNoaW5nIFZpdmlkU2VhdHMgZXZlbnQocylgKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEdldCB0aWNrZXRzIGZvciB0aGUgYmVzdCBtYXRjaGluZyBldmVudChzKVxyXG4gICAgICBjb25zdCBiZXN0TWF0Y2hlcyA9IGNvbmNlcnRzLmZpbHRlcihldmVudCA9PiBldmVudC5tYXRjaFNjb3JlID49IDUwKTtcclxuICAgICAgY29uc3QgY29uY2VydHNXaXRoUHJpY2VzID0gW107XHJcblxyXG4gICAgICAvLyBQcm9jZXNzIGVhY2ggZXZlbnQgb25seSBvbmNlXHJcbiAgICAgIGNvbnN0IHByb2Nlc3NlZFVybHMgPSBuZXcgU2V0KCk7XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IGNvbmNlcnQgb2YgYmVzdE1hdGNoZXMpIHtcclxuICAgICAgICAvLyBTa2lwIGlmIHdlJ3ZlIGFscmVhZHkgcHJvY2Vzc2VkIHRoaXMgVVJMXHJcbiAgICAgICAgaWYgKHByb2Nlc3NlZFVybHMuaGFzKGNvbmNlcnQubGluaykpIHtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyBldmVudDogXCIke2NvbmNlcnQudGl0bGV9XCIgKG1hdGNoIHNjb3JlOiAke2NvbmNlcnQubWF0Y2hTY29yZX0pYCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXNlIHRoZSBleGlzdGluZyBwYWdlIHRvIG5hdmlnYXRlIHRvIHRoZSBldmVudFxyXG4gICAgICAgIGF3YWl0IHNlYXJjaFBhZ2UuZ290byhjb25jZXJ0LmxpbmssIHsgd2FpdFVudGlsOiAnbmV0d29ya2lkbGUwJywgdGltZW91dDogMzAwMDAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRXh0cmFjdCB0aWNrZXRzIGRpcmVjdGx5IGZyb20gdGhlIGxvYWRlZCBwYWdlXHJcbiAgICAgICAgY29uc3QgdGlja2V0cyA9IGF3YWl0IHNlYXJjaFBhZ2UuZXZhbHVhdGUoKCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZ3JvdXBMaXN0aW5ncyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdGVzdGlkPVwibGlzdGluZy1ncm91cC1yb3ctY29udGFpbmVyXCJdJykpO1xyXG4gICAgICAgICAgY29uc3QgaW5kaXZpZHVhbExpc3RpbmdzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS10ZXN0aWQ9XCJsaXN0aW5nLXJvdy1jb250YWluZXJcIl0nKSk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGBGb3VuZCAke2dyb3VwTGlzdGluZ3MubGVuZ3RofSBncm91cCBsaXN0aW5ncyBhbmQgJHtpbmRpdmlkdWFsTGlzdGluZ3MubGVuZ3RofSBpbmRpdmlkdWFsIGxpc3RpbmdzYCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGNvbnN0IGFsbExpc3RpbmdzID0gWy4uLmdyb3VwTGlzdGluZ3MsIC4uLmluZGl2aWR1YWxMaXN0aW5nc107XHJcblxyXG4gICAgICAgICAgY29uc3Qgbm9ybWFsaXplU2VjdGlvbiA9IChzZWN0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghc2VjdGlvbikgcmV0dXJuICdVTktOT1dOJztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHNlY3Rpb25VcHBlciA9IHNlY3Rpb24udG9VcHBlckNhc2UoKTtcclxuICAgICAgICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IHtcclxuICAgICAgICAgICAgICAnR0VORVJBTCBBRE1JU1NJT04nOiBbJ0dBJywgJ0dFTicsICdHRU5BRE0nXSxcclxuICAgICAgICAgICAgICAnR1JBTkRTVEFORCc6IFsnR1JBTkQnLCAnR1NBREEnLCAnR1MnXSxcclxuICAgICAgICAgICAgICAnUFJFTUlVTSc6IFsnUFJFTScsICdQUk0nXSxcclxuICAgICAgICAgICAgICAnVklQJzogWydWSVAnXSxcclxuICAgICAgICAgICAgICAnQkFMQ09OWSc6IFsnQkFMJywgJ0JBTEMnXSxcclxuICAgICAgICAgICAgICAnRkxPT1InOiBbJ0ZMUicsICdGTE9PUiddLFxyXG4gICAgICAgICAgICAgICdTVEFORElORyc6IFsnU1RBTkQnXVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgZm9yIChjb25zdCBbY2F0ZWdvcnksIGtleXdvcmRzXSBvZiBPYmplY3QuZW50cmllcyhjYXRlZ29yaWVzKSkge1xyXG4gICAgICAgICAgICAgIGlmIChrZXl3b3Jkcy5zb21lKGtleXdvcmQgPT4gc2VjdGlvblVwcGVyLmluY2x1ZGVzKGtleXdvcmQpKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhdGVnb3J5O1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGBVTkNBVEVHT1JJWkVEOiAke3NlY3Rpb259YDtcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgY29uc3QgdGlja2V0c0J5U2VjdGlvbiA9IHt9O1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBhbGxMaXN0aW5ncy5mb3JFYWNoKChsaXN0aW5nLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBsaXN0aW5nLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRlc3RpZF49XCJHUkFORFNcIl0sIFtkYXRhLXRlc3RpZF49XCJHU0FEQVwiXSwgW2RhdGEtdGVzdGlkXj1cIlBSRU1cIl0sIFtkYXRhLXRlc3RpZF49XCJHRU5BRE1cIl0sIC5NdWlUeXBvZ3JhcGh5LXNtYWxsLW1lZGl1bScpPy50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgICAgICAgICAgIGNvbnN0IHF1YW50aXR5ID0gbGlzdGluZy5xdWVyeVNlbGVjdG9yKCcuTXVpVHlwb2dyYXBoeS1jYXB0aW9uLXJlZ3VsYXInKT8udGV4dENvbnRlbnQ/LnRyaW0oKSB8fCAnJztcclxuICAgICAgICAgICAgICBjb25zdCBwcmljZSA9IGxpc3RpbmcucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdGlkPVwibGlzdGluZy1wcmljZVwiXScpPy50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgICAgICAgICAgIGNvbnN0IHJvdyA9IGxpc3RpbmcucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdGlkPVwicm93XCJdJyk/LnRleHRDb250ZW50Py50cmltKCk7XHJcbiAgICAgICAgICAgICAgY29uc3QgZGVhbFNjb3JlID0gbGlzdGluZy5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0aWQ9XCJkZWFsLXNjb3JlXCJdLCAuc3R5bGVzX2dyZWF0ZXN0U2NvcmVMYWJlbF9fS3E0TzMnKT8udGV4dENvbnRlbnQ/LnRyaW0oKSB8fCAnJztcclxuICAgICAgICAgICAgICBjb25zdCBsaXN0aW5nSWQgPSBsaXN0aW5nLmdldEF0dHJpYnV0ZSgnZGF0YS1saXN0aW5nLWlkJyk7XHJcblxyXG4gICAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRTZWN0aW9uID0gbm9ybWFsaXplU2VjdGlvbihzZWN0aW9uKTtcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICBpZiAoIXRpY2tldHNCeVNlY3Rpb25bbm9ybWFsaXplZFNlY3Rpb25dKSB7XHJcbiAgICAgICAgICAgICAgICB0aWNrZXRzQnlTZWN0aW9uW25vcm1hbGl6ZWRTZWN0aW9uXSA9IHtcclxuICAgICAgICAgICAgICAgICAgc2VjdGlvbjogbm9ybWFsaXplZFNlY3Rpb24sXHJcbiAgICAgICAgICAgICAgICAgIG9yaWdpbmFsU2VjdGlvbjogc2VjdGlvbixcclxuICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IG5vcm1hbGl6ZWRTZWN0aW9uLnN0YXJ0c1dpdGgoJ1VOQ0FURUdPUklaRUQnKSA/ICdVTktOT1dOJyA6IG5vcm1hbGl6ZWRTZWN0aW9uLFxyXG4gICAgICAgICAgICAgICAgICB0aWNrZXRzOiBbXVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIGlmIChwcmljZSAmJiBzZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICB0aWNrZXRzQnlTZWN0aW9uW25vcm1hbGl6ZWRTZWN0aW9uXS50aWNrZXRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICBxdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgcHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgIGRlYWxTY29yZSxcclxuICAgICAgICAgICAgICAgICAgcmF3UHJpY2U6IHBhcnNlRmxvYXQocHJpY2UucmVwbGFjZSgvW14wLTkuXS9nLCAnJykpLFxyXG4gICAgICAgICAgICAgICAgICByb3c6IHJvdyB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICBsaXN0aW5nSWQsXHJcbiAgICAgICAgICAgICAgICAgIG9yaWdpbmFsU2VjdGlvbjogc2VjdGlvbixcclxuICAgICAgICAgICAgICAgICAgbGlzdGluZ1VybDogd2luZG93LmxvY2F0aW9uLmhyZWZcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yIHByb2Nlc3NpbmcgbGlzdGluZyAke2luZGV4ICsgMX06YCwgZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgT2JqZWN0LnZhbHVlcyh0aWNrZXRzQnlTZWN0aW9uKS5mb3JFYWNoKHNlY3Rpb24gPT4ge1xyXG4gICAgICAgICAgICBzZWN0aW9uLnRpY2tldHMuc29ydCgoYSwgYikgPT4gYS5yYXdQcmljZSAtIGIucmF3UHJpY2UpO1xyXG4gICAgICAgICAgICBzZWN0aW9uLmxvd2VzdFByaWNlID0gc2VjdGlvbi50aWNrZXRzWzBdPy5yYXdQcmljZSB8fCBudWxsO1xyXG4gICAgICAgICAgICBzZWN0aW9uLmhpZ2hlc3RQcmljZSA9IHNlY3Rpb24udGlja2V0c1tzZWN0aW9uLnRpY2tldHMubGVuZ3RoIC0gMV0/LnJhd1ByaWNlIHx8IG51bGw7XHJcbiAgICAgICAgICAgIHNlY3Rpb24ubnVtYmVyT2ZMaXN0aW5ncyA9IHNlY3Rpb24udGlja2V0cy5sZW5ndGg7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0b3RhbFNlY3Rpb25zOiBPYmplY3Qua2V5cyh0aWNrZXRzQnlTZWN0aW9uKS5sZW5ndGgsXHJcbiAgICAgICAgICAgIHNlY3Rpb25zOiBPYmplY3QudmFsdWVzKHRpY2tldHNCeVNlY3Rpb24pLnNvcnQoKGEsIGIpID0+IGEubG93ZXN0UHJpY2UgLSBiLmxvd2VzdFByaWNlKVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHRpY2tldHMgJiYgdGlja2V0cy50b3RhbFNlY3Rpb25zID4gMCkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYEZvdW5kIHRpY2tldHMgaW4gJHt0aWNrZXRzLnRvdGFsU2VjdGlvbnN9IHNlY3Rpb25zYCk7XHJcbiAgICAgICAgICBjb25jZXJ0c1dpdGhQcmljZXMucHVzaCh7XHJcbiAgICAgICAgICAgIC4uLmNvbmNlcnQsXHJcbiAgICAgICAgICAgIHRpY2tldHNcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gTWFyayB0aGlzIFVSTCBhcyBwcm9jZXNzZWRcclxuICAgICAgICBwcm9jZXNzZWRVcmxzLmFkZChjb25jZXJ0LmxpbmspO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gY29uY2VydHNXaXRoUHJpY2VzO1xyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZpdmlkU2VhdHMgZXJyb3IgZGV0YWlsczonLCBlcnJvcik7XHJcbiAgICAgIGlmIChzZWFyY2hQYWdlKSB7XHJcbiAgICAgICAgYXdhaXQgc2VhcmNoUGFnZS5zY3JlZW5zaG90KHsgcGF0aDogJ3Zpdmlkc2VhdHMtZXJyb3IucG5nJywgZnVsbFBhZ2U6IHRydWUgfSk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgaWYgKGJyb3dzZXIpIHtcclxuICAgICAgICBhd2FpdCBicm93c2VyLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFRpY2tldFByaWNlcyhldmVudFVybCwgZXhpc3RpbmdQYWdlID0gbnVsbCkge1xyXG4gICAgbGV0IGJyb3dzZXIgPSBudWxsO1xyXG4gICAgbGV0IHBhZ2UgPSBleGlzdGluZ1BhZ2U7XHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmICghZXhpc3RpbmdQYWdlKSB7XHJcbiAgICAgICAgYnJvd3NlciA9IGF3YWl0IHNldHVwQnJvd3NlcigpO1xyXG4gICAgICAgIHBhZ2UgPSBhd2FpdCBzZXR1cFBhZ2UoYnJvd3Nlcik7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ05hdmlnYXRpbmcgdG8gZXZlbnQgcGFnZTonLCBldmVudFVybCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEZ1bmN0aW9uIHRvIGNoZWNrIGZvciBjb250ZW50XHJcbiAgICAgIGNvbnN0IGNoZWNrQ29udGVudCA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHBhZ2UuZXZhbHVhdGUoKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RvcnMgPSBbXHJcbiAgICAgICAgICAgICAgJy5zdHlsZXNfbGlzdGluZ1Jvd0NvbnRhaW5lcl9fS05NNF8nLFxyXG4gICAgICAgICAgICAgICcuc3R5bGVzX2xpc3RpbmdSb3dDb250YWluZXJfX2Q4V0xaJyxcclxuICAgICAgICAgICAgICAnW2RhdGEtdGVzdGlkPVwibGlzdGluZy1ncm91cC1yb3ctY29udGFpbmVyXCJdJyxcclxuICAgICAgICAgICAgICAnW2RhdGEtdGVzdGlkPVwibGlzdGluZy1yb3ctY29udGFpbmVyXCJdJ1xyXG4gICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yIChjb25zdCBzZWxlY3RvciBvZiBzZWxlY3RvcnMpIHtcclxuICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHJldHVybiBjb250ZW50O1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgY2hlY2tpbmcgY29udGVudDonLCBlcnJvcik7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gSW5pdGlhbCBuYXZpZ2F0aW9uXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgcGFnZS5nb3RvKGV2ZW50VXJsLCB7IHdhaXRVbnRpbDogJ2RvbWNvbnRlbnRsb2FkZWQnLCB0aW1lb3V0OiAzMDAwMCB9KTtcclxuICAgICAgICBhd2FpdCBwYWdlLndhaXRGb3JUaW1lb3V0KDIwMDApO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdJbml0aWFsIG5hdmlnYXRpb24gZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBmb3IgY29udGVudFxyXG4gICAgICBsZXQgY29udGVudEZvdW5kID0gYXdhaXQgY2hlY2tDb250ZW50KCk7XHJcbiAgICAgIGxldCBhdHRlbXB0cyA9IDE7XHJcbiAgICAgIGNvbnN0IG1heEF0dGVtcHRzID0gMztcclxuXHJcbiAgICAgIHdoaWxlICghY29udGVudEZvdW5kICYmIGF0dGVtcHRzIDwgbWF4QXR0ZW1wdHMpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgQ29udGVudCBjaGVjayBhdHRlbXB0ICR7YXR0ZW1wdHN9IG9mICR7bWF4QXR0ZW1wdHN9YCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGF3YWl0IHBhZ2UucmVsb2FkKHsgd2FpdFVudGlsOiAnZG9tY29udGVudGxvYWRlZCcgfSk7XHJcbiAgICAgICAgICBhd2FpdCBwYWdlLndhaXRGb3JUaW1lb3V0KDIwMDApO1xyXG4gICAgICAgICAgY29udGVudEZvdW5kID0gYXdhaXQgY2hlY2tDb250ZW50KCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmIChjb250ZW50Rm91bmQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZvdW5kIGNvbnRlbnQgb24gYXR0ZW1wdCcsIGF0dGVtcHRzKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvciBvbiBhdHRlbXB0ICR7YXR0ZW1wdHN9OmAsIGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXR0ZW1wdHMrKztcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFjb250ZW50Rm91bmQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBmaW5kIGNvbnRlbnQgYWZ0ZXIgbXVsdGlwbGUgYXR0ZW1wdHMnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRXh0cmFjdCB0aWNrZXRzIG9ubHkgaWYgY29udGVudCB3YXMgZm91bmRcclxuICAgICAgY29uc3QgdGlja2V0cyA9IGF3YWl0IHBhZ2UuZXZhbHVhdGUoKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGdyb3VwTGlzdGluZ3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXRlc3RpZD1cImxpc3RpbmctZ3JvdXAtcm93LWNvbnRhaW5lclwiXScpKTtcclxuICAgICAgICBjb25zdCBpbmRpdmlkdWFsTGlzdGluZ3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXRlc3RpZD1cImxpc3Rpbmctcm93LWNvbnRhaW5lclwiXScpKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZyhgRm91bmQgJHtncm91cExpc3RpbmdzLmxlbmd0aH0gZ3JvdXAgbGlzdGluZ3MgYW5kICR7aW5kaXZpZHVhbExpc3RpbmdzLmxlbmd0aH0gaW5kaXZpZHVhbCBsaXN0aW5nc2ApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGFsbExpc3RpbmdzID0gWy4uLmdyb3VwTGlzdGluZ3MsIC4uLmluZGl2aWR1YWxMaXN0aW5nc107XHJcblxyXG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZVNlY3Rpb24gPSAoc2VjdGlvbikgPT4ge1xyXG4gICAgICAgICAgaWYgKCFzZWN0aW9uKSByZXR1cm4gJ1VOS05PV04nO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBjb25zdCBzZWN0aW9uVXBwZXIgPSBzZWN0aW9uLnRvVXBwZXJDYXNlKCk7XHJcbiAgICAgICAgICBjb25zdCBjYXRlZ29yaWVzID0ge1xyXG4gICAgICAgICAgICAnR0VORVJBTCBBRE1JU1NJT04nOiBbJ0dBJywgJ0dFTicsICdHRU5BRE0nXSxcclxuICAgICAgICAgICAgJ0dSQU5EU1RBTkQnOiBbJ0dSQU5EJywgJ0dTQURBJywgJ0dTJ10sXHJcbiAgICAgICAgICAgICdQUkVNSVVNJzogWydQUkVNJywgJ1BSTSddLFxyXG4gICAgICAgICAgICAnVklQJzogWydWSVAnXSxcclxuICAgICAgICAgICAgJ0JBTENPTlknOiBbJ0JBTCcsICdCQUxDJ10sXHJcbiAgICAgICAgICAgICdGTE9PUic6IFsnRkxSJywgJ0ZMT09SJ10sXHJcbiAgICAgICAgICAgICdTVEFORElORyc6IFsnU1RBTkQnXVxyXG4gICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICBmb3IgKGNvbnN0IFtjYXRlZ29yeSwga2V5d29yZHNdIG9mIE9iamVjdC5lbnRyaWVzKGNhdGVnb3JpZXMpKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXl3b3Jkcy5zb21lKGtleXdvcmQgPT4gc2VjdGlvblVwcGVyLmluY2x1ZGVzKGtleXdvcmQpKSkge1xyXG4gICAgICAgICAgICAgIHJldHVybiBjYXRlZ29yeTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHJldHVybiBgVU5DQVRFR09SSVpFRDogJHtzZWN0aW9ufWA7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgdGlja2V0c0J5U2VjdGlvbiA9IHt9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGFsbExpc3RpbmdzLmZvckVhY2goKGxpc3RpbmcsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBzZWN0aW9uID0gbGlzdGluZy5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0aWRePVwiR1JBTkRTXCJdLCBbZGF0YS10ZXN0aWRePVwiR1NBREFcIl0sIFtkYXRhLXRlc3RpZF49XCJQUkVNXCJdLCBbZGF0YS10ZXN0aWRePVwiR0VOQURNXCJdLCAuTXVpVHlwb2dyYXBoeS1zbWFsbC1tZWRpdW0nKT8udGV4dENvbnRlbnQ/LnRyaW0oKSB8fCAnJztcclxuICAgICAgICAgICAgY29uc3QgcXVhbnRpdHkgPSBsaXN0aW5nLnF1ZXJ5U2VsZWN0b3IoJy5NdWlUeXBvZ3JhcGh5LWNhcHRpb24tcmVndWxhcicpPy50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgICAgICAgICBjb25zdCBwcmljZSA9IGxpc3RpbmcucXVlcnlTZWxlY3RvcignW2RhdGEtdGVzdGlkPVwibGlzdGluZy1wcmljZVwiXScpPy50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgICAgICAgICBjb25zdCByb3cgPSBsaXN0aW5nLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRlc3RpZD1cInJvd1wiXScpPy50ZXh0Q29udGVudD8udHJpbSgpO1xyXG4gICAgICAgICAgICBjb25zdCBkZWFsU2NvcmUgPSBsaXN0aW5nLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRlc3RpZD1cImRlYWwtc2NvcmVcIl0sIC5zdHlsZXNfZ3JlYXRlc3RTY29yZUxhYmVsX19LcTRPMycpPy50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgICAgICAgICBjb25zdCBsaXN0aW5nSWQgPSBsaXN0aW5nLmdldEF0dHJpYnV0ZSgnZGF0YS1saXN0aW5nLWlkJyk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkU2VjdGlvbiA9IG5vcm1hbGl6ZVNlY3Rpb24oc2VjdGlvbik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoIXRpY2tldHNCeVNlY3Rpb25bbm9ybWFsaXplZFNlY3Rpb25dKSB7XHJcbiAgICAgICAgICAgICAgdGlja2V0c0J5U2VjdGlvbltub3JtYWxpemVkU2VjdGlvbl0gPSB7XHJcbiAgICAgICAgICAgICAgICBzZWN0aW9uOiBub3JtYWxpemVkU2VjdGlvbixcclxuICAgICAgICAgICAgICAgIG9yaWdpbmFsU2VjdGlvbjogc2VjdGlvbixcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBub3JtYWxpemVkU2VjdGlvbi5zdGFydHNXaXRoKCdVTkNBVEVHT1JJWkVEJykgPyAnVU5LTk9XTicgOiBub3JtYWxpemVkU2VjdGlvbixcclxuICAgICAgICAgICAgICAgIHRpY2tldHM6IFtdXHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHByaWNlICYmIHNlY3Rpb24pIHtcclxuICAgICAgICAgICAgICB0aWNrZXRzQnlTZWN0aW9uW25vcm1hbGl6ZWRTZWN0aW9uXS50aWNrZXRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgcXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBwcmljZSxcclxuICAgICAgICAgICAgICAgIGRlYWxTY29yZSxcclxuICAgICAgICAgICAgICAgIHJhd1ByaWNlOiBwYXJzZUZsb2F0KHByaWNlLnJlcGxhY2UoL1teMC05Ll0vZywgJycpKSxcclxuICAgICAgICAgICAgICAgIHJvdzogcm93IHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICBsaXN0aW5nSWQsXHJcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFNlY3Rpb246IHNlY3Rpb24sXHJcbiAgICAgICAgICAgICAgICBsaXN0aW5nVXJsOiB3aW5kb3cubG9jYXRpb24uaHJlZlxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yIHByb2Nlc3NpbmcgbGlzdGluZyAke2luZGV4ICsgMX06YCwgZXJyKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgT2JqZWN0LnZhbHVlcyh0aWNrZXRzQnlTZWN0aW9uKS5mb3JFYWNoKHNlY3Rpb24gPT4ge1xyXG4gICAgICAgICAgc2VjdGlvbi50aWNrZXRzLnNvcnQoKGEsIGIpID0+IGEucmF3UHJpY2UgLSBiLnJhd1ByaWNlKTtcclxuICAgICAgICAgIHNlY3Rpb24ubG93ZXN0UHJpY2UgPSBzZWN0aW9uLnRpY2tldHNbMF0/LnJhd1ByaWNlIHx8IG51bGw7XHJcbiAgICAgICAgICBzZWN0aW9uLmhpZ2hlc3RQcmljZSA9IHNlY3Rpb24udGlja2V0c1tzZWN0aW9uLnRpY2tldHMubGVuZ3RoIC0gMV0/LnJhd1ByaWNlIHx8IG51bGw7XHJcbiAgICAgICAgICBzZWN0aW9uLm51bWJlck9mTGlzdGluZ3MgPSBzZWN0aW9uLnRpY2tldHMubGVuZ3RoO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgdG90YWxTZWN0aW9uczogT2JqZWN0LmtleXModGlja2V0c0J5U2VjdGlvbikubGVuZ3RoLFxyXG4gICAgICAgICAgc2VjdGlvbnM6IE9iamVjdC52YWx1ZXModGlja2V0c0J5U2VjdGlvbikuc29ydCgoYSwgYikgPT4gYS5sb3dlc3RQcmljZSAtIGIubG93ZXN0UHJpY2UpXHJcbiAgICAgICAgfTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhgRm91bmQgdGlja2V0cyBpbiAke3RpY2tldHMudG90YWxTZWN0aW9uc30gc2VjdGlvbnNgKTtcclxuICAgICAgcmV0dXJuIHRpY2tldHM7XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgdGlja2V0IHByaWNlczonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiB7IHRvdGFsU2VjdGlvbnM6IDAsIHNlY3Rpb25zOiBbXSB9O1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgaWYgKGJyb3dzZXIgJiYgIWV4aXN0aW5nUGFnZSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBhd2FpdCBicm93c2VyLmNsb3NlKCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBjbG9zaW5nIGJyb3dzZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVml2aWRTZWF0c1NlYXJjaGVyOyJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJjb25maWciLCJzZXR1cEJyb3dzZXIiLCJzZXR1cFBhZ2UiLCJmb3JtYXRQcmljZSIsInBhcnNlIiwic3VwYWJhc2UiLCJ1cmwiLCJzZXJ2aWNlS2V5IiwiZXZlbnRFeGlzdHMiLCJuYW1lIiwiZGF0ZSIsImRhdGEiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsImNvZGUiLCJjb25zb2xlIiwibGlua0V4aXN0cyIsImV2ZW50SWQiLCJzb3VyY2UiLCJpbnNlcnRFdmVudCIsImV2ZW50IiwicGFyc2VkRGF0ZSIsIkRhdGUiLCJsb2ciLCJnZXRUaW1lIiwiaXNOYU4iLCJleGlzdHMiLCJ0aXRsZSIsInRvSVNPU3RyaW5nIiwiZXZlbnREYXRhIiwidHlwZSIsImNhdGVnb3J5IiwidmVudWUiLCJpbnNlcnQiLCJtZXNzYWdlIiwiZGV0YWlscyIsImhpbnQiLCJpZCIsImluc2VydEV2ZW50TGluayIsImxpbmtEYXRhIiwiZXZlbnRfaWQiLCJpbnNlcnRUaWNrZXRzIiwidGlja2V0cyIsImZvcm1hdHRlZFRpY2tldHMiLCJzZWN0aW9ucyIsImZsYXRNYXAiLCJzZWN0aW9uIiwibWFwIiwidGlja2V0IiwicHJpY2UiLCJyYXdQcmljZSIsInJvdyIsInF1YW50aXR5IiwicGFyc2VJbnQiLCJsaXN0aW5nVXJsIiwicmF3X2RhdGEiLCJsZW5ndGgiLCJtYWluU2VhcmNoIiwiYXJ0aXN0IiwibG9jYXRpb24iLCJzZWFyY2hlciIsIlZpdmlkU2VhdHNTZWFyY2hlciIsImNvbmNlcnRzV2l0aFByaWNlcyIsInNlYXJjaENvbmNlcnRzIiwiY29uY2VydCIsImxpbmsiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJnZW5lcmF0ZVNlYXJjaFVybCIsInNlYXJjaFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsInNlYXJjaFRlcm1zIiwicHVzaCIsImFwcGVuZCIsImpvaW4iLCJ0b1N0cmluZyIsImJyb3dzZXIiLCJzZWFyY2hQYWdlIiwic2VhcmNoVXJsIiwiZ290byIsIndhaXRVbnRpbCIsInRpbWVvdXQiLCJ3YWl0Rm9yU2VsZWN0b3IiLCJjb25jZXJ0cyIsImV2YWx1YXRlIiwicHJvZHVjdGlvbkxpc3RzIiwiQXJyYXkiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhbGxFdmVudHMiLCJmb3JFYWNoIiwibGlzdCIsImxpc3RpbmdzIiwibGlzdGluZyIsImFuY2hvciIsInF1ZXJ5U2VsZWN0b3IiLCJocmVmIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImRhdGVFbGVtZW50IiwiZGF5T2ZXZWVrIiwidGV4dENvbnRlbnQiLCJ0cmltIiwieWVhciIsInRpbWUiLCJ0aXRsZUVsZW1lbnQiLCJsYWJlbENvbnRhaW5lciIsInRydW5jYXRlU3BhbnMiLCJldmVudExvY2F0aW9uIiwicmF3RGF0YSIsImZ1bGxUaXRsZSIsImVyciIsInNjb3JlIiwibWF0Y2hTY29yZSIsInNvcnQiLCJhIiwiYiIsImJlc3RNYXRjaGVzIiwiZmlsdGVyIiwicHJvY2Vzc2VkVXJscyIsIlNldCIsImhhcyIsImdyb3VwTGlzdGluZ3MiLCJpbmRpdmlkdWFsTGlzdGluZ3MiLCJhbGxMaXN0aW5ncyIsIm5vcm1hbGl6ZVNlY3Rpb24iLCJzZWN0aW9uVXBwZXIiLCJ0b1VwcGVyQ2FzZSIsImNhdGVnb3JpZXMiLCJrZXl3b3JkcyIsIk9iamVjdCIsImVudHJpZXMiLCJzb21lIiwia2V5d29yZCIsInRpY2tldHNCeVNlY3Rpb24iLCJpbmRleCIsImRlYWxTY29yZSIsImxpc3RpbmdJZCIsImdldEF0dHJpYnV0ZSIsIm5vcm1hbGl6ZWRTZWN0aW9uIiwib3JpZ2luYWxTZWN0aW9uIiwic3RhcnRzV2l0aCIsInBhcnNlRmxvYXQiLCJyZXBsYWNlIiwid2luZG93IiwidmFsdWVzIiwibG93ZXN0UHJpY2UiLCJoaWdoZXN0UHJpY2UiLCJudW1iZXJPZkxpc3RpbmdzIiwidG90YWxTZWN0aW9ucyIsImtleXMiLCJhZGQiLCJzY3JlZW5zaG90IiwicGF0aCIsImZ1bGxQYWdlIiwiY2xvc2UiLCJnZXRUaWNrZXRQcmljZXMiLCJldmVudFVybCIsImV4aXN0aW5nUGFnZSIsInBhZ2UiLCJjaGVja0NvbnRlbnQiLCJjb250ZW50Iiwic2VsZWN0b3JzIiwic2VsZWN0b3IiLCJ3YWl0Rm9yVGltZW91dCIsImNvbnRlbnRGb3VuZCIsImF0dGVtcHRzIiwibWF4QXR0ZW1wdHMiLCJyZWxvYWQiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/vivid-seats.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/date-fns"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fevents%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cevents%5Csearch.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();